# CVE Monitoring Setup for Spring and .NET Projects

## üéØ Overview

This document outlines the comprehensive CVE monitoring system set up for both Spring Boot and .NET applications in this project. The system provides automated vulnerability scanning, reporting, and alerting.

## üîç Current CVE Status

### Spring Boot Application
- **Status**: ‚úÖ **CVE-FREE** (0 vulnerabilities)
- **Base Image**: Alpine 3.22.1 with OpenJDK 21
- **Last Scan**: September 9, 2025
- **Scanner**: Trivy + Docker Scout

### .NET Application  
- **Status**: ‚ö†Ô∏è **1 CRITICAL CVE** (CVE-2023-45853)
- **Base Image**: distroless/java21-debian12:nonroot
- **Vulnerability**: zlib integer overflow (will_not_fix)
- **Recommendation**: Switch to Alpine-based image

## üõ†Ô∏è Monitoring Tools Setup

### 1. Automated Scanning Scripts

#### Main CVE Monitor (`scripts/cve-monitor.sh`)
- **Purpose**: Comprehensive CVE scanning for both applications
- **Features**:
  - Docker image building and scanning
  - Trivy vulnerability detection
  - Docker Scout analysis
  - Specific CVE checking
  - Dependency update checking
  - Report generation

#### Setup Script (`scripts/setup-cve-monitoring.sh`)
- **Purpose**: One-time setup of monitoring infrastructure
- **Features**:
  - Dependency checking
  - Cron job setup
  - Logging configuration
  - Notification script creation
  - Security policy generation

### 2. GitHub Actions Workflow

#### Automated CI/CD Scanning (`.github/workflows/cve-monitoring.yml`)
- **Schedule**: Daily at 6 AM UTC
- **Triggers**: 
  - Scheduled runs
  - Manual dispatch
  - Push to main branch
  - Dependency file changes
- **Features**:
  - Parallel Spring and .NET scanning
  - SARIF report generation
  - GitHub Security tab integration
  - Artifact uploads
  - PR comments

### 3. Monitoring Infrastructure

#### Directory Structure
```
/Users/yshmulev/dev/spring-java-2/
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ cve-monitor.sh              # Main scanning script
‚îÇ   ‚îú‚îÄ‚îÄ setup-cve-monitoring.sh     # Setup script
‚îÇ   ‚îú‚îÄ‚îÄ notify-cve.sh              # Notification script
‚îÇ   ‚îî‚îÄ‚îÄ update-dependencies.sh     # Dependency update script
‚îú‚îÄ‚îÄ security-reports/              # CVE scan reports
‚îú‚îÄ‚îÄ logs/                          # Monitoring logs
‚îú‚îÄ‚îÄ .github/workflows/
‚îÇ   ‚îî‚îÄ‚îÄ cve-monitoring.yml         # GitHub Actions workflow
‚îî‚îÄ‚îÄ SECURITY.md                    # Security policy
```

## üìä Known CVEs Being Monitored

### Spring Framework CVEs
- **CVE-2025-22234**: Spring Security information exposure
- **CVE-2025-22232**: Spring Cloud Config authorization bypass  
- **CVE-2025-22228**: Spring Security authorization bypass
- **CVE-2023-34040**: Spring for Apache Kafka RCE
- **CVE-2024-38829**: Spring LDAP authorization bypass
- **CVE-2024-38808**: Spring Framework DoS
- **CVE-2024-38809**: Spring Framework DoS

### .NET Framework CVEs
- **CVE-2018-8540**: .NET Framework RCE
- **CVE-2023-29337**: ASP.NET Core elevation of privilege
- **CVE-2023-33128**: ASP.NET Core information disclosure
- **CVE-2023-33170**: ASP.NET Core denial of service

## üöÄ Quick Start

### 1. Initial Setup
```bash
# Run the setup script
./scripts/setup-cve-monitoring.sh

# Run initial scan
./scripts/cve-monitor.sh
```

### 2. Manual Scanning
```bash
# Scan Spring application
docker build -f Dockerfile.alpine-distroless-v2 -t spring-app:latest .
docker run --rm -v /var/run/docker.sock:/var/run/docker.sock aquasec/trivy image --severity HIGH,CRITICAL spring-app:latest

# Scan .NET application  
docker build -f dotnet-spring-equivalent/Dockerfile.distroless -t dotnet-app:latest dotnet-spring-equivalent/
docker run --rm -v /var/run/docker.sock:/var/run/docker.sock aquasec/trivy image --severity HIGH,CRITICAL dotnet-app:latest
```

### 3. Update Dependencies
```bash
# Update Spring dependencies
mvn versions:use-latest-versions

# Update .NET dependencies
cd dotnet-spring-equivalent
dotnet add package Microsoft.AspNetCore.OpenApi --version latest
```

## üìà Monitoring Schedule

### Automated Runs
- **Daily**: 6:00 AM UTC via cron job
- **CI/CD**: On every push to main branch
- **Manual**: Via GitHub Actions dispatch

### Manual Checks
- **Weekly**: Review security reports
- **Monthly**: Update dependencies
- **Quarterly**: Review security policies

## üîß Configuration

### Cron Job
```bash
# Daily CVE monitoring at 6 AM
0 6 * * * /Users/yshmulev/dev/spring-java-2/scripts/cve-monitor.sh >> /Users/yshmulev/dev/spring-java-2/logs/cve-monitor.log 2>&1
```

### Environment Variables
```bash
# Optional: Configure notification webhooks
export SLACK_WEBHOOK_URL="your-slack-webhook-url"
export EMAIL_NOTIFICATIONS="security@yourcompany.com"
```

## üìã Reports and Outputs

### Generated Reports
- **Trivy JSON**: Detailed vulnerability data
- **Docker Scout**: Quick vulnerability overview
- **Summary Markdown**: Human-readable reports
- **Dependency Updates**: Outdated package lists

### Report Locations
- **Security Reports**: `security-reports/`
- **Logs**: `logs/`
- **GitHub Actions**: Artifacts tab
- **GitHub Security**: Security tab

## üö® Alerting

### Notification Triggers
- **HIGH/CRITICAL** vulnerabilities found
- **New CVEs** affecting monitored components
- **Failed scans** or build issues
- **Dependency updates** available

### Notification Methods
- **Slack**: Webhook integration (configurable)
- **Email**: SMTP notifications (configurable)
- **GitHub**: Issues and PR comments
- **Logs**: File-based logging

## üîí Security Best Practices

### Image Security
1. **Use Alpine-based images** (CVE-free)
2. **Non-root users** (65532:65532)
3. **Minimal attack surface** (distroless approach)
4. **Regular updates** (automated dependency updates)

### Monitoring Best Practices
1. **Multiple scanners** (Trivy + Docker Scout)
2. **Regular scanning** (daily automated)
3. **Comprehensive coverage** (OS + application layers)
4. **Actionable reports** (prioritized by severity)

## üìû Support and Maintenance

### Regular Tasks
- **Weekly**: Review security reports
- **Monthly**: Update monitoring scripts
- **Quarterly**: Review and update CVE lists
- **Annually**: Security policy review

### Troubleshooting
- **Check logs**: `logs/cve-monitor.log`
- **Verify Docker**: Ensure Docker is running
- **Update databases**: `trivy image --update-db`
- **Test manually**: Run individual scan commands

## üéâ Success Metrics

### Current Status
- ‚úÖ **Spring Application**: 0 CVEs (CVE-free)
- ‚ö†Ô∏è **.NET Application**: 1 CRITICAL CVE (fixable)
- ‚úÖ **Monitoring**: Fully automated
- ‚úÖ **Reporting**: Comprehensive coverage
- ‚úÖ **Alerting**: Multi-channel notifications

### Goals
- **Zero CVEs** in production applications
- **Sub-24 hour** CVE detection and response
- **Automated remediation** where possible
- **Comprehensive coverage** of all dependencies

---

## üìö Additional Resources

- [Trivy Documentation](https://trivy.dev/)
- [Docker Scout Documentation](https://docs.docker.com/scout/)
- [Spring Security Advisories](https://spring.io/security)
- [.NET Security Updates](https://msrc.microsoft.com/update-guide)
- [GitHub Security Features](https://docs.github.com/en/code-security)

---

*Last Updated: September 9, 2025*
*Next Review: October 9, 2025*
