¨:
V/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Services/LocalRestClient.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Services '
;' (
public		 
class		 
LocalRestClient		 
{

 
private 
readonly 

HttpClient 
_httpClient  +
;+ ,
private 
readonly 
string 
_server #
=$ %
$str& =
;= >
public 

LocalRestClient 
( 
string !
authorization" /
=0 1
$str2 4
)4 5
{ 
_httpClient 
= 
new 

HttpClient $
($ %
)% &
;& '
_httpClient 
. !
DefaultRequestHeaders )
.) *
Add* -
(- .
$str. <
,< =
$str> P
)P Q
;Q R
_httpClient 
. !
DefaultRequestHeaders )
.) *
Add* -
(- .
$str. 6
,6 7
$str8 =
)= >
;> ?
var 
	jwsHeader 
= 
Convert 
.  
ToBase64String  .
(. /
Encoding/ 7
.7 8
UTF88 <
.< =
GetBytes= E
(E F
$strF ]
)] ^
)^ _
;_ `
_httpClient 
. !
DefaultRequestHeaders )
.) *
Add* -
(- .
	jwsHeader. 7
,7 8
authorization9 F
)F G
;G H
} 
public 

async 
Task 
< 
string 
> 
GetAsync &
(& '
string' -
uri. 1
)1 2
{ 
try 
{ 	
var   
response   
=   
await    
_httpClient  ! ,
.  , -
GetAsync  - 5
(  5 6
_server  6 =
+  > ?
uri  @ C
)  C D
;  D E
var!! 
content!! 
=!! 
await!! 
response!!  (
.!!( )
Content!!) 0
.!!0 1
ReadAsStringAsync!!1 B
(!!B C
)!!C D
;!!D E
return"" 
content"" 
;"" 
}## 	
catch$$ 
($$ 
	Exception$$ 
ex$$ 
)$$ 
{%% 	
throw&& 
new&&  
HttpRequestException&& *
(&&* +
$"&&+ -
$str&&- A
{&&A B
ex&&B D
.&&D E
Message&&E L
}&&L M
"&&M N
,&&N O
ex&&P R
)&&R S
;&&S T
}'' 	
}(( 
public-- 

async-- 
Task-- 
<-- 
string-- 
>-- 
	PostAsync-- '
(--' (
string--( .
uri--/ 2
,--2 3
string--4 :
json--; ?
)--? @
{.. 
try// 
{00 	
var11 
content11 
=11 
new11 
StringContent11 +
(11+ ,
json11, 0
,110 1
Encoding112 :
.11: ;
UTF811; ?
,11? @
$str11A S
)11S T
;11T U
var22 
response22 
=22 
await22  
_httpClient22! ,
.22, -
	PostAsync22- 6
(226 7
_server227 >
+22? @
uri22A D
,22D E
content22F M
)22M N
;22N O
var33 
responseContent33 
=33  !
await33" '
response33( 0
.330 1
Content331 8
.338 9
ReadAsStringAsync339 J
(33J K
)33K L
;33L M
return44 
responseContent44 "
;44" #
}55 	
catch66 
(66 
	Exception66 
ex66 
)66 
{77 	
throw88 
new88  
HttpRequestException88 *
(88* +
$"88+ -
$str88- B
{88B C
ex88C E
.88E F
Message88F M
}88M N
"88N O
,88O P
ex88Q S
)88S T
;88T U
}99 	
}:: 
public?? 

async?? 
Task?? 
<?? 
string?? 
>?? 
PutAsync?? &
(??& '
string??' -
uri??. 1
,??1 2
string??3 9
json??: >
)??> ?
{@@ 
tryAA 
{BB 	
varCC 
contentCC 
=CC 
newCC 
StringContentCC +
(CC+ ,
jsonCC, 0
,CC0 1
EncodingCC2 :
.CC: ;
UTF8CC; ?
,CC? @
$strCCA S
)CCS T
;CCT U
varDD 
responseDD 
=DD 
awaitDD  
_httpClientDD! ,
.DD, -
PutAsyncDD- 5
(DD5 6
_serverDD6 =
+DD> ?
uriDD@ C
,DDC D
contentDDE L
)DDL M
;DDM N
varEE 
responseContentEE 
=EE  !
awaitEE" '
responseEE( 0
.EE0 1
ContentEE1 8
.EE8 9
ReadAsStringAsyncEE9 J
(EEJ K
)EEK L
;EEL M
returnFF 
responseContentFF "
;FF" #
}GG 	
catchHH 
(HH 
	ExceptionHH 
exHH 
)HH 
{II 	
throwJJ 
newJJ  
HttpRequestExceptionJJ *
(JJ* +
$"JJ+ -
$strJJ- A
{JJA B
exJJB D
.JJD E
MessageJJE L
}JJL M
"JJM N
,JJN O
exJJP R
)JJR S
;JJS T
}KK 	
}LL 
publicQQ 

asyncQQ 
TaskQQ 
<QQ 
stringQQ 
>QQ 
DeleteAsyncQQ )
(QQ) *
stringQQ* 0
uriQQ1 4
)QQ4 5
{RR 
trySS 
{TT 	
varUU 
responseUU 
=UU 
awaitUU  
_httpClientUU! ,
.UU, -
DeleteAsyncUU- 8
(UU8 9
_serverUU9 @
+UUA B
uriUUC F
)UUF G
;UUG H
varVV 
contentVV 
=VV 
awaitVV 
responseVV  (
.VV( )
ContentVV) 0
.VV0 1
ReadAsStringAsyncVV1 B
(VVB C
)VVC D
;VVD E
returnWW 
contentWW 
;WW 
}XX 	
catchYY 
(YY 
	ExceptionYY 
exYY 
)YY 
{ZZ 	
throw[[ 
new[[  
HttpRequestException[[ *
([[* +
$"[[+ -
$str[[- D
{[[D E
ex[[E G
.[[G H
Message[[H O
}[[O P
"[[P Q
,[[Q R
ex[[S U
)[[U V
;[[V W
}\\ 	
}]] 
public__ 

void__ 
Dispose__ 
(__ 
)__ 
{`` 
_httpClientaa 
?aa 
.aa 
Disposeaa 
(aa 
)aa 
;aa 
}bb 
}cc ¹{
Q/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Services/JwtService.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Services '
;' (
public 
class 

JwtService 
{ 
private 
readonly 
IConfiguration #
_configuration$ 2
;2 3
private 
readonly 
string 

_secretKey &
;& '
private 
readonly 
int 
_expirationHours )
;) *
public 


JwtService 
( 
IConfiguration $
configuration% 2
)2 3
{ 
_configuration 
= 
configuration &
;& '

_secretKey 
= 
_configuration #
[# $
$str$ 0
]0 1
??2 4
$str5 m
;m n
_expirationHours 
= 
int 
. 
Parse $
($ %
_configuration% 3
[3 4
$str4 I
]I J
??K M
$strN R
)R S
;S T
} 
public 

string 
GenerateToken 
(  
string  &
username' /
,/ 0
List1 5
<5 6
string6 <
>< =
roles> C
,C D
ListE I
<I J
stringJ P
>P Q
permissionsR ]
,] ^
string 
	authLevel 
= 
$str !
,! "
string# )
idp* -
=. /
$str0 7
)7 8
{ 
var   
tokenHandler   
=   
new   #
JwtSecurityTokenHandler   6
(  6 7
)  7 8
;  8 9
var!! 
key!! 
=!! 
Encoding!! 
.!! 
ASCII!!  
.!!  !
GetBytes!!! )
(!!) *

_secretKey!!* 4
)!!4 5
;!!5 6
var## 
claims## 
=## 
new## 
List## 
<## 
Claim## #
>### $
{$$ 	
new%% 
(%% 

ClaimTypes%% 
.%% 
Name%% 
,%%  
username%%! )
)%%) *
,%%* +
new&& 
(&& 

ClaimTypes&& 
.&& 
NameIdentifier&& )
,&&) *
username&&+ 3
)&&3 4
,&&4 5
new'' 
('' 
$str'' 
,'' 
	authLevel'' '
)''' (
,''( )
new(( 
((( 
$str(( 
,(( 
idp(( 
)(( 
})) 	
;))	 

foreach,, 
(,, 
var,, 
role,, 
in,, 
roles,, "
),," #
{-- 	
claims.. 
... 
Add.. 
(.. 
new.. 
Claim..  
(..  !

ClaimTypes..! +
...+ ,
Role.., 0
,..0 1
role..2 6
)..6 7
)..7 8
;..8 9
}// 	
foreach22 
(22 
var22 

permission22 
in22  "
permissions22# .
)22. /
{33 	
claims44 
.44 
Add44 
(44 
new44 
Claim44  
(44  !
$str44! -
,44- .

permission44/ 9
)449 :
)44: ;
;44; <
}55 	
var77 
tokenDescriptor77 
=77 
new77 !#
SecurityTokenDescriptor77" 9
{88 	
Subject99 
=99 
new99 
ClaimsIdentity99 (
(99( )
claims99) /
)99/ 0
,990 1
Expires:: 
=:: 
DateTime:: 
.:: 
UtcNow:: %
.::% &
AddHours::& .
(::. /
_expirationHours::/ ?
)::? @
,::@ A
IssuedAt;; 
=;; 
DateTime;; 
.;;  
UtcNow;;  &
,;;& '
SigningCredentials<< 
=<<  
new<<! $
SigningCredentials<<% 7
(<<7 8
new<<8 ; 
SymmetricSecurityKey<<< P
(<<P Q
key<<Q T
)<<T U
,<<U V
SecurityAlgorithms<<W i
.<<i j
HmacSha256Signature<<j }
)<<} ~
}== 	
;==	 

var?? 
token?? 
=?? 
tokenHandler??  
.??  !
CreateToken??! ,
(??, -
tokenDescriptor??- <
)??< =
;??= >
return@@ 
tokenHandler@@ 
.@@ 

WriteToken@@ &
(@@& '
token@@' ,
)@@, -
;@@- .
}AA 
publicFF 

boolFF 
ValidateTokenFF 
(FF 
stringFF $
tokenFF% *
)FF* +
{GG 
tryHH 
{II 	
varJJ 
tokenHandlerJJ 
=JJ 
newJJ "#
JwtSecurityTokenHandlerJJ# :
(JJ: ;
)JJ; <
;JJ< =
varKK 
keyKK 
=KK 
EncodingKK 
.KK 
ASCIIKK $
.KK$ %
GetBytesKK% -
(KK- .

_secretKeyKK. 8
)KK8 9
;KK9 :
tokenHandlerMM 
.MM 
ValidateTokenMM &
(MM& '
tokenMM' ,
,MM, -
newMM. 1%
TokenValidationParametersMM2 K
{NN $
ValidateIssuerSigningKeyOO (
=OO) *
trueOO+ /
,OO/ 0
IssuerSigningKeyPP  
=PP! "
newPP# & 
SymmetricSecurityKeyPP' ;
(PP; <
keyPP< ?
)PP? @
,PP@ A
ValidateIssuerQQ 
=QQ  
falseQQ! &
,QQ& '
ValidateAudienceRR  
=RR! "
falseRR# (
,RR( )
ValidateLifetimeSS  
=SS! "
trueSS# '
,SS' (
	ClockSkewTT 
=TT 
TimeSpanTT $
.TT$ %
ZeroTT% )
}UU 
,UU 
outUU 
SecurityTokenUU  
validatedTokenUU! /
)UU/ 0
;UU0 1
returnWW 
trueWW 
;WW 
}XX 	
catchYY 
{ZZ 	
return[[ 
false[[ 
;[[ 
}\\ 	
}]] 
publicbb 

stringbb 
?bb 
ExtractUsernamebb "
(bb" #
stringbb# )
tokenbb* /
)bb/ 0
{cc 
trydd 
{ee 	
varff 
tokenHandlerff 
=ff 
newff "#
JwtSecurityTokenHandlerff# :
(ff: ;
)ff; <
;ff< =
vargg 
	jsonTokengg 
=gg 
tokenHandlergg (
.gg( )
ReadJwtTokengg) 5
(gg5 6
tokengg6 ;
)gg; <
;gg< =
returnhh 
	jsonTokenhh 
.hh 
Claimshh #
.hh# $
FirstOrDefaulthh$ 2
(hh2 3
xhh3 4
=>hh5 7
xhh8 9
.hh9 :
Typehh: >
==hh? A

ClaimTypeshhB L
.hhL M
NamehhM Q
)hhQ R
?hhR S
.hhS T
ValuehhT Y
;hhY Z
}ii 	
catchjj 
{kk 	
returnll 
nullll 
;ll 
}mm 	
}nn 
publicss 

Listss 
<ss 
stringss 
>ss 
ExtractRolesss $
(ss$ %
stringss% +
tokenss, 1
)ss1 2
{tt 
tryuu 
{vv 	
varww 
tokenHandlerww 
=ww 
newww "#
JwtSecurityTokenHandlerww# :
(ww: ;
)ww; <
;ww< =
varxx 
	jsonTokenxx 
=xx 
tokenHandlerxx (
.xx( )
ReadJwtTokenxx) 5
(xx5 6
tokenxx6 ;
)xx; <
;xx< =
returnyy 
	jsonTokenyy 
.yy 
Claimsyy #
.zz 
Wherezz 
(zz 
xzz 
=>zz 
xzz 
.zz 
Typezz "
==zz# %

ClaimTypeszz& 0
.zz0 1
Rolezz1 5
)zz5 6
.{{ 
Select{{ 
({{ 
x{{ 
=>{{ 
x{{ 
.{{ 
Value{{ $
){{$ %
.|| 
ToList|| 
(|| 
)|| 
;|| 
}}} 	
catch~~ 
{ 	
return
 
new
 
List
 
<
 
string
 "
>
" #
(
# $
)
$ %
;
% &
}
 	
}
 
public
 

List
 
<
 
string
 
>
  
ExtractPermissions
 *
(
* +
string
+ 1
token
2 7
)
7 8
{
 
try
 
{
 	
var
 
tokenHandler
 
=
 
new
 "%
JwtSecurityTokenHandler
# :
(
: ;
)
; <
;
< =
var
 
	jsonToken
 
=
 
tokenHandler
 (
.
( )
ReadJwtToken
) 5
(
5 6
token
6 ;
)
; <
;
< =
return
 
	jsonToken
 
.
 
Claims
 #
.
 
Where
 
(
 
x
 
=>
 
x
 
.
 
Type
 "
==
# %
$str
& 2
)
2 3
.
 
Select
 
(
 
x
 
=>
 
x
 
.
 
Value
 $
)
$ %
.
 
ToList
 
(
 
)
 
;
 
}
 	
catch
 
{
 	
return
 
new
 
List
 
<
 
string
 "
>
" #
(
# $
)
$ %
;
% &
}
 	
}
 
public
 

string
 
ExtractAuthLevel
 "
(
" #
string
# )
token
* /
)
/ 0
{
 
try
 
{
 	
var
 
tokenHandler
 
=
 
new
 "%
JwtSecurityTokenHandler
# :
(
: ;
)
; <
;
< =
var
   
	jsonToken
   
=
   
tokenHandler
   (
.
  ( )
ReadJwtToken
  ) 5
(
  5 6
token
  6 ;
)
  ; <
;
  < =
return
¡¡ 
	jsonToken
¡¡ 
.
¡¡ 
Claims
¡¡ #
.
¡¡# $
FirstOrDefault
¡¡$ 2
(
¡¡2 3
x
¡¡3 4
=>
¡¡5 7
x
¡¡8 9
.
¡¡9 :
Type
¡¡: >
==
¡¡? A
$str
¡¡B N
)
¡¡N O
?
¡¡O P
.
¡¡P Q
Value
¡¡Q V
??
¡¡W Y
$str
¡¡Z `
;
¡¡` a
}
¢¢ 	
catch
££ 
{
¤¤ 	
return
¥¥ 
$str
¥¥ 
;
¥¥ 
}
¦¦ 	
}
§§ 
public
¬¬ 

string
¬¬ %
ExtractIdentityProvider
¬¬ )
(
¬¬) *
string
¬¬* 0
token
¬¬1 6
)
¬¬6 7
{
­­ 
try
®® 
{
¯¯ 	
var
°° 
tokenHandler
°° 
=
°° 
new
°° "%
JwtSecurityTokenHandler
°°# :
(
°°: ;
)
°°; <
;
°°< =
var
±± 
	jsonToken
±± 
=
±± 
tokenHandler
±± (
.
±±( )
ReadJwtToken
±±) 5
(
±±5 6
token
±±6 ;
)
±±; <
;
±±< =
return
²² 
	jsonToken
²² 
.
²² 
Claims
²² #
.
²²# $
FirstOrDefault
²²$ 2
(
²²2 3
x
²²3 4
=>
²²5 7
x
²²8 9
.
²²9 :
Type
²²: >
==
²²? A
$str
²²B G
)
²²G H
?
²²H I
.
²²I J
Value
²²J O
??
²²P R
$str
²²S Z
;
²²Z [
}
³³ 	
catch
´´ 
{
µµ 	
return
¶¶ 
$str
¶¶ 
;
¶¶ 
}
·· 	
}
¸¸ 
public
½½ 


Dictionary
½½ 
<
½½ 
string
½½ 
,
½½ 
object
½½ $
>
½½$ %
ExtractAllClaims
½½& 6
(
½½6 7
string
½½7 =
token
½½> C
)
½½C D
{
¾¾ 
try
¿¿ 
{
ÀÀ 	
var
ÁÁ 
tokenHandler
ÁÁ 
=
ÁÁ 
new
ÁÁ "%
JwtSecurityTokenHandler
ÁÁ# :
(
ÁÁ: ;
)
ÁÁ; <
;
ÁÁ< =
var
ÂÂ 
	jsonToken
ÂÂ 
=
ÂÂ 
tokenHandler
ÂÂ (
.
ÂÂ( )
ReadJwtToken
ÂÂ) 5
(
ÂÂ5 6
token
ÂÂ6 ;
)
ÂÂ; <
;
ÂÂ< =
var
ÄÄ 
claims
ÄÄ 
=
ÄÄ 
new
ÄÄ 

Dictionary
ÄÄ '
<
ÄÄ' (
string
ÄÄ( .
,
ÄÄ. /
object
ÄÄ0 6
>
ÄÄ6 7
(
ÄÄ7 8
)
ÄÄ8 9
;
ÄÄ9 :
foreach
ÅÅ 
(
ÅÅ 
var
ÅÅ 
claim
ÅÅ 
in
ÅÅ !
	jsonToken
ÅÅ" +
.
ÅÅ+ ,
Claims
ÅÅ, 2
)
ÅÅ2 3
{
ÆÆ 
if
ÇÇ 
(
ÇÇ 
claims
ÇÇ 
.
ÇÇ 
ContainsKey
ÇÇ &
(
ÇÇ& '
claim
ÇÇ' ,
.
ÇÇ, -
Type
ÇÇ- 1
)
ÇÇ1 2
)
ÇÇ2 3
{
ÈÈ 
if
ÉÉ 
(
ÉÉ 
claims
ÉÉ 
[
ÉÉ 
claim
ÉÉ $
.
ÉÉ$ %
Type
ÉÉ% )
]
ÉÉ) *
is
ÉÉ+ -
List
ÉÉ. 2
<
ÉÉ2 3
string
ÉÉ3 9
>
ÉÉ9 :
list
ÉÉ; ?
)
ÉÉ? @
{
ÊÊ 
list
ËË 
.
ËË 
Add
ËË  
(
ËË  !
claim
ËË! &
.
ËË& '
Value
ËË' ,
)
ËË, -
;
ËË- .
}
ÌÌ 
else
ÍÍ 
{
ÎÎ 
claims
ÏÏ 
[
ÏÏ 
claim
ÏÏ $
.
ÏÏ$ %
Type
ÏÏ% )
]
ÏÏ) *
=
ÏÏ+ ,
new
ÏÏ- 0
List
ÏÏ1 5
<
ÏÏ5 6
string
ÏÏ6 <
>
ÏÏ< =
{
ÏÏ> ?
claims
ÏÏ@ F
[
ÏÏF G
claim
ÏÏG L
.
ÏÏL M
Type
ÏÏM Q
]
ÏÏQ R
.
ÏÏR S
ToString
ÏÏS [
(
ÏÏ[ \
)
ÏÏ\ ]
!
ÏÏ] ^
,
ÏÏ^ _
claim
ÏÏ` e
.
ÏÏe f
Value
ÏÏf k
}
ÏÏl m
;
ÏÏm n
}
ÐÐ 
}
ÑÑ 
else
ÒÒ 
{
ÓÓ 
claims
ÔÔ 
[
ÔÔ 
claim
ÔÔ  
.
ÔÔ  !
Type
ÔÔ! %
]
ÔÔ% &
=
ÔÔ' (
claim
ÔÔ) .
.
ÔÔ. /
Value
ÔÔ/ 4
;
ÔÔ4 5
}
ÕÕ 
}
ÖÖ 
return
ØØ 
claims
ØØ 
;
ØØ 
}
ÙÙ 	
catch
ÚÚ 
{
ÛÛ 	
return
ÜÜ 
new
ÜÜ 

Dictionary
ÜÜ !
<
ÜÜ! "
string
ÜÜ" (
,
ÜÜ( )
object
ÜÜ* 0
>
ÜÜ0 1
(
ÜÜ1 2
)
ÜÜ2 3
;
ÜÜ3 4
}
ÝÝ 	
}
ÞÞ 
}ßß ú¥
E/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Logging 
. 
ClearProviders 
( 
)  
;  !
builder 
. 
Logging 
. 

AddConsole 
( 
) 
; 
builder 
. 
Logging 
. 
SetMinimumLevel 
(  
LogLevel  (
.( )
Information) 4
)4 5
;5 6
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
c  
=>! #
{ 
c 
. 

SwaggerDoc 
( 
$str 
, 
new 
	Microsoft $
.$ %
OpenApi% ,
., -
Models- 3
.3 4
OpenApiInfo4 ?
{ 
Title 
= 
$str 5
,5 6
Version 
= 
$str 
, 
Description   
=   
$str Q 
}RR 
)RR 
;RR 
cUU 
.UU !
AddSecurityDefinitionUU 
(UU 
$strUU $
,UU$ %
newUU& )
	MicrosoftUU* 3
.UU3 4
OpenApiUU4 ;
.UU; <
ModelsUU< B
.UUB C!
OpenApiSecuritySchemeUUC X
{VV 
DescriptionWW 
=WW 
$strWb 
,bb 
Namecc 
=cc 
$strcc 
,cc 
Indd 

=dd 
	Microsoftdd 
.dd 
OpenApidd 
.dd 
Modelsdd %
.dd% &
ParameterLocationdd& 7
.dd7 8
Headerdd8 >
,dd> ?
Typeee 
=ee 
	Microsoftee 
.ee 
OpenApiee  
.ee  !
Modelsee! '
.ee' (
SecuritySchemeTypeee( :
.ee: ;
ApiKeyee; A
,eeA B
Schemeff 
=ff 
$strff 
}gg 
)gg 
;gg 
cii 
.ii "
AddSecurityRequirementii 
(ii 
newii  
	Microsoftii! *
.ii* +
OpenApiii+ 2
.ii2 3
Modelsii3 9
.ii9 :&
OpenApiSecurityRequirementii: T
{jj 
{kk 	
newll 
	Microsoftll 
.ll 
OpenApill !
.ll! "
Modelsll" (
.ll( )!
OpenApiSecuritySchemell) >
{mm 
	Referencenn 
=nn 
newnn 
	Microsoftnn  )
.nn) *
OpenApinn* 1
.nn1 2
Modelsnn2 8
.nn8 9
OpenApiReferencenn9 I
{oo 
Typepp 
=pp 
	Microsoftpp $
.pp$ %
OpenApipp% ,
.pp, -
Modelspp- 3
.pp3 4
ReferenceTypepp4 A
.ppA B
SecuritySchemeppB P
,ppP Q
Idqq 
=qq 
$strqq !
}rr 
}ss 
,ss 
Arraytt 
.tt 
Emptytt 
<tt 
stringtt 
>tt 
(tt  
)tt  !
}uu 	
}vv 
)vv 
;vv 
}ww 
)ww 
;ww 
builderzz 
.zz 
Serviceszz 
.zz 
	AddScopedzz 
<zz 

JwtServicezz %
>zz% &
(zz& '
)zz' (
;zz( )
var}} 
	jwtSecret}} 
=}} 
builder}} 
.}} 
Configuration}} %
[}}% &
$str}}& 2
]}}2 3
??}}4 6
$str}}7 o
;}}o p
var~~ 
key~~ 
=~~ 	
Encoding~~
 
.~~ 
ASCII~~ 
.~~ 
GetBytes~~ !
(~~! "
	jwtSecret~~" +
)~~+ ,
;~~, -
builder 
.
 
Services
 
.
 
AddAuthentication
 "
(
" #
options
# *
=>
+ -
{ 
options
 
.
 '
DefaultAuthenticateScheme
 %
=
& '
JwtBearerDefaults
( 9
.
9 :"
AuthenticationScheme
: N
;
N O
options
 
.
 $
DefaultChallengeScheme
 "
=
# $
JwtBearerDefaults
% 6
.
6 7"
AuthenticationScheme
7 K
;
K L
} 
)
 
. 
AddJwtBearer
 
(
 
options
 
=>
 
{ 
options
 
.
 "
RequireHttpsMetadata
  
=
! "
false
# (
;
( )
options
 
.
 
	SaveToken
 
=
 
true
 
;
 
options
 
.
 '
TokenValidationParameters
 %
=
& '
new
( +'
TokenValidationParameters
, E
{
 &
ValidateIssuerSigningKey
  
=
! "
true
# '
,
' (
IssuerSigningKey
 
=
 
new
 "
SymmetricSecurityKey
 3
(
3 4
key
4 7
)
7 8
,
8 9
ValidateIssuer
 
=
 
false
 
,
 
ValidateAudience
 
=
 
false
  
,
  !
ValidateLifetime
 
=
 
true
 
,
  
	ClockSkew
 
=
 
TimeSpan
 
.
 
Zero
 !
}
 
;
 
} 
)
 
;
 
builder 
.
 
Services
 
.
 
AddAuthorization
 !
(
! "
options
" )
=>
* ,
{ 
options
 
.
 
	AddPolicy
 
(
 
$str
 2
,
2 3
policy
4 :
=>
; =
policy
 
.
 
Requirements
 
.
 
Add
 
(
  
new
  ##
PermissionRequirement
$ 9
(
9 :
$str
: F
)
F G
)
G H
)
H I
;
I J
options
 
.
 
	AddPolicy
 
(
 
$str
 3
,
3 4
policy
5 ;
=>
< >
policy
 
.
 
Requirements
 
.
 
Add
 
(
  
new
  ##
PermissionRequirement
$ 9
(
9 :
$str
: G
)
G H
)
H I
)
I J
;
J K
options
 
.
 
	AddPolicy
 
(
 
$str
 4
,
4 5
policy
6 <
=>
= ?
policy
 
.
 
Requirements
 
.
 
Add
 
(
  
new
  ##
PermissionRequirement
$ 9
(
9 :
$str
: H
)
H I
)
I J
)
J K
;
K L
options
¡¡ 
.
¡¡ 
	AddPolicy
¡¡ 
(
¡¡ 
$str
¡¡ 3
,
¡¡3 4
policy
¡¡5 ;
=>
¡¡< >
policy
¢¢ 
.
¢¢ 
Requirements
¢¢ 
.
¢¢ 
Add
¢¢ 
(
¢¢  
new
¢¢  ##
PermissionRequirement
¢¢$ 9
(
¢¢9 :
$str
¢¢: G
)
¢¢G H
)
¢¢H I
)
¢¢I J
;
¢¢J K
options
¥¥ 
.
¥¥ 
	AddPolicy
¥¥ 
(
¥¥ 
$str
¥¥ 9
,
¥¥9 :
policy
¥¥; A
=>
¥¥B D
policy
¦¦ 
.
¦¦ 
Requirements
¦¦ 
.
¦¦ 
Add
¦¦ 
(
¦¦  
new
¦¦  #&
AnyPermissionRequirement
¦¦$ <
(
¦¦< =
$str
¦¦= I
,
¦¦I J
$str
¦¦K X
)
¦¦X Y
)
¦¦Y Z
)
¦¦Z [
;
¦¦[ \
options
¨¨ 
.
¨¨ 
	AddPolicy
¨¨ 
(
¨¨ 
$str
¨¨ :
,
¨¨: ;
policy
¨¨< B
=>
¨¨C E
policy
©© 
.
©© 
Requirements
©© 
.
©© 
Add
©© 
(
©©  
new
©©  #&
AnyPermissionRequirement
©©$ <
(
©©< =
$str
©©= J
,
©©J K
$str
©©L Y
)
©©Y Z
)
©©Z [
)
©©[ \
;
©©\ ]
options
«« 
.
«« 
	AddPolicy
«« 
(
«« 
$str
«« ;
,
««; <
policy
««= C
=>
««D F
policy
¬¬ 
.
¬¬ 
Requirements
¬¬ 
.
¬¬ 
Add
¬¬ 
(
¬¬  
new
¬¬  #&
AnyPermissionRequirement
¬¬$ <
(
¬¬< =
$str
¬¬= K
,
¬¬K L
$str
¬¬M Z
)
¬¬Z [
)
¬¬[ \
)
¬¬\ ]
;
¬¬] ^
options
¯¯ 
.
¯¯ 
	AddPolicy
¯¯ 
(
¯¯ 
$str
¯¯ +
,
¯¯+ ,
policy
¯¯- 3
=>
¯¯4 6
policy
°° 
.
°° 
Requirements
°° 
.
°° 
Add
°° 
(
°°  
new
°°  #"
AuthLevelRequirement
°°$ 8
(
°°8 9
$str
°°9 ?
)
°°? @
)
°°@ A
)
°°A B
;
°°B C
options
²² 
.
²² 
	AddPolicy
²² 
(
²² 
$str
²² +
,
²²+ ,
policy
²²- 3
=>
²²4 6
policy
³³ 
.
³³ 
Requirements
³³ 
.
³³ 
Add
³³ 
(
³³  
new
³³  #"
AuthLevelRequirement
³³$ 8
(
³³8 9
$str
³³9 ?
)
³³? @
)
³³@ A
)
³³A B
;
³³B C
options
¶¶ 
.
¶¶ 
	AddPolicy
¶¶ 
(
¶¶ 
$str
¶¶ ,
,
¶¶, -
policy
¶¶. 4
=>
¶¶5 7
policy
·· 
.
·· 
Requirements
·· 
.
·· 
Add
·· 
(
··  
new
··  #)
IdentityProviderRequirement
··$ ?
(
··? @
$str
··@ Q
)
··Q R
)
··R S
)
··S T
;
··T U
options
ºº 
.
ºº 
	AddPolicy
ºº 
(
ºº 
$str
ºº .
,
ºº. /
policy
ºº0 6
=>
ºº7 9
{
»» 
policy
¼¼ 
.
¼¼ 
RequireRole
¼¼ 
(
¼¼ 
$str
¼¼ "
)
¼¼" #
;
¼¼# $
policy
½½ 
.
½½ 
Requirements
½½ 
.
½½ 
Add
½½ 
(
½½  
new
½½  ##
PermissionRequirement
½½$ 9
(
½½9 :
$str
½½: G
)
½½G H
)
½½H I
;
½½I J
policy
¾¾ 
.
¾¾ 
Requirements
¾¾ 
.
¾¾ 
Add
¾¾ 
(
¾¾  
new
¾¾  #&
AnyPermissionRequirement
¾¾$ <
(
¾¾< =
$str
¾¾= N
,
¾¾N O
$str
¾¾P e
)
¾¾e f
)
¾¾f g
;
¾¾g h
}
¿¿ 
)
¿¿ 
;
¿¿ 
}ÀÀ 
)
ÀÀ 
;
ÀÀ 
builderÃÃ 
.
ÃÃ 
Services
ÃÃ 
.
ÃÃ 
	AddScoped
ÃÃ 
<
ÃÃ #
IAuthorizationHandler
ÃÃ 0
,
ÃÃ0 1
PermissionHandler
ÃÃ2 C
>
ÃÃC D
(
ÃÃD E
)
ÃÃE F
;
ÃÃF G
builderÄÄ 
.
ÄÄ 
Services
ÄÄ 
.
ÄÄ 
	AddScoped
ÄÄ 
<
ÄÄ #
IAuthorizationHandler
ÄÄ 0
,
ÄÄ0 1"
AnyPermissionHandler
ÄÄ2 F
>
ÄÄF G
(
ÄÄG H
)
ÄÄH I
;
ÄÄI J
builderÅÅ 
.
ÅÅ 
Services
ÅÅ 
.
ÅÅ 
	AddScoped
ÅÅ 
<
ÅÅ #
IAuthorizationHandler
ÅÅ 0
,
ÅÅ0 1#
AllPermissionsHandler
ÅÅ2 G
>
ÅÅG H
(
ÅÅH I
)
ÅÅI J
;
ÅÅJ K
builderÆÆ 
.
ÆÆ 
Services
ÆÆ 
.
ÆÆ 
	AddScoped
ÆÆ 
<
ÆÆ #
IAuthorizationHandler
ÆÆ 0
,
ÆÆ0 1
AuthLevelHandler
ÆÆ2 B
>
ÆÆB C
(
ÆÆC D
)
ÆÆD E
;
ÆÆE F
builderÇÇ 
.
ÇÇ 
Services
ÇÇ 
.
ÇÇ 
	AddScoped
ÇÇ 
<
ÇÇ #
IAuthorizationHandler
ÇÇ 0
,
ÇÇ0 1%
IdentityProviderHandler
ÇÇ2 I
>
ÇÇI J
(
ÇÇJ K
)
ÇÇK L
;
ÇÇL M
builderÊÊ 
.
ÊÊ 
Services
ÊÊ 
.
ÊÊ 
AddHealthChecks
ÊÊ  
(
ÊÊ  !
)
ÊÊ! "
.
ËË 
AddCheck
ËË 
(
ËË 
$str
ËË 
,
ËË 
(
ËË 
)
ËË 
=>
ËË 
HealthCheckResult
ËË -
.
ËË- .
Healthy
ËË. 5
(
ËË5 6
)
ËË6 7
,
ËË7 8
new
ËË9 <
[
ËË< =
]
ËË= >
{
ËË? @
$str
ËËA H
}
ËËI J
)
ËËJ K
.
ÌÌ 
AddCheck
ÌÌ 
(
ÌÌ 
$str
ÌÌ 
,
ÌÌ 
(
ÌÌ 
)
ÌÌ 
=>
ÌÌ 
HealthCheckResult
ÌÌ  1
.
ÌÌ1 2
Healthy
ÌÌ2 9
(
ÌÌ9 :
)
ÌÌ: ;
,
ÌÌ; <
new
ÌÌ= @
[
ÌÌ@ A
]
ÌÌA B
{
ÌÌC D
$str
ÌÌE K
}
ÌÌL M
)
ÌÌM N
;
ÌÌN O
varÏÏ 
otelEndpoint
ÏÏ 
=
ÏÏ 
Environment
ÏÏ 
.
ÏÏ $
GetEnvironmentVariable
ÏÏ 5
(
ÏÏ5 6
$str
ÏÏ6 S
)
ÏÏS T
??
ÏÏU W
$str
ÏÏX t
;
ÏÏt u
builderÐÐ 
.
ÐÐ 
Services
ÐÐ 
.
ÐÐ 
AddOpenTelemetry
ÐÐ !
(
ÐÐ! "
)
ÐÐ" #
.
ÑÑ 
ConfigureResource
ÑÑ 
(
ÑÑ 
resource
ÑÑ 
=>
ÑÑ  "
resource
ÑÑ# +
.
ÒÒ 	

AddService
ÒÒ	 
(
ÒÒ 
serviceName
ÒÒ 
:
ÒÒ  
$str
ÒÒ! -
,
ÒÒ- .
serviceVersion
ÒÒ/ =
:
ÒÒ= >
$str
ÒÒ? F
)
ÒÒF G
)
ÒÒG H
.
ÓÓ 
WithMetrics
ÓÓ 
(
ÓÓ 
metrics
ÓÓ 
=>
ÓÓ 
{
ÔÔ 
metrics
ÕÕ 
.
ÖÖ *
AddAspNetCoreInstrumentation
ÖÖ )
(
ÖÖ) *
)
ÖÖ* +
.
×× 
AddOtlpExporter
×× 
(
×× 
options
×× $
=>
××% '
{
ØØ 
options
ÙÙ 
.
ÙÙ 
Endpoint
ÙÙ  
=
ÙÙ! "
new
ÙÙ# &
Uri
ÙÙ' *
(
ÙÙ* +
otelEndpoint
ÙÙ+ 7
)
ÙÙ7 8
;
ÙÙ8 9
options
ÚÚ 
.
ÚÚ 
Protocol
ÚÚ  
=
ÚÚ! "
OpenTelemetry
ÚÚ# 0
.
ÚÚ0 1
Exporter
ÚÚ1 9
.
ÚÚ9 : 
OtlpExportProtocol
ÚÚ: L
.
ÚÚL M
Grpc
ÚÚM Q
;
ÚÚQ R
}
ÛÛ 
)
ÛÛ 
;
ÛÛ 
}
ÜÜ 
)
ÜÜ 
;
ÜÜ 
varÞÞ 
app
ÞÞ 
=
ÞÞ 	
builder
ÞÞ
 
.
ÞÞ 
Build
ÞÞ 
(
ÞÞ 
)
ÞÞ 
;
ÞÞ 
varáá 
logger
áá 

=
áá 
app
áá 
.
áá 
Services
áá 
.
áá  
GetRequiredService
áá ,
<
áá, -
ILogger
áá- 4
<
áá4 5
Program
áá5 <
>
áá< =
>
áá= >
(
áá> ?
)
áá? @
;
áá@ A
loggerââ 
.
ââ 
LogInformation
ââ 
(
ââ 
$str
ââ M
)
ââM N
;
ââN O
loggerãã 
.
ãã 
LogInformation
ãã 
(
ãã 
$str
ãã N
,
ããN O
otelEndpoint
ããP \
)
ãã\ ]
;
ãã] ^
loggerää 
.
ää 
LogInformation
ää 
(
ää 
$str
ää \
)
ää\ ]
;
ää] ^
ifçç 
(
çç 
app
çç 
.
çç 
Environment
çç 
.
çç 
IsDevelopment
çç !
(
çç! "
)
çç" #
)
çç# $
{èè 
app
éé 
.
éé 

UseSwagger
éé 
(
éé 
)
éé 
;
éé 
app
êê 
.
êê 
UseSwaggerUI
êê 
(
êê 
)
êê 
;
êê 
}ëë 
appðð 
.
ðð 
UseHttpMetrics
ðð 
(
ðð 
)
ðð 
;
ðð 
appññ 
.
ññ 

UseRouting
ññ 
(
ññ 
)
ññ 
;
ññ 
appôô 
.
ôô 
UseAuthentication
ôô 
(
ôô 
)
ôô 
;
ôô 
appõõ 
.
õõ 
UseAuthorization
õõ 
(
õõ 
)
õõ 
;
õõ 
app÷÷ 
.
÷÷ 
MapControllers
÷÷ 
(
÷÷ 
)
÷÷ 
;
÷÷ 
appúú 
.
úú 
MapHealthChecks
úú 
(
úú 
$str
úú #
,
úú# $
new
úú% ( 
HealthCheckOptions
úú) ;
{ûû 
	Predicate
üü 
=
üü 
check
üü 
=>
üü 
check
üü 
.
üü 
Tags
üü #
.
üü# $
Contains
üü$ ,
(
üü, -
$str
üü- 4
)
üü4 5
}ýý 
)
ýý 
;
ýý 
appÿÿ 
.
ÿÿ 
MapHealthChecks
ÿÿ 
(
ÿÿ 
$str
ÿÿ "
,
ÿÿ" #
new
ÿÿ$ ' 
HealthCheckOptions
ÿÿ( :
{ 
	Predicate
 
=
 
check
 
=>
 
check
 
.
 
Tags
 #
.
# $
Contains
$ ,
(
, -
$str
- 3
)
3 4
} 
)
 
;
 
app 
.
 
MapHealthChecks
 
(
 
$str
 &
,
& '
new
( + 
HealthCheckOptions
, >
{ 
ResponseWriter
 
=
 
async
 
(
 
context
 #
,
# $
report
% +
)
+ ,
=>
- /
{
 
context
 
.
 
Response
 
.
 
ContentType
 $
=
% &
$str
' 9
;
9 :
var
 
response
 
=
 
new
 
{
 	
status
 
=
 
report
 
.
 
Status
 "
.
" #
ToString
# +
(
+ ,
)
, -
,
- .

components
 
=
 
report
 
.
  
Entries
  '
.
' (
ToDictionary
( 4
(
4 5
entry
 
=>
 
entry
 
.
 
Key
 "
,
" #
entry
 
=>
 
new
 
{
 
status
 
=
 
entry
 "
.
" #
Value
# (
.
( )
Status
) /
.
/ 0
ToString
0 8
(
8 9
)
9 :
,
: ;
details
 
=
 
entry
 #
.
# $
Value
$ )
.
) *
Description
* 5
}
 
)
 
}
 	
;
	 

await
 
context
 
.
 
Response
 
.
 

WriteAsync
 )
(
) *
JsonSerializer
* 8
.
8 9
	Serialize
9 B
(
B C
response
C K
)
K L
)
L M
;
M N
}
 
} 
)
 
;
 
app 
.
 

MapMetrics
 
(
 
)
 
;
 
app 
.
 
Run
 
(
 
)
 	
;
	 
ÅR
a/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Controllers/VulnerableJWTController.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Controllers *
;* +
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
public		 
class		 #
VulnerableJWTController		 $
:		% &
ControllerBase		' 5
{

 
private 
readonly 
ILogger 
< #
VulnerableJWTController 4
>4 5
_logger6 =
;= >
private 
static 
readonly 
string "
WEAK_SECRET# .
=/ 0
$str1 A
;A B
public 
#
VulnerableJWTController "
(" #
ILogger# *
<* +#
VulnerableJWTController+ B
>B C
loggerD J
)J K
{ 
_logger 
= 
logger 
; 
} 
[ 
HttpPost 
( 
$str 
) 
] 
public 

IActionResult 
CreateToken $
($ %
[% &
FromBody& .
]. /

Dictionary0 :
<: ;
string; A
,A B
objectC I
>I J
payloadK R
)R S
{ 
try 
{ 	
var 
header 
= 
Convert  
.  !
ToBase64String! /
(/ 0
Encoding0 8
.8 9
UTF89 =
.= >
GetBytes> F
(F G
$strG l
)l m
)m n
;n o
var 

payloadStr 
= 
Convert $
.$ %
ToBase64String% 3
(3 4
Encoding4 <
.< =
UTF8= A
.A B
GetBytesB J
(J K
JsonSerializerK Y
.Y Z
	SerializeZ c
(c d
payloadd k
)k l
)l m
)m n
;n o
var   
	signature   
=   
Convert   #
.  # $
ToBase64String  $ 2
(  2 3
Encoding  3 ;
.  ; <
UTF8  < @
.  @ A
GetBytes  A I
(  I J
WEAK_SECRET  J U
)  U V
)  V W
;  W X
var"" 
token"" 
="" 
$""" 
{"" 
header"" !
}""! "
$str""" #
{""# $

payloadStr""$ .
}"". /
$str""/ 0
{""0 1
	signature""1 :
}"": ;
"""; <
;""< =
return## 
Ok## 
(## 
token## 
)## 
;## 
}$$ 	
catch%% 
(%% 
	Exception%% 
e%% 
)%% 
{&& 	
return'' 

BadRequest'' 
('' 
$"''  
$str''  6
{''6 7
e''7 8
.''8 9
Message''9 @
}''@ A
"''A B
)''B C
;''C D
}(( 	
})) 
[.. 
HttpPost.. 
(.. 
$str.. 
).. 
].. 
public// 

IActionResult// 
VerifyToken// $
(//$ %
[//% &
FromBody//& .
]//. /

Dictionary//0 :
<//: ;
string//; A
,//A B
string//C I
>//I J
request//K R
)//R S
{00 
try11 
{22 	
var33 
token33 
=33 
request33 
.33  
GetValueOrDefault33  1
(331 2
$str332 9
,339 :
$str33; =
)33= >
;33> ?
var66 
response66 
=66 
new66 

Dictionary66 )
<66) *
string66* 0
,660 1
object662 8
>668 9
{77 
[88 
$str88 
]88 
=88 
true88  
,88  !
[99 
$str99 
]99 
=99 
token99 !
,99! "
[:: 
$str:: 
]:: 
=:: 
$str:: H
};; 
;;; 
return== 
Ok== 
(== 
response== 
)== 
;==  
}>> 	
catch?? 
(?? 
	Exception?? 
e?? 
)?? 
{@@ 	
varAA 
responseAA 
=AA 
newAA 

DictionaryAA )
<AA) *
stringAA* 0
,AA0 1
objectAA2 8
>AA8 9
{BB 
[CC 
$strCC 
]CC 
=CC 
falseCC !
,CC! "
[DD 
$strDD 
]DD 
=DD 
eDD 
.DD 
MessageDD %
}EE 
;EE 
returnGG 
OkGG 
(GG 
responseGG 
)GG 
;GG  
}HH 	
}II 
[NN 
HttpGetNN 
(NN 
$strNN 
)NN 
]NN 
publicOO 

IActionResultOO 
DecodeTokenOO $
(OO$ %
[OO% &
	FromQueryOO& /
]OO/ 0
stringOO1 7
tokenOO8 =
)OO= >
{PP 
tryQQ 
{RR 	
varTT 
partsTT 
=TT 
tokenTT 
.TT 
SplitTT #
(TT# $
$charTT$ '
)TT' (
;TT( )
varUU 
responseUU 
=UU 
newUU 

DictionaryUU )
<UU) *
stringUU* 0
,UU0 1
objectUU2 8
>UU8 9
{VV 
[WW 
$strWW 
]WW 
=WW 
trueWW "
,WW" #
[XX 
$strXX 
]XX 
=XX 
partsXX "
.XX" #
LengthXX# )
>XX* +
$numXX, -
?XX. /
EncodingXX0 8
.XX8 9
UTF8XX9 =
.XX= >
	GetStringXX> G
(XXG H
ConvertXXH O
.XXO P
FromBase64StringXXP `
(XX` a
partsXXa f
[XXf g
$numXXg h
]XXh i
)XXi j
)XXj k
:XXl m
$strXXn p
,XXp q
[YY 
$strYY 
]YY 
=YY 
partsYY #
.YY# $
LengthYY$ *
>YY+ ,
$numYY- .
?YY/ 0
EncodingYY1 9
.YY9 :
UTF8YY: >
.YY> ?
	GetStringYY? H
(YYH I
ConvertYYI P
.YYP Q
FromBase64StringYYQ a
(YYa b
partsYYb g
[YYg h
$numYYh i
]YYi j
)YYj k
)YYk l
:YYm n
$strYYo q
,YYq r
[ZZ 
$strZZ 
]ZZ 
=ZZ 
partsZZ  %
.ZZ% &
LengthZZ& ,
>ZZ- .
$numZZ/ 0
?ZZ1 2
partsZZ3 8
[ZZ8 9
$numZZ9 :
]ZZ: ;
:ZZ< =
$strZZ> @
}[[ 
;[[ 
return]] 
Ok]] 
(]] 
response]] 
)]] 
;]]  
}^^ 	
catch__ 
(__ 
	Exception__ 
e__ 
)__ 
{`` 	
varaa 
responseaa 
=aa 
newaa 

Dictionaryaa )
<aa) *
stringaa* 0
,aa0 1
objectaa2 8
>aa8 9
{bb 
[cc 
$strcc 
]cc 
=cc 
falsecc #
,cc# $
[dd 
$strdd 
]dd 
=dd 
edd 
.dd 
Messagedd %
}ee 
;ee 
returngg 
Okgg 
(gg 
responsegg 
)gg 
;gg  
}hh 	
}ii 
[nn 
HttpPostnn 
(nn 
$strnn $
)nn$ %
]nn% &
publicoo 

IActionResultoo 
VerifyAnyAlgorithmoo +
(oo+ ,
[oo, -
FromBodyoo- 5
]oo5 6

Dictionaryoo7 A
<ooA B
stringooB H
,ooH I
stringooJ P
>ooP Q
requestooR Y
)ooY Z
{pp 
tryqq 
{rr 	
varss 
tokenss 
=ss 
requestss 
.ss  
GetValueOrDefaultss  1
(ss1 2
$strss2 9
,ss9 :
$strss; =
)ss= >
;ss> ?
vartt 
	algorithmtt 
=tt 
requesttt #
.tt# $
GetValueOrDefaulttt$ 5
(tt5 6
$strtt6 A
,ttA B
$strttC E
)ttE F
;ttF G
varww 
responseww 
=ww 
newww 

Dictionaryww )
<ww) *
stringww* 0
,ww0 1
objectww2 8
>ww8 9
{xx 
[yy 
$stryy 
]yy 
=yy 
trueyy  
,yy  !
[zz 
$strzz 
]zz 
=zz 
	algorithmzz  )
,zz) *
[{{ 
$str{{ 
]{{ 
={{ 
token{{ !
,{{! "
[|| 
$str|| 
]|| 
=|| 
$"||  
$str||  G
{||G H
	algorithm||H Q
}||Q R
"||R S
}}} 
;}} 
return 
Ok 
( 
response 
) 
;  
}
 	
catch
 
(
 
	Exception
 
e
 
)
 
{
 	
var
 
response
 
=
 
new
 

Dictionary
 )
<
) *
string
* 0
,
0 1
object
2 8
>
8 9
{
 
[
 
$str
 
]
 
=
 
false
 !
,
! "
[
 
$str
 
]
 
=
 
e
 
.
 
Message
 %
}
 
;
 
return
 
Ok
 
(
 
response
 
)
 
;
  
}
 	
}
 
} |
Y/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Controllers/TokenController.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Controllers *
;* +
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
[ 
Tags 
( 
$str 
) 
] 
public 
class 
TokenController 
: 
ControllerBase -
{ 
private 
readonly 

JwtService 
_jwtService  +
;+ ,
private 
readonly 
ILogger 
< 
TokenController ,
>, -
_logger. 5
;5 6
public 

TokenController 
( 

JwtService %

jwtService& 0
,0 1
ILogger2 9
<9 :
TokenController: I
>I J
loggerK Q
)Q R
{ 
_jwtService 
= 

jwtService  
;  !
_logger 
= 
logger 
; 
} 
[ 
HttpPost 
( 
$str 
) 
] 
[  
ProducesResponseType 
( 
typeof  
(  !
object! '
)' (
,( )
$num* -
)- .
]. /
[  
ProducesResponseType 
( 
$num 
) 
] 
public 

IActionResult 
GenerateToken &
(& '
[   	
	FromQuery  	 
,   
Required   
]   
string   $
username  % -
,  - .
[!! 	
	FromQuery!!	 
]!! 
string!! 
?!! 
roles!! !
=!!" #
null!!$ (
,!!( )
["" 	
	FromQuery""	 
]"" 
string"" 
?"" 
permissions"" '
=""( )
null""* .
)"". /
{## 
var%% 
	rolesList%% 
=%% 
string%% 
.%% 
IsNullOrEmpty%% ,
(%%, -
roles%%- 2
)%%2 3
?&& 
new&& 
List&& 
<&& 
string&& 
>&& 
{&&  
$str&&! '
}&&( )
:'' 
roles'' 
.'' 
Split'' 
('' 
$char'' 
)'' 
.'' 
Select'' %
(''% &
r''& '
=>''( *
r''+ ,
.'', -
Trim''- 1
(''1 2
)''2 3
)''3 4
.''4 5
ToList''5 ;
(''; <
)''< =
;''= >
var)) 
permissionsList)) 
=)) 
string)) $
.))$ %
IsNullOrEmpty))% 2
())2 3
permissions))3 >
)))> ?
?** 
new** 
List** 
<** 
string** 
>** 
{**  
$str**! -
}**. /
:++ 
permissions++ 
.++ 
Split++ 
(++  
$char++  #
)++# $
.++$ %
Select++% +
(+++ ,
p++, -
=>++. 0
p++1 2
.++2 3
Trim++3 7
(++7 8
)++8 9
)++9 :
.++: ;
ToList++; A
(++A B
)++B C
;++C D
var-- 
token-- 
=-- 
_jwtService-- 
.--  
GenerateToken--  -
(--- .
username--. 6
,--6 7
	rolesList--8 A
,--A B
permissionsList--C R
)--R S
;--S T
var// 
response// 
=// 
new// 
{00 	
token11 
,11 
username22 
,22 
roles33 
=33 
	rolesList33 
,33 
permissions44 
=44 
permissionsList44 )
,44) *
	expiresIn55 
=55 
$str55 "
,55" #
	timestamp66 
=66 
DateTimeOffset66 &
.66& '
UtcNow66' -
.66- ."
ToUnixTimeMilliseconds66. D
(66D E
)66E F
}77 	
;77	 

return99 
Ok99 
(99 
response99 
)99 
;99 
}:: 
[?? 
HttpGet?? 
(?? 
$str?? 
)?? 
]?? 
[@@  
ProducesResponseType@@ 
(@@ 
typeof@@  
(@@  !
object@@! '
)@@' (
,@@( )
$num@@* -
)@@- .
]@@. /
[AA  
ProducesResponseTypeAA 
(AA 
$numAA 
)AA 
]AA 
publicBB 

IActionResultBB #
GeneratePredefinedTokenBB 0
(BB0 1
stringBB1 7
typeBB8 <
)BB< =
{CC 
stringDD 
usernameDD 
;DD 
ListEE 
<EE 
stringEE 
>EE 
rolesEE 
;EE 
ListFF 
<FF 
stringFF 
>FF 
permissionsFF  
;FF  !
stringGG 
	authLevelGG 
;GG 
stringHH 
idpHH 
;HH 
switchJJ 
(JJ 
typeJJ 
.JJ 
ToLowerJJ 
(JJ 
)JJ 
)JJ 
{KK 	
caseLL 
$strLL 
:LL 
usernameMM 
=MM 
$strMM "
;MM" #
rolesNN 
=NN 
newNN 
ListNN  
<NN  !
stringNN! '
>NN' (
{NN) *
$strNN+ 2
,NN2 3
$strNN4 :
}NN; <
;NN< =
permissionsOO 
=OO 
newOO !
ListOO" &
<OO& '
stringOO' -
>OO- .
{OO/ 0
$strOO1 =
,OO= >
$strOO? L
,OOL M
$strOON \
,OO\ ]
$strOO^ k
}OOl m
;OOm n
	authLevelPP 
=PP 
$strPP "
;PP" #
idpQQ 
=QQ 
$strQQ '
;QQ' (
breakRR 
;RR 
caseSS 
$strSS 
:SS 
usernameTT 
=TT 
$strTT !
;TT! "
rolesUU 
=UU 
newUU 
ListUU  
<UU  !
stringUU! '
>UU' (
{UU) *
$strUU+ 1
}UU2 3
;UU3 4
permissionsVV 
=VV 
newVV !
ListVV" &
<VV& '
stringVV' -
>VV- .
{VV/ 0
$strVV1 =
}VV> ?
;VV? @
	authLevelWW 
=WW 
$strWW "
;WW" #
idpXX 
=XX 
$strXX 
;XX 
breakYY 
;YY 
caseZZ 
$strZZ 
:ZZ 
username[[ 
=[[ 
$str[[ (
;[[( )
roles\\ 
=\\ 
new\\ 
List\\  
<\\  !
string\\! '
>\\' (
{\\) *
$str\\+ 1
}\\2 3
;\\3 4
permissions]] 
=]] 
new]] !
List]]" &
<]]& '
string]]' -
>]]- .
{]]/ 0
$str]]1 =
,]]= >
$str]]? L
,]]L M
$str]]N \
,]]\ ]
$str]]^ k
}]]l m
;]]m n
	authLevel^^ 
=^^ 
$str^^ "
;^^" #
idp__ 
=__ 
$str__  
;__  !
break`` 
;`` 
caseaa 
$straa 
:aa  
usernamebb 
=bb 
$strbb )
;bb) *
rolescc 
=cc 
newcc 
Listcc  
<cc  !
stringcc! '
>cc' (
{cc) *
$strcc+ 1
}cc2 3
;cc3 4
permissionsdd 
=dd 
newdd !
Listdd" &
<dd& '
stringdd' -
>dd- .
{dd/ 0
$strdd1 =
,dd= >
$strdd? L
}ddM N
;ddN O
	authLevelee 
=ee 
$stree "
;ee" #
idpff 
=ff 
$strff 
;ff 
breakgg 
;gg 
casehh 
$strhh 
:hh  
usernameii 
=ii 
$strii )
;ii) *
rolesjj 
=jj 
newjj 
Listjj  
<jj  !
stringjj! '
>jj' (
{jj) *
$strjj+ 1
}jj2 3
;jj3 4
permissionskk 
=kk 
newkk !
Listkk" &
<kk& '
stringkk' -
>kk- .
{kk/ 0
$strkk1 =
}kk> ?
;kk? @
	authLevelll 
=ll 
$strll "
;ll" #
idpmm 
=mm 
$strmm 
;mm 
breaknn 
;nn 
caseoo 
$stroo 
:oo 
usernamepp 
=pp 
$strpp &
;pp& '
rolesqq 
=qq 
newqq 
Listqq  
<qq  !
stringqq! '
>qq' (
{qq) *
$strqq+ 1
}qq2 3
;qq3 4
permissionsrr 
=rr 
newrr !
Listrr" &
<rr& '
stringrr' -
>rr- .
{rr/ 0
$strrr1 =
}rr> ?
;rr? @
	authLevelss 
=ss 
$strss "
;ss" #
idptt 
=tt 
$strtt 
;tt 
breakuu 
;uu 
casevv 
$strvv 
:vv 
usernameww 
=ww 
$strww &
;ww& '
rolesxx 
=xx 
newxx 
Listxx  
<xx  !
stringxx! '
>xx' (
{xx) *
$strxx+ 1
}xx2 3
;xx3 4
permissionsyy 
=yy 
newyy !
Listyy" &
<yy& '
stringyy' -
>yy- .
{yy/ 0
$stryy1 =
,yy= >
$stryy? L
}yyM N
;yyN O
	authLevelzz 
=zz 
$strzz "
;zz" #
idp{{ 
={{ 
$str{{  
;{{  !
break|| 
;|| 
case}} 
$str}} 
:}} 
username~~ 
=~~ 
$str~~ &
;~~& '
roles 
= 
new 
List  
<  !
string! '
>' (
{) *
$str+ 2
}3 4
;4 5
permissions
 
=
 
new
 !
List
" &
<
& '
string
' -
>
- .
{
/ 0
$str
1 =
,
= >
$str
? L
,
L M
$str
N \
,
\ ]
$str
^ k
}
l m
;
m n
	authLevel
 
=
 
$str
 "
;
" #
idp
 
=
 
$str
 '
;
' (
break
 
;
 
default
 
:
 
return
 

BadRequest
 !
(
! "
new
" %
{
& '
error
( -
=
. /
$str
0 D
}
E F
)
F G
;
G H
}
 	
var
 
token
 
=
 
_jwtService
 
.
  
GenerateToken
  -
(
- .
username
. 6
,
6 7
roles
8 =
,
= >
permissions
? J
,
J K
	authLevel
L U
,
U V
idp
W Z
)
Z [
;
[ \
var
 
response
 
=
 
new
 
{
 	
token
 
,
 
username
 
,
 
roles
 
,
 
permissions
 
,
 

auth_level
 
=
 
	authLevel
 "
,
" #
idp
 
,
 
type
 
,
 
	expiresIn
 
=
 
$str
 "
,
" #
	timestamp
 
=
 
DateTimeOffset
 &
.
& '
UtcNow
' -
.
- .$
ToUnixTimeMilliseconds
. D
(
D E
)
E F
}
 	
;
	 

return
 
Ok
 
(
 
response
 
)
 
;
 
}
 
[
 
HttpPost
 
(
 
$str
 
)
 
]
 
[
 "
ProducesResponseType
 
(
 
typeof
  
(
  !
object
! '
)
' (
,
( )
$num
* -
)
- .
]
. /
public
 

IActionResult
 
ValidateToken
 &
(
& '
[
' (
Required
( 0
]
0 1
string
2 8
token
9 >
)
> ?
{
   
var
¡¡ 
isValid
¡¡ 
=
¡¡ 
_jwtService
¡¡ !
.
¡¡! "
ValidateToken
¡¡" /
(
¡¡/ 0
token
¡¡0 5
)
¡¡5 6
;
¡¡6 7
if
££ 

(
££ 
isValid
££ 
)
££ 
{
¤¤ 	
var
¥¥ 
response
¥¥ 
=
¥¥ 
new
¥¥ 
{
¦¦ 
valid
§§ 
=
§§ 
isValid
§§ 
,
§§  
username
¨¨ 
=
¨¨ 
_jwtService
¨¨ &
.
¨¨& '
ExtractUsername
¨¨' 6
(
¨¨6 7
token
¨¨7 <
)
¨¨< =
,
¨¨= >
roles
©© 
=
©© 
_jwtService
©© #
.
©©# $
ExtractRoles
©©$ 0
(
©©0 1
token
©©1 6
)
©©6 7
,
©©7 8
permissions
ªª 
=
ªª 
_jwtService
ªª )
.
ªª) * 
ExtractPermissions
ªª* <
(
ªª< =
token
ªª= B
)
ªªB C
,
ªªC D

auth_level
«« 
=
«« 
_jwtService
«« (
.
««( )
ExtractAuthLevel
««) 9
(
««9 :
token
««: ?
)
««? @
,
««@ A
idp
¬¬ 
=
¬¬ 
_jwtService
¬¬ !
.
¬¬! "%
ExtractIdentityProvider
¬¬" 9
(
¬¬9 :
token
¬¬: ?
)
¬¬? @
,
¬¬@ A
	timestamp
­­ 
=
­­ 
DateTimeOffset
­­ *
.
­­* +
UtcNow
­­+ 1
.
­­1 2$
ToUnixTimeMilliseconds
­­2 H
(
­­H I
)
­­I J
}
®® 
;
®® 
return
¯¯ 
Ok
¯¯ 
(
¯¯ 
response
¯¯ 
)
¯¯ 
;
¯¯  
}
°° 	
else
±± 
{
²² 	
var
³³ 
response
³³ 
=
³³ 
new
³³ 
{
´´ 
valid
µµ 
=
µµ 
isValid
µµ 
,
µµ  
	timestamp
¶¶ 
=
¶¶ 
DateTimeOffset
¶¶ *
.
¶¶* +
UtcNow
¶¶+ 1
.
¶¶1 2$
ToUnixTimeMilliseconds
¶¶2 H
(
¶¶H I
)
¶¶I J
}
·· 
;
·· 
return
¸¸ 
Ok
¸¸ 
(
¸¸ 
response
¸¸ 
)
¸¸ 
;
¸¸  
}
¹¹ 	
}
ºº 
}»» (
[/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Controllers/MetricsController.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Controllers *
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public		 

class		 
MetricsController		 "
:		# $
ControllerBase		% 3
{

 
private 
static 
readonly 
Meter  %
_meter& ,
=- .
new/ 2
(2 3
$str3 Q
,Q R
$strS Z
)Z [
;[ \
private 
static 
readonly 
Counter  '
<' (
long( ,
>, -
_requestCounter. =
=> ?
_meter@ F
.F G
CreateCounterG T
<T U
longU Y
>Y Z
(Z [
$str[ r
,r s
$str	t 
)
 
;
 
private 
static 
readonly 
	Histogram  )
<) *
double* 0
>0 1
_responseTime2 ?
=@ A
_meterB H
.H I
CreateHistogramI X
<X Y
doubleY _
>_ `
(` a
$stra w
,w x
$str	y 
)
 
;
 
private 
static 
readonly 
Random  &
_random' .
=/ 0
new1 4
(4 5
)5 6
;6 7
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
string  
>  !
TestMetrics" -
(- .
). /
{ 	
_requestCounter 
. 
Add 
(  
$num  !
)! "
;" #
using 
var 
activity 
=  
new! $
Activity% -
(- .
$str. @
)@ A
;A B
activity 
. 
Start 
( 
) 
; 
try 
{ 
await 
Task 
. 
Delay  
(  !
_random! (
.( )
Next) -
(- .
$num. 0
,0 1
$num2 5
)5 6
)6 7
;7 8
return 
$str /
;/ 0
} 
finally 
{ 
activity   
.   
Stop   
(   
)   
;    
_responseTime!! 
.!! 
Record!! $
(!!$ %
activity!!% -
.!!- .
Duration!!. 6
.!!6 7
TotalMilliseconds!!7 H
)!!H I
;!!I J
}"" 
}## 	
[%% 	
HttpGet%%	 
(%% 
$str%% 
)%% 
]%% 
public&& 
string&& 
IncrementCounter&& &
(&&& '
[&&' (
	FromQuery&&( 1
]&&1 2
int&&3 6
value&&7 <
=&&= >
$num&&? @
)&&@ A
{'' 	
_requestCounter(( 
.(( 
Add(( 
(((  
value((  %
)((% &
;((& '
return)) 
$")) 
$str)) ,
{)), -
value))- 2
}))2 3
"))3 4
;))4 5
}** 	
[,, 	
HttpGet,,	 
(,, 
$str,, 
),, 
],, 
public-- 
async-- 
Task-- 
<-- 
string--  
>--  !
SlowEndpoint--" .
(--. /
)--/ 0
{.. 	
_requestCounter// 
.// 
Add// 
(//  
$num//  !
)//! "
;//" #
using11 
var11 
activity11 
=11  
new11! $
Activity11% -
(11- .
$str11. >
)11> ?
;11? @
activity22 
.22 
Start22 
(22 
)22 
;22 
try44 
{55 
await77 
Task77 
.77 
Delay77  
(77  !
_random77! (
.77( )
Next77) -
(77- .
$num77. 1
,771 2
$num773 7
)777 8
)778 9
;779 :
return88 
$str88 1
;881 2
}99 
finally:: 
{;; 
activity<< 
.<< 
Stop<< 
(<< 
)<< 
;<<  
_responseTime== 
.== 
Record== $
(==$ %
activity==% -
.==- .
Duration==. 6
.==6 7
TotalMilliseconds==7 H
)==H I
;==I J
}>> 
}?? 	
}@@ 
}AA ¯²
d/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Controllers/EnhancedAuthTestController.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Controllers *
;* +
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
[ 
Tags 
( 
$str #
)# $
]$ %
public 
class &
EnhancedAuthTestController '
:( )
ControllerBase* 8
{ 
private 
readonly 
ILogger 
< &
EnhancedAuthTestController 7
>7 8
_logger9 @
;@ A
public 
&
EnhancedAuthTestController %
(% &
ILogger& -
<- .&
EnhancedAuthTestController. H
>H I
loggerJ P
)P Q
{ 
_logger 
= 
logger 
; 
} 
[ 
HttpGet 
( 
$str 
) 
] 
[ 
AllowAnonymous 
] 
[  
ProducesResponseType 
( 
typeof  
(  !
object! '
)' (
,( )
$num* -
)- .
]. /
public 

IActionResult 
PublicEndpoint '
(' (
)( )
{ 
var 
response 
= 
new 
{   	
message!! 
=!! 
$str!! ;
,!!; <
level"" 
="" 
$num"" 
,"" 
	timestamp## 
=## 
DateTimeOffset## &
.##& '
UtcNow##' -
.##- ."
ToUnixTimeMilliseconds##. D
(##D E
)##E F
}$$ 	
;$$	 

return%% 
Ok%% 
(%% 
response%% 
)%% 
;%% 
}&& 
[++ 
HttpGet++ 
(++ 
$str++ 
)++ 
]++ 
[,, 
	Authorize,, 
],, 
[--  
ProducesResponseType-- 
(-- 
typeof--  
(--  !
object--! '
)--' (
,--( )
$num--* -
)--- .
]--. /
[..  
ProducesResponseType.. 
(.. 
$num.. 
).. 
].. 
public// 

IActionResult// !
AuthenticatedEndpoint// .
(//. /
)/// 0
{00 
var11 
username11 
=11 
User11 
.11 
Identity11 $
?11$ %
.11% &
Name11& *
??11+ -
$str11. 7
;117 8
var22 
response22 
=22 
new22 
{33 	
message44 
=44 
$str44 C
,44C D
level55 
=55 
$num55 
,55 
username66 
,66 
	timestamp77 
=77 
DateTimeOffset77 &
.77& '
UtcNow77' -
.77- ."
ToUnixTimeMilliseconds77. D
(77D E
)77E F
}88 	
;88	 

return99 
Ok99 
(99 
response99 
)99 
;99 
}:: 
[?? 
HttpGet?? 
(?? 
$str?? 
)?? 
]?? 
[@@ 
	Authorize@@ 
(@@ 
Roles@@ 
=@@ 
$str@@ 
)@@ 
]@@ 
[AA  
ProducesResponseTypeAA 
(AA 
typeofAA  
(AA  !
objectAA! '
)AA' (
,AA( )
$numAA* -
)AA- .
]AA. /
[BB  
ProducesResponseTypeBB 
(BB 
$numBB 
)BB 
]BB 
[CC  
ProducesResponseTypeCC 
(CC 
$numCC 
)CC 
]CC 
publicDD 

IActionResultDD 
RoleBasedEndpointDD *
(DD* +
)DD+ ,
{EE 
varFF 
usernameFF 
=FF 
UserFF 
.FF 
IdentityFF $
?FF$ %
.FF% &
NameFF& *
??FF+ -
$strFF. 7
;FF7 8
varGG 
rolesGG 
=GG 
UserGG 
.GG 
ClaimsGG 
.HH 
WhereHH 
(HH 
cHH 
=>HH 
cHH 
.HH 
TypeHH 
==HH !

ClaimTypesHH" ,
.HH, -
RoleHH- 1
)HH1 2
.II 
SelectII 
(II 
cII 
=>II 
cII 
.II 
ValueII  
)II  !
.JJ 
ToListJJ 
(JJ 
)JJ 
;JJ 
varLL 
responseLL 
=LL 
newLL 
{MM 	
messageNN 
=NN 
$strNN ?
,NN? @
levelOO 
=OO 
$numOO 
,OO 
usernamePP 
,PP 
rolesQQ 
,QQ 
	timestampRR 
=RR 
DateTimeOffsetRR &
.RR& '
UtcNowRR' -
.RR- ."
ToUnixTimeMillisecondsRR. D
(RRD E
)RRE F
}SS 	
;SS	 

returnTT 
OkTT 
(TT 
responseTT 
)TT 
;TT 
}UU 
[ZZ 
HttpGetZZ 
(ZZ 
$strZZ 
)ZZ 
]ZZ 
[[[ 
	Authorize[[ 
([[ 
Roles[[ 
=[[ 
$str[[ 
)[[ 
][[  
[\\  
ProducesResponseType\\ 
(\\ 
typeof\\  
(\\  !
object\\! '
)\\' (
,\\( )
$num\\* -
)\\- .
]\\. /
[]]  
ProducesResponseType]] 
(]] 
$num]] 
)]] 
]]] 
[^^  
ProducesResponseType^^ 
(^^ 
$num^^ 
)^^ 
]^^ 
public__ 

IActionResult__ 
AdminOnlyEndpoint__ *
(__* +
)__+ ,
{`` 
varaa 
usernameaa 
=aa 
Useraa 
.aa 
Identityaa $
?aa$ %
.aa% &
Nameaa& *
??aa+ -
$straa. 7
;aa7 8
varbb 
responsebb 
=bb 
newbb 
{cc 	
messagedd 
=dd 
$strdd @
,dd@ A
levelee 
=ee 
$numee 
,ee 
usernameff 
,ff 
	timestampgg 
=gg 
DateTimeOffsetgg &
.gg& '
UtcNowgg' -
.gg- ."
ToUnixTimeMillisecondsgg. D
(ggD E
)ggE F
}hh 	
;hh	 

returnii 
Okii 
(ii 
responseii 
)ii 
;ii 
}jj 
[oo 
HttpGetoo 
(oo 
$stroo 
)oo  
]oo  !
[pp 
	Authorizepp 
(pp 
Policypp 
=pp 
$strpp 4
)pp4 5
]pp5 6
[qq  
ProducesResponseTypeqq 
(qq 
typeofqq  
(qq  !
objectqq! '
)qq' (
,qq( )
$numqq* -
)qq- .
]qq. /
[rr  
ProducesResponseTyperr 
(rr 
$numrr 
)rr 
]rr 
[ss  
ProducesResponseTypess 
(ss 
$numss 
)ss 
]ss 
publictt 

IActionResulttt #
PermissionBasedEndpointtt 0
(tt0 1
)tt1 2
{uu 
varvv 
usernamevv 
=vv 
Uservv 
.vv 
Identityvv $
?vv$ %
.vv% &
Namevv& *
??vv+ -
$strvv. 7
;vv7 8
varww 
permissionsww 
=ww 
Userww 
.ww 
Claimsww %
.xx 
Wherexx 
(xx 
cxx 
=>xx 
cxx 
.xx 
Typexx 
==xx !
$strxx" .
)xx. /
.yy 
Selectyy 
(yy 
cyy 
=>yy 
cyy 
.yy 
Valueyy  
)yy  !
.zz 
ToListzz 
(zz 
)zz 
;zz 
var|| 
response|| 
=|| 
new|| 
{}} 	
message~~ 
=~~ 
$str~~ E
,~~E F
level 
= 
$num 
, 
username
 
,
 
permissions
 
,
 
	timestamp
 
=
 
DateTimeOffset
 &
.
& '
UtcNow
' -
.
- .$
ToUnixTimeMilliseconds
. D
(
D E
)
E F
}
 	
;
	 

return
 
Ok
 
(
 
response
 
)
 
;
 
}
 
[
 
HttpGet
 
(
 
$str
 
)
 
]
 
[
 
	Authorize
 
(
 
Policy
 
=
 
$str
 -
)
- .
]
. /
[
 "
ProducesResponseType
 
(
 
typeof
  
(
  !
object
! '
)
' (
,
( )
$num
* -
)
- .
]
. /
[
 "
ProducesResponseType
 
(
 
$num
 
)
 
]
 
[
 "
ProducesResponseType
 
(
 
$num
 
)
 
]
 
public
 

IActionResult
 "
Aal2RequiredEndpoint
 -
(
- .
)
. /
{
 
var
 
username
 
=
 
User
 
.
 
Identity
 $
?
$ %
.
% &
Name
& *
??
+ -
$str
. 7
;
7 8
var
 

authLevels
 
=
 
User
 
.
 
Claims
 $
.
 
Where
 
(
 
c
 
=>
 
c
 
.
 
Type
 
==
 !
$str
" .
)
. /
.
 
Select
 
(
 
c
 
=>
 
c
 
.
 
Value
  
)
  !
.
 
ToList
 
(
 
)
 
;
 
var
 
response
 
=
 
new
 
{
 	
message
 
=
 
$str
 ;
,
; <
level
 
=
 
$num
 
,
 
username
 
,
 

authLevels
 
,
 
	timestamp
 
=
 
DateTimeOffset
 &
.
& '
UtcNow
' -
.
- .$
ToUnixTimeMilliseconds
. D
(
D E
)
E F
}
 	
;
	 

return
 
Ok
 
(
 
response
 
)
 
;
 
}
   
[
¥¥ 
HttpGet
¥¥ 
(
¥¥ 
$str
¥¥ 
)
¥¥ 
]
¥¥  
[
¦¦ 
	Authorize
¦¦ 
(
¦¦ 
Policy
¦¦ 
=
¦¦ 
$str
¦¦ .
)
¦¦. /
]
¦¦/ 0
[
§§ "
ProducesResponseType
§§ 
(
§§ 
typeof
§§  
(
§§  !
object
§§! '
)
§§' (
,
§§( )
$num
§§* -
)
§§- .
]
§§. /
[
¨¨ "
ProducesResponseType
¨¨ 
(
¨¨ 
$num
¨¨ 
)
¨¨ 
]
¨¨ 
[
©© "
ProducesResponseType
©© 
(
©© 
$num
©© 
)
©© 
]
©© 
public
ªª 

IActionResult
ªª $
EnterpriseOnlyEndpoint
ªª /
(
ªª/ 0
)
ªª0 1
{
«« 
var
¬¬ 
username
¬¬ 
=
¬¬ 
User
¬¬ 
.
¬¬ 
Identity
¬¬ $
?
¬¬$ %
.
¬¬% &
Name
¬¬& *
??
¬¬+ -
$str
¬¬. 7
;
¬¬7 8
var
­­ 
idps
­­ 
=
­­ 
User
­­ 
.
­­ 
Claims
­­ 
.
®® 
Where
®® 
(
®® 
c
®® 
=>
®® 
c
®® 
.
®® 
Type
®® 
==
®® !
$str
®®" '
)
®®' (
.
¯¯ 
Select
¯¯ 
(
¯¯ 
c
¯¯ 
=>
¯¯ 
c
¯¯ 
.
¯¯ 
Value
¯¯  
)
¯¯  !
.
°° 
ToList
°° 
(
°° 
)
°° 
;
°° 
var
²² 
response
²² 
=
²² 
new
²² 
{
³³ 	
message
´´ 
=
´´ 
$str
´´ E
,
´´E F
level
µµ 
=
µµ 
$num
µµ 
,
µµ 
username
¶¶ 
,
¶¶ 
identityProviders
·· 
=
·· 
idps
··  $
,
··$ %
	timestamp
¸¸ 
=
¸¸ 
DateTimeOffset
¸¸ &
.
¸¸& '
UtcNow
¸¸' -
.
¸¸- .$
ToUnixTimeMilliseconds
¸¸. D
(
¸¸D E
)
¸¸E F
}
¹¹ 	
;
¹¹	 

return
ºº 
Ok
ºº 
(
ºº 
response
ºº 
)
ºº 
;
ºº 
}
»» 
[
ÀÀ 
HttpGet
ÀÀ 
(
ÀÀ 
$str
ÀÀ 
)
ÀÀ 
]
ÀÀ 
[
ÁÁ 
	Authorize
ÁÁ 
(
ÁÁ 
Policy
ÁÁ 
=
ÁÁ 
$str
ÁÁ 0
)
ÁÁ0 1
]
ÁÁ1 2
[
ÂÂ "
ProducesResponseType
ÂÂ 
(
ÂÂ 
typeof
ÂÂ  
(
ÂÂ  !
object
ÂÂ! '
)
ÂÂ' (
,
ÂÂ( )
$num
ÂÂ* -
)
ÂÂ- .
]
ÂÂ. /
[
ÃÃ "
ProducesResponseType
ÃÃ 
(
ÃÃ 
$num
ÃÃ 
)
ÃÃ 
]
ÃÃ 
[
ÄÄ "
ProducesResponseType
ÄÄ 
(
ÄÄ 
$num
ÄÄ 
)
ÄÄ 
]
ÄÄ 
public
ÅÅ 

IActionResult
ÅÅ !
MultiFactorEndpoint
ÅÅ ,
(
ÅÅ, -
)
ÅÅ- .
{
ÆÆ 
var
ÇÇ 
username
ÇÇ 
=
ÇÇ 
User
ÇÇ 
.
ÇÇ 
Identity
ÇÇ $
?
ÇÇ$ %
.
ÇÇ% &
Name
ÇÇ& *
??
ÇÇ+ -
$str
ÇÇ. 7
;
ÇÇ7 8
var
ÈÈ 
roles
ÈÈ 
=
ÈÈ 
User
ÈÈ 
.
ÈÈ 
Claims
ÈÈ 
.
ÉÉ 
Where
ÉÉ 
(
ÉÉ 
c
ÉÉ 
=>
ÉÉ 
c
ÉÉ 
.
ÉÉ 
Type
ÉÉ 
==
ÉÉ !

ClaimTypes
ÉÉ" ,
.
ÉÉ, -
Role
ÉÉ- 1
)
ÉÉ1 2
.
ÊÊ 
Select
ÊÊ 
(
ÊÊ 
c
ÊÊ 
=>
ÊÊ 
c
ÊÊ 
.
ÊÊ 
Value
ÊÊ  
)
ÊÊ  !
.
ËË 
ToList
ËË 
(
ËË 
)
ËË 
;
ËË 
var
ÍÍ 
permissions
ÍÍ 
=
ÍÍ 
User
ÍÍ 
.
ÍÍ 
Claims
ÍÍ %
.
ÎÎ 
Where
ÎÎ 
(
ÎÎ 
c
ÎÎ 
=>
ÎÎ 
c
ÎÎ 
.
ÎÎ 
Type
ÎÎ 
==
ÎÎ !
$str
ÎÎ" .
)
ÎÎ. /
.
ÏÏ 
Select
ÏÏ 
(
ÏÏ 
c
ÏÏ 
=>
ÏÏ 
c
ÏÏ 
.
ÏÏ 
Value
ÏÏ  
)
ÏÏ  !
.
ÐÐ 
ToList
ÐÐ 
(
ÐÐ 
)
ÐÐ 
;
ÐÐ 
var
ÒÒ 

authLevels
ÒÒ 
=
ÒÒ 
User
ÒÒ 
.
ÒÒ 
Claims
ÒÒ $
.
ÓÓ 
Where
ÓÓ 
(
ÓÓ 
c
ÓÓ 
=>
ÓÓ 
c
ÓÓ 
.
ÓÓ 
Type
ÓÓ 
==
ÓÓ !
$str
ÓÓ" .
)
ÓÓ. /
.
ÔÔ 
Select
ÔÔ 
(
ÔÔ 
c
ÔÔ 
=>
ÔÔ 
c
ÔÔ 
.
ÔÔ 
Value
ÔÔ  
)
ÔÔ  !
.
ÕÕ 
ToList
ÕÕ 
(
ÕÕ 
)
ÕÕ 
;
ÕÕ 
var
×× 
idps
×× 
=
×× 
User
×× 
.
×× 
Claims
×× 
.
ØØ 
Where
ØØ 
(
ØØ 
c
ØØ 
=>
ØØ 
c
ØØ 
.
ØØ 
Type
ØØ 
==
ØØ !
$str
ØØ" '
)
ØØ' (
.
ÙÙ 
Select
ÙÙ 
(
ÙÙ 
c
ÙÙ 
=>
ÙÙ 
c
ÙÙ 
.
ÙÙ 
Value
ÙÙ  
)
ÙÙ  !
.
ÚÚ 
ToList
ÚÚ 
(
ÚÚ 
)
ÚÚ 
;
ÚÚ 
var
ÜÜ 
response
ÜÜ 
=
ÜÜ 
new
ÜÜ 
{
ÝÝ 	
message
ÞÞ 
=
ÞÞ 
$str
ÞÞ A
,
ÞÞA B
level
ßß 
=
ßß 
$num
ßß 
,
ßß 
username
àà 
,
àà 
roles
áá 
,
áá 
permissions
ââ 
,
ââ 

authLevels
ãã 
,
ãã 
identityProviders
ää 
=
ää 
idps
ää  $
,
ää$ %
	timestamp
åå 
=
åå 
DateTimeOffset
åå &
.
åå& '
UtcNow
åå' -
.
åå- .$
ToUnixTimeMilliseconds
åå. D
(
ååD E
)
ååE F
}
ææ 	
;
ææ	 

return
çç 
Ok
çç 
(
çç 
response
çç 
)
çç 
;
çç 
}
èè 
[
íí 
HttpGet
íí 
(
íí 
$str
íí 
)
íí 
]
íí 
[
îî 
	Authorize
îî 
]
îî 
[
ïï "
ProducesResponseType
ïï 
(
ïï 
typeof
ïï  
(
ïï  !
object
ïï! '
)
ïï' (
,
ïï( )
$num
ïï* -
)
ïï- .
]
ïï. /
[
ðð "
ProducesResponseType
ðð 
(
ðð 
$num
ðð 
)
ðð 
]
ðð 
public
ññ 

IActionResult
ññ %
GetAuthorizationContext
ññ 0
(
ññ0 1
)
ññ1 2
{
òò 
var
óó 
username
óó 
=
óó 
User
óó 
.
óó 
Identity
óó $
?
óó$ %
.
óó% &
Name
óó& *
??
óó+ -
$str
óó. 7
;
óó7 8
var
ôô 
roles
ôô 
=
ôô 
User
ôô 
.
ôô 
Claims
ôô 
.
õõ 
Where
õõ 
(
õõ 
c
õõ 
=>
õõ 
c
õõ 
.
õõ 
Type
õõ 
==
õõ !

ClaimTypes
õõ" ,
.
õõ, -
Role
õõ- 1
)
õõ1 2
.
öö 
Select
öö 
(
öö 
c
öö 
=>
öö 
c
öö 
.
öö 
Value
öö  
)
öö  !
.
÷÷ 
ToList
÷÷ 
(
÷÷ 
)
÷÷ 
;
÷÷ 
var
ùù 
permissions
ùù 
=
ùù 
User
ùù 
.
ùù 
Claims
ùù %
.
úú 
Where
úú 
(
úú 
c
úú 
=>
úú 
c
úú 
.
úú 
Type
úú 
==
úú !
$str
úú" .
)
úú. /
.
ûû 
Select
ûû 
(
ûû 
c
ûû 
=>
ûû 
c
ûû 
.
ûû 
Value
ûû  
)
ûû  !
.
üü 
ToList
üü 
(
üü 
)
üü 
;
üü 
var
þþ 

authLevels
þþ 
=
þþ 
User
þþ 
.
þþ 
Claims
þþ $
.
ÿÿ 
Where
ÿÿ 
(
ÿÿ 
c
ÿÿ 
=>
ÿÿ 
c
ÿÿ 
.
ÿÿ 
Type
ÿÿ 
==
ÿÿ !
$str
ÿÿ" .
)
ÿÿ. /
.
 
Select
 
(
 
c
 
=>
 
c
 
.
 
Value
  
)
  !
.
 
ToList
 
(
 
)
 
;
 
var
 
idps
 
=
 
User
 
.
 
Claims
 
.
 
Where
 
(
 
c
 
=>
 
c
 
.
 
Type
 
==
 !
$str
" '
)
' (
.
 
Select
 
(
 
c
 
=>
 
c
 
.
 
Value
  
)
  !
.
 
ToList
 
(
 
)
 
;
 
var
 
	allClaims
 
=
 
User
 
.
 
Claims
 #
.
 
ToDictionary
 
(
 
c
 
=>
 
c
  
.
  !
Type
! %
,
% &
c
' (
=>
) +
c
, -
.
- .
Value
. 3
)
3 4
;
4 5
var
 
response
 
=
 
new
 
{
 	
username
 
,
 
roles
 
,
 
permissions
 
,
 

authLevels
 
,
 
identityProviders
 
=
 
idps
  $
,
$ %
	allClaims
 
,
 
	timestamp
 
=
 
DateTimeOffset
 &
.
& '
UtcNow
' -
.
- .$
ToUnixTimeMilliseconds
. D
(
D E
)
E F
}
 	
;
	 

return
 
Ok
 
(
 
response
 
)
 
;
 
}
 
} ,
_/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Controllers/ApplicationController.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Controllers *
;* +
[ 
ApiController 
] 
[ 
Route 
( 
$str 	
)	 

]
 
[		 
Tags		 
(		 
$str		 
)		 
]		 
public

 
class

 !
ApplicationController

 "
:

# $
ControllerBase

% 3
{ 
private 
readonly 
ILogger 
< !
ApplicationController 2
>2 3
_logger4 ;
;; <
public 
!
ApplicationController  
(  !
ILogger! (
<( )!
ApplicationController) >
>> ?
logger@ F
)F G
{ 
_logger 
= 
logger 
; 
} 
[ 
HttpGet 
] 
public 

IActionResult 
Home 
( 
) 
{ 
var 
	jwsHeader 
= 
Convert 
.  
ToBase64String  .
(. /
Encoding/ 7
.7 8
UTF88 <
.< =
GetBytes= E
(E F
$strF ]
)] ^
)^ _
;_ `
_logger 
. 
LogInformation 
( 
$str B
,B C
	jwsHeaderD M
)M N
;N O
foreach 
( 
var 
header 
in 
Request &
.& '
Headers' .
). /
{ 	
_logger   
.   
LogInformation   "
(  " #
$str  # =
,  = >
header  ? E
.  E F
Key  F I
,  I J
header  K Q
.  Q R
Value  R W
)  W X
;  X Y
}!! 	
return## 
Ok## 
(## 
$str## ,
)##, -
;##- .
}$$ 
[)) 
HttpGet)) 
()) 
$str)) -
)))- .
])). /
[** 
	Authorize** 
(** 
Policy** 
=** 
$str** ;
)**; <
]**< =
[++  
ProducesResponseType++ 
(++ 
typeof++  
(++  !
string++! '
)++' (
,++( )
$num++* -
)++- .
]++. /
[,,  
ProducesResponseType,, 
(,, 
$num,, 
),, 
],, 
[--  
ProducesResponseType-- 
(-- 
$num-- 
)-- 
]-- 
public.. 

IActionResult.. 
	GetObject.. "
(.." #
[..# $
	FromQuery..$ -
]..- .
string../ 5
id..6 8
)..8 9
{// 
_logger00 
.00 
LogInformation00 
(00 
$str00 1
,001 2
id003 5
)005 6
;006 7
return11 
Ok11 
(11 
$str11 
)11 
;11 
}22 
[77 
HttpPut77 
(77 
$str77 -
)77- .
]77. /
[88 
	Authorize88 
(88 
Policy88 
=88 
$str88 <
)88< =
]88= >
[99  
ProducesResponseType99 
(99 
typeof99  
(99  !
string99! '
)99' (
,99( )
$num99* -
)99- .
]99. /
[::  
ProducesResponseType:: 
(:: 
$num:: 
):: 
]:: 
[;;  
ProducesResponseType;; 
(;; 
$num;; 
);; 
];; 
public<< 

IActionResult<< 
	PutObject<< "
(<<" #
[<<# $
	FromQuery<<$ -
]<<- .
string<</ 5
id<<6 8
)<<8 9
{== 
_logger>> 
.>> 
LogInformation>> 
(>> 
$str>> 1
,>>1 2
id>>3 5
)>>5 6
;>>6 7
return?? 
Ok?? 
(?? 
$str?? 
)?? 
;?? 
}@@ 
[EE 

HttpDeleteEE 
(EE 
$strEE 3
)EE3 4
]EE4 5
[FF 
	AuthorizeFF 
(FF 
PolicyFF 
=FF 
$strFF =
)FF= >
]FF> ?
[GG  
ProducesResponseTypeGG 
(GG 
typeofGG  
(GG  !
stringGG! '
)GG' (
,GG( )
$numGG* -
)GG- .
]GG. /
[HH  
ProducesResponseTypeHH 
(HH 
$numHH 
)HH 
]HH 
[II  
ProducesResponseTypeII 
(II 
$numII 
)II 
]II 
publicJJ 

IActionResultJJ 
DeleteObjectJJ %
(JJ% &
[JJ& '
	FromQueryJJ' 0
]JJ0 1
stringJJ2 8
idJJ9 ;
)JJ; <
{KK 
_loggerLL 
.LL 
LogInformationLL 
(LL 
$strLL 4
,LL4 5
idLL6 8
)LL8 9
;LL9 :
returnMM 
OkMM 
(MM 
$strMM 
)MM 
;MM 
}NN 
}OO ®
a/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Authorization/PermissionRequirement.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Authorization ,
;, -
public 
class !
PermissionRequirement "
:# $%
IAuthorizationRequirement% >
{		 
public

 

string

 

Permission

 
{

 
get

 "
;

" #
}

$ %
public 
!
PermissionRequirement  
(  !
string! '

permission( 2
)2 3
{ 

Permission 
= 

permission 
;  
} 
} 
public 
class $
AnyPermissionRequirement %
:& '%
IAuthorizationRequirement( A
{ 
public 

string 
[ 
] 
Permissions 
{  !
get" %
;% &
}' (
public 
$
AnyPermissionRequirement #
(# $
params$ *
string+ 1
[1 2
]2 3
permissions4 ?
)? @
{ 
Permissions 
= 
permissions !
;! "
} 
} 
public"" 
class"" %
AllPermissionsRequirement"" &
:""' (%
IAuthorizationRequirement"") B
{## 
public$$ 

string$$ 
[$$ 
]$$ 
Permissions$$ 
{$$  !
get$$" %
;$$% &
}$$' (
public&& 
%
AllPermissionsRequirement&& $
(&&$ %
params&&% +
string&&, 2
[&&2 3
]&&3 4
permissions&&5 @
)&&@ A
{'' 
Permissions(( 
=(( 
permissions(( !
;((! "
})) 
}** 
public// 
class//  
AuthLevelRequirement// !
://" #%
IAuthorizationRequirement//$ =
{00 
public11 

string11 
MinAuthLevel11 
{11  
get11! $
;11$ %
}11& '
public33 
 
AuthLevelRequirement33 
(33  
string33  &
minAuthLevel33' 3
)333 4
{44 
MinAuthLevel55 
=55 
minAuthLevel55 #
;55# $
}66 
}77 
public<< 
class<< '
IdentityProviderRequirement<< (
:<<) *%
IAuthorizationRequirement<<+ D
{== 
public>> 

string>> 
RequiredIdp>> 
{>> 
get>>  #
;>># $
}>>% &
public@@ 
'
IdentityProviderRequirement@@ &
(@@& '
string@@' -
requiredIdp@@. 9
)@@9 :
{AA 
RequiredIdpBB 
=BB 
requiredIdpBB !
;BB! "
}CC 
}DD 7
]/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Authorization/PermissionHandler.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Authorization ,
;, -
public		 
class		 
PermissionHandler		 
:		   
AuthorizationHandler		! 5
<		5 6!
PermissionRequirement		6 K
>		K L
{

 
	protected 
override 
Task "
HandleRequirementAsync 2
(2 3'
AuthorizationHandlerContext3 N
contextO V
,V W!
PermissionRequirementX m
requirementn y
)y z
{ 
var 
hasPermission 
= 
context #
.# $
User$ (
.( )
HasClaim) 1
(1 2
$str2 >
,> ?
requirement@ K
.K L

PermissionL V
)V W
;W X
if 

( 
hasPermission 
) 
{ 	
context 
. 
Succeed 
( 
requirement '
)' (
;( )
} 	
return 
Task 
. 
CompletedTask !
;! "
} 
} 
public 
class  
AnyPermissionHandler !
:" # 
AuthorizationHandler$ 8
<8 9$
AnyPermissionRequirement9 Q
>Q R
{ 
	protected 
override 
Task "
HandleRequirementAsync 2
(2 3'
AuthorizationHandlerContext3 N
contextO V
,V W$
AnyPermissionRequirementX p
requirementq |
)| }
{ 
var 
hasAnyPermission 
= 
requirement *
.* +
Permissions+ 6
.6 7
Any7 :
(: ;

permission; E
=>F H
context   
.   
User   
.   
HasClaim   !
(  ! "
$str  " .
,  . /

permission  0 :
)  : ;
)  ; <
;  < =
if"" 

("" 
hasAnyPermission"" 
)"" 
{## 	
context$$ 
.$$ 
Succeed$$ 
($$ 
requirement$$ '
)$$' (
;$$( )
}%% 	
return'' 
Task'' 
.'' 
CompletedTask'' !
;''! "
}(( 
})) 
public.. 
class.. !
AllPermissionsHandler.. "
:..# $ 
AuthorizationHandler..% 9
<..9 :%
AllPermissionsRequirement..: S
>..S T
{// 
	protected00 
override00 
Task00 "
HandleRequirementAsync00 2
(002 3'
AuthorizationHandlerContext003 N
context00O V
,00V W%
AllPermissionsRequirement00X q
requirement00r }
)00} ~
{11 
var22 
hasAllPermissions22 
=22 
requirement22  +
.22+ ,
Permissions22, 7
.227 8
All228 ;
(22; <

permission22< F
=>22G I
context33 
.33 
User33 
.33 
HasClaim33 !
(33! "
$str33" .
,33. /

permission330 :
)33: ;
)33; <
;33< =
if55 

(55 
hasAllPermissions55 
)55 
{66 	
context77 
.77 
Succeed77 
(77 
requirement77 '
)77' (
;77( )
}88 	
return:: 
Task:: 
.:: 
CompletedTask:: !
;::! "
};; 
}<< 
publicAA 
classAA 
AuthLevelHandlerAA 
:AA  
AuthorizationHandlerAA  4
<AA4 5 
AuthLevelRequirementAA5 I
>AAI J
{BB 
	protectedCC 
overrideCC 
TaskCC "
HandleRequirementAsyncCC 2
(CC2 3'
AuthorizationHandlerContextCC3 N
contextCCO V
,CCV W 
AuthLevelRequirementCCX l
requirementCCm x
)CCx y
{DD 
varEE 
authLevelClaimEE 
=EE 
contextEE $
.EE$ %
UserEE% )
.EE) *
	FindFirstEE* 3
(EE3 4
$strEE4 @
)EE@ A
?EEA B
.EEB C
ValueEEC H
;EEH I
ifGG 

(GG 
authLevelClaimGG 
!=GG 
nullGG "
)GG" #
{HH 	
varII 

authLevelsII 
=II 
newII  
[II  !
]II! "
{II# $
$strII% +
,II+ ,
$strII- 3
,II3 4
$strII5 ;
}II< =
;II= >
varJJ 
currentLevelIndexJJ !
=JJ" #
ArrayJJ$ )
.JJ) *
IndexOfJJ* 1
(JJ1 2

authLevelsJJ2 <
,JJ< =
authLevelClaimJJ> L
)JJL M
;JJM N
varKK 
requiredLevelIndexKK "
=KK# $
ArrayKK% *
.KK* +
IndexOfKK+ 2
(KK2 3

authLevelsKK3 =
,KK= >
requirementKK? J
.KKJ K
MinAuthLevelKKK W
)KKW X
;KKX Y
ifMM 
(MM 
currentLevelIndexMM !
>=MM" $
requiredLevelIndexMM% 7
)MM7 8
{NN 
contextOO 
.OO 
SucceedOO 
(OO  
requirementOO  +
)OO+ ,
;OO, -
}PP 
}QQ 	
returnSS 
TaskSS 
.SS 
CompletedTaskSS !
;SS! "
}TT 
}UU 
publicZZ 
classZZ #
IdentityProviderHandlerZZ $
:ZZ% & 
AuthorizationHandlerZZ' ;
<ZZ; <'
IdentityProviderRequirementZZ< W
>ZZW X
{[[ 
	protected\\ 
override\\ 
Task\\ "
HandleRequirementAsync\\ 2
(\\2 3'
AuthorizationHandlerContext\\3 N
context\\O V
,\\V W'
IdentityProviderRequirement\\X s
requirement\\t 
)	\\ 
{]] 
var^^ 
idpClaim^^ 
=^^ 
context^^ 
.^^ 
User^^ #
.^^# $
	FindFirst^^$ -
(^^- .
$str^^. 3
)^^3 4
?^^4 5
.^^5 6
Value^^6 ;
;^^; <
if`` 

(`` 
idpClaim`` 
==`` 
requirement`` #
.``# $
RequiredIdp``$ /
)``/ 0
{aa 	
contextbb 
.bb 
Succeedbb 
(bb 
requirementbb '
)bb' (
;bb( )
}cc 	
returnee 
Taskee 
.ee 
CompletedTaskee !
;ee! "
}ff 
}gg 