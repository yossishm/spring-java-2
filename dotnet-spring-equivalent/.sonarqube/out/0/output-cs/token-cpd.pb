®:
V/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Services/LocalRestClient.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Services '
;' (
public		 
class		 
LocalRestClient		 
{

 
private 
readonly 

HttpClient 
_httpClient  +
;+ ,
private 
readonly 
string 
_server #
=$ %
$str& =
;= >
public 

LocalRestClient 
( 
string !
authorization" /
=0 1
$str2 4
)4 5
{ 
_httpClient 
= 
new 

HttpClient $
($ %
)% &
;& '
_httpClient 
. !
DefaultRequestHeaders )
.) *
Add* -
(- .
$str. <
,< =
$str> P
)P Q
;Q R
_httpClient 
. !
DefaultRequestHeaders )
.) *
Add* -
(- .
$str. 6
,6 7
$str8 =
)= >
;> ?
var 
	jwsHeader 
= 
Convert 
.  
ToBase64String  .
(. /
Encoding/ 7
.7 8
UTF88 <
.< =
GetBytes= E
(E F
$strF ]
)] ^
)^ _
;_ `
_httpClient 
. !
DefaultRequestHeaders )
.) *
Add* -
(- .
	jwsHeader. 7
,7 8
authorization9 F
)F G
;G H
} 
public 

async 
Task 
< 
string 
> 
GetAsync &
(& '
string' -
uri. 1
)1 2
{ 
try 
{ 	
var   
response   
=   
await    
_httpClient  ! ,
.  , -
GetAsync  - 5
(  5 6
_server  6 =
+  > ?
uri  @ C
)  C D
;  D E
var!! 
content!! 
=!! 
await!! 
response!!  (
.!!( )
Content!!) 0
.!!0 1
ReadAsStringAsync!!1 B
(!!B C
)!!C D
;!!D E
return"" 
content"" 
;"" 
}## 	
catch$$ 
($$ 
	Exception$$ 
ex$$ 
)$$ 
{%% 	
throw&& 
new&&  
HttpRequestException&& *
(&&* +
$"&&+ -
$str&&- A
{&&A B
ex&&B D
.&&D E
Message&&E L
}&&L M
"&&M N
,&&N O
ex&&P R
)&&R S
;&&S T
}'' 	
}(( 
public-- 

async-- 
Task-- 
<-- 
string-- 
>-- 
	PostAsync-- '
(--' (
string--( .
uri--/ 2
,--2 3
string--4 :
json--; ?
)--? @
{.. 
try// 
{00 	
var11 
content11 
=11 
new11 
StringContent11 +
(11+ ,
json11, 0
,110 1
Encoding112 :
.11: ;
UTF811; ?
,11? @
$str11A S
)11S T
;11T U
var22 
response22 
=22 
await22  
_httpClient22! ,
.22, -
	PostAsync22- 6
(226 7
_server227 >
+22? @
uri22A D
,22D E
content22F M
)22M N
;22N O
var33 
responseContent33 
=33  !
await33" '
response33( 0
.330 1
Content331 8
.338 9
ReadAsStringAsync339 J
(33J K
)33K L
;33L M
return44 
responseContent44 "
;44" #
}55 	
catch66 
(66 
	Exception66 
ex66 
)66 
{77 	
throw88 
new88  
HttpRequestException88 *
(88* +
$"88+ -
$str88- B
{88B C
ex88C E
.88E F
Message88F M
}88M N
"88N O
,88O P
ex88Q S
)88S T
;88T U
}99 	
}:: 
public?? 

async?? 
Task?? 
<?? 
string?? 
>?? 
PutAsync?? &
(??& '
string??' -
uri??. 1
,??1 2
string??3 9
json??: >
)??> ?
{@@ 
tryAA 
{BB 	
varCC 
contentCC 
=CC 
newCC 
StringContentCC +
(CC+ ,
jsonCC, 0
,CC0 1
EncodingCC2 :
.CC: ;
UTF8CC; ?
,CC? @
$strCCA S
)CCS T
;CCT U
varDD 
responseDD 
=DD 
awaitDD  
_httpClientDD! ,
.DD, -
PutAsyncDD- 5
(DD5 6
_serverDD6 =
+DD> ?
uriDD@ C
,DDC D
contentDDE L
)DDL M
;DDM N
varEE 
responseContentEE 
=EE  !
awaitEE" '
responseEE( 0
.EE0 1
ContentEE1 8
.EE8 9
ReadAsStringAsyncEE9 J
(EEJ K
)EEK L
;EEL M
returnFF 
responseContentFF "
;FF" #
}GG 	
catchHH 
(HH 
	ExceptionHH 
exHH 
)HH 
{II 	
throwJJ 
newJJ  
HttpRequestExceptionJJ *
(JJ* +
$"JJ+ -
$strJJ- A
{JJA B
exJJB D
.JJD E
MessageJJE L
}JJL M
"JJM N
,JJN O
exJJP R
)JJR S
;JJS T
}KK 	
}LL 
publicQQ 

asyncQQ 
TaskQQ 
<QQ 
stringQQ 
>QQ 
DeleteAsyncQQ )
(QQ) *
stringQQ* 0
uriQQ1 4
)QQ4 5
{RR 
trySS 
{TT 	
varUU 
responseUU 
=UU 
awaitUU  
_httpClientUU! ,
.UU, -
DeleteAsyncUU- 8
(UU8 9
_serverUU9 @
+UUA B
uriUUC F
)UUF G
;UUG H
varVV 
contentVV 
=VV 
awaitVV 
responseVV  (
.VV( )
ContentVV) 0
.VV0 1
ReadAsStringAsyncVV1 B
(VVB C
)VVC D
;VVD E
returnWW 
contentWW 
;WW 
}XX 	
catchYY 
(YY 
	ExceptionYY 
exYY 
)YY 
{ZZ 	
throw[[ 
new[[  
HttpRequestException[[ *
([[* +
$"[[+ -
$str[[- D
{[[D E
ex[[E G
.[[G H
Message[[H O
}[[O P
"[[P Q
,[[Q R
ex[[S U
)[[U V
;[[V W
}\\ 	
}]] 
public__ 

void__ 
Dispose__ 
(__ 
)__ 
{`` 
_httpClientaa 
?aa 
.aa 
Disposeaa 
(aa 
)aa 
;aa 
}bb 
}cc π{
Q/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Services/JwtService.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Services '
;' (
public 
class 

JwtService 
{ 
private 
readonly 
IConfiguration #
_configuration$ 2
;2 3
private 
readonly 
string 

_secretKey &
;& '
private 
readonly 
int 
_expirationHours )
;) *
public 


JwtService 
( 
IConfiguration $
configuration% 2
)2 3
{ 
_configuration 
= 
configuration &
;& '

_secretKey 
= 
_configuration #
[# $
$str$ 0
]0 1
??2 4
$str5 m
;m n
_expirationHours 
= 
int 
. 
Parse $
($ %
_configuration% 3
[3 4
$str4 I
]I J
??K M
$strN R
)R S
;S T
} 
public 

string 
GenerateToken 
(  
string  &
username' /
,/ 0
List1 5
<5 6
string6 <
>< =
roles> C
,C D
ListE I
<I J
stringJ P
>P Q
permissionsR ]
,] ^
string 
	authLevel 
= 
$str !
,! "
string# )
idp* -
=. /
$str0 7
)7 8
{ 
var   
tokenHandler   
=   
new   #
JwtSecurityTokenHandler   6
(  6 7
)  7 8
;  8 9
var!! 
key!! 
=!! 
Encoding!! 
.!! 
ASCII!!  
.!!  !
GetBytes!!! )
(!!) *

_secretKey!!* 4
)!!4 5
;!!5 6
var## 
claims## 
=## 
new## 
List## 
<## 
Claim## #
>### $
{$$ 	
new%% 
(%% 

ClaimTypes%% 
.%% 
Name%% 
,%%  
username%%! )
)%%) *
,%%* +
new&& 
(&& 

ClaimTypes&& 
.&& 
NameIdentifier&& )
,&&) *
username&&+ 3
)&&3 4
,&&4 5
new'' 
('' 
$str'' 
,'' 
	authLevel'' '
)''' (
,''( )
new(( 
((( 
$str(( 
,(( 
idp(( 
)(( 
})) 	
;))	 

foreach,, 
(,, 
var,, 
role,, 
in,, 
roles,, "
),," #
{-- 	
claims.. 
... 
Add.. 
(.. 
new.. 
Claim..  
(..  !

ClaimTypes..! +
...+ ,
Role.., 0
,..0 1
role..2 6
)..6 7
)..7 8
;..8 9
}// 	
foreach22 
(22 
var22 

permission22 
in22  "
permissions22# .
)22. /
{33 	
claims44 
.44 
Add44 
(44 
new44 
Claim44  
(44  !
$str44! -
,44- .

permission44/ 9
)449 :
)44: ;
;44; <
}55 	
var77 
tokenDescriptor77 
=77 
new77 !#
SecurityTokenDescriptor77" 9
{88 	
Subject99 
=99 
new99 
ClaimsIdentity99 (
(99( )
claims99) /
)99/ 0
,990 1
Expires:: 
=:: 
DateTime:: 
.:: 
UtcNow:: %
.::% &
AddHours::& .
(::. /
_expirationHours::/ ?
)::? @
,::@ A
IssuedAt;; 
=;; 
DateTime;; 
.;;  
UtcNow;;  &
,;;& '
SigningCredentials<< 
=<<  
new<<! $
SigningCredentials<<% 7
(<<7 8
new<<8 ; 
SymmetricSecurityKey<<< P
(<<P Q
key<<Q T
)<<T U
,<<U V
SecurityAlgorithms<<W i
.<<i j
HmacSha256Signature<<j }
)<<} ~
}== 	
;==	 

var?? 
token?? 
=?? 
tokenHandler??  
.??  !
CreateToken??! ,
(??, -
tokenDescriptor??- <
)??< =
;??= >
return@@ 
tokenHandler@@ 
.@@ 

WriteToken@@ &
(@@& '
token@@' ,
)@@, -
;@@- .
}AA 
publicFF 

boolFF 
ValidateTokenFF 
(FF 
stringFF $
tokenFF% *
)FF* +
{GG 
tryHH 
{II 	
varJJ 
tokenHandlerJJ 
=JJ 
newJJ "#
JwtSecurityTokenHandlerJJ# :
(JJ: ;
)JJ; <
;JJ< =
varKK 
keyKK 
=KK 
EncodingKK 
.KK 
ASCIIKK $
.KK$ %
GetBytesKK% -
(KK- .

_secretKeyKK. 8
)KK8 9
;KK9 :
tokenHandlerMM 
.MM 
ValidateTokenMM &
(MM& '
tokenMM' ,
,MM, -
newMM. 1%
TokenValidationParametersMM2 K
{NN $
ValidateIssuerSigningKeyOO (
=OO) *
trueOO+ /
,OO/ 0
IssuerSigningKeyPP  
=PP! "
newPP# & 
SymmetricSecurityKeyPP' ;
(PP; <
keyPP< ?
)PP? @
,PP@ A
ValidateIssuerQQ 
=QQ  
falseQQ! &
,QQ& '
ValidateAudienceRR  
=RR! "
falseRR# (
,RR( )
ValidateLifetimeSS  
=SS! "
trueSS# '
,SS' (
	ClockSkewTT 
=TT 
TimeSpanTT $
.TT$ %
ZeroTT% )
}UU 
,UU 
outUU 
SecurityTokenUU  
validatedTokenUU! /
)UU/ 0
;UU0 1
returnWW 
trueWW 
;WW 
}XX 	
catchYY 
{ZZ 	
return[[ 
false[[ 
;[[ 
}\\ 	
}]] 
publicbb 

stringbb 
?bb 
ExtractUsernamebb "
(bb" #
stringbb# )
tokenbb* /
)bb/ 0
{cc 
trydd 
{ee 	
varff 
tokenHandlerff 
=ff 
newff "#
JwtSecurityTokenHandlerff# :
(ff: ;
)ff; <
;ff< =
vargg 
	jsonTokengg 
=gg 
tokenHandlergg (
.gg( )
ReadJwtTokengg) 5
(gg5 6
tokengg6 ;
)gg; <
;gg< =
returnhh 
	jsonTokenhh 
.hh 
Claimshh #
.hh# $
FirstOrDefaulthh$ 2
(hh2 3
xhh3 4
=>hh5 7
xhh8 9
.hh9 :
Typehh: >
==hh? A

ClaimTypeshhB L
.hhL M
NamehhM Q
)hhQ R
?hhR S
.hhS T
ValuehhT Y
;hhY Z
}ii 	
catchjj 
{kk 	
returnll 
nullll 
;ll 
}mm 	
}nn 
publicss 

Listss 
<ss 
stringss 
>ss 
ExtractRolesss $
(ss$ %
stringss% +
tokenss, 1
)ss1 2
{tt 
tryuu 
{vv 	
varww 
tokenHandlerww 
=ww 
newww "#
JwtSecurityTokenHandlerww# :
(ww: ;
)ww; <
;ww< =
varxx 
	jsonTokenxx 
=xx 
tokenHandlerxx (
.xx( )
ReadJwtTokenxx) 5
(xx5 6
tokenxx6 ;
)xx; <
;xx< =
returnyy 
	jsonTokenyy 
.yy 
Claimsyy #
.zz 
Wherezz 
(zz 
xzz 
=>zz 
xzz 
.zz 
Typezz "
==zz# %

ClaimTypeszz& 0
.zz0 1
Rolezz1 5
)zz5 6
.{{ 
Select{{ 
({{ 
x{{ 
=>{{ 
x{{ 
.{{ 
Value{{ $
){{$ %
.|| 
ToList|| 
(|| 
)|| 
;|| 
}}} 	
catch~~ 
{ 	
return
ÄÄ 
new
ÄÄ 
List
ÄÄ 
<
ÄÄ 
string
ÄÄ "
>
ÄÄ" #
(
ÄÄ# $
)
ÄÄ$ %
;
ÄÄ% &
}
ÅÅ 	
}
ÇÇ 
public
áá 

List
áá 
<
áá 
string
áá 
>
áá  
ExtractPermissions
áá *
(
áá* +
string
áá+ 1
token
áá2 7
)
áá7 8
{
àà 
try
ââ 
{
ää 	
var
ãã 
tokenHandler
ãã 
=
ãã 
new
ãã "%
JwtSecurityTokenHandler
ãã# :
(
ãã: ;
)
ãã; <
;
ãã< =
var
åå 
	jsonToken
åå 
=
åå 
tokenHandler
åå (
.
åå( )
ReadJwtToken
åå) 5
(
åå5 6
token
åå6 ;
)
åå; <
;
åå< =
return
çç 
	jsonToken
çç 
.
çç 
Claims
çç #
.
éé 
Where
éé 
(
éé 
x
éé 
=>
éé 
x
éé 
.
éé 
Type
éé "
==
éé# %
$str
éé& 2
)
éé2 3
.
èè 
Select
èè 
(
èè 
x
èè 
=>
èè 
x
èè 
.
èè 
Value
èè $
)
èè$ %
.
êê 
ToList
êê 
(
êê 
)
êê 
;
êê 
}
ëë 	
catch
íí 
{
ìì 	
return
îî 
new
îî 
List
îî 
<
îî 
string
îî "
>
îî" #
(
îî# $
)
îî$ %
;
îî% &
}
ïï 	
}
ññ 
public
õõ 

string
õõ 
ExtractAuthLevel
õõ "
(
õõ" #
string
õõ# )
token
õõ* /
)
õõ/ 0
{
úú 
try
ùù 
{
ûû 	
var
üü 
tokenHandler
üü 
=
üü 
new
üü "%
JwtSecurityTokenHandler
üü# :
(
üü: ;
)
üü; <
;
üü< =
var
†† 
	jsonToken
†† 
=
†† 
tokenHandler
†† (
.
††( )
ReadJwtToken
††) 5
(
††5 6
token
††6 ;
)
††; <
;
††< =
return
°° 
	jsonToken
°° 
.
°° 
Claims
°° #
.
°°# $
FirstOrDefault
°°$ 2
(
°°2 3
x
°°3 4
=>
°°5 7
x
°°8 9
.
°°9 :
Type
°°: >
==
°°? A
$str
°°B N
)
°°N O
?
°°O P
.
°°P Q
Value
°°Q V
??
°°W Y
$str
°°Z `
;
°°` a
}
¢¢ 	
catch
££ 
{
§§ 	
return
•• 
$str
•• 
;
•• 
}
¶¶ 	
}
ßß 
public
¨¨ 

string
¨¨ %
ExtractIdentityProvider
¨¨ )
(
¨¨) *
string
¨¨* 0
token
¨¨1 6
)
¨¨6 7
{
≠≠ 
try
ÆÆ 
{
ØØ 	
var
∞∞ 
tokenHandler
∞∞ 
=
∞∞ 
new
∞∞ "%
JwtSecurityTokenHandler
∞∞# :
(
∞∞: ;
)
∞∞; <
;
∞∞< =
var
±± 
	jsonToken
±± 
=
±± 
tokenHandler
±± (
.
±±( )
ReadJwtToken
±±) 5
(
±±5 6
token
±±6 ;
)
±±; <
;
±±< =
return
≤≤ 
	jsonToken
≤≤ 
.
≤≤ 
Claims
≤≤ #
.
≤≤# $
FirstOrDefault
≤≤$ 2
(
≤≤2 3
x
≤≤3 4
=>
≤≤5 7
x
≤≤8 9
.
≤≤9 :
Type
≤≤: >
==
≤≤? A
$str
≤≤B G
)
≤≤G H
?
≤≤H I
.
≤≤I J
Value
≤≤J O
??
≤≤P R
$str
≤≤S Z
;
≤≤Z [
}
≥≥ 	
catch
¥¥ 
{
µµ 	
return
∂∂ 
$str
∂∂ 
;
∂∂ 
}
∑∑ 	
}
∏∏ 
public
ΩΩ 


Dictionary
ΩΩ 
<
ΩΩ 
string
ΩΩ 
,
ΩΩ 
object
ΩΩ $
>
ΩΩ$ %
ExtractAllClaims
ΩΩ& 6
(
ΩΩ6 7
string
ΩΩ7 =
token
ΩΩ> C
)
ΩΩC D
{
ææ 
try
øø 
{
¿¿ 	
var
¡¡ 
tokenHandler
¡¡ 
=
¡¡ 
new
¡¡ "%
JwtSecurityTokenHandler
¡¡# :
(
¡¡: ;
)
¡¡; <
;
¡¡< =
var
¬¬ 
	jsonToken
¬¬ 
=
¬¬ 
tokenHandler
¬¬ (
.
¬¬( )
ReadJwtToken
¬¬) 5
(
¬¬5 6
token
¬¬6 ;
)
¬¬; <
;
¬¬< =
var
ƒƒ 
claims
ƒƒ 
=
ƒƒ 
new
ƒƒ 

Dictionary
ƒƒ '
<
ƒƒ' (
string
ƒƒ( .
,
ƒƒ. /
object
ƒƒ0 6
>
ƒƒ6 7
(
ƒƒ7 8
)
ƒƒ8 9
;
ƒƒ9 :
foreach
≈≈ 
(
≈≈ 
var
≈≈ 
claim
≈≈ 
in
≈≈ !
	jsonToken
≈≈" +
.
≈≈+ ,
Claims
≈≈, 2
)
≈≈2 3
{
∆∆ 
if
«« 
(
«« 
claims
«« 
.
«« 
ContainsKey
«« &
(
««& '
claim
««' ,
.
««, -
Type
««- 1
)
««1 2
)
««2 3
{
»» 
if
…… 
(
…… 
claims
…… 
[
…… 
claim
…… $
.
……$ %
Type
……% )
]
……) *
is
……+ -
List
……. 2
<
……2 3
string
……3 9
>
……9 :
list
……; ?
)
……? @
{
   
list
ÀÀ 
.
ÀÀ 
Add
ÀÀ  
(
ÀÀ  !
claim
ÀÀ! &
.
ÀÀ& '
Value
ÀÀ' ,
)
ÀÀ, -
;
ÀÀ- .
}
ÃÃ 
else
ÕÕ 
{
ŒŒ 
claims
œœ 
[
œœ 
claim
œœ $
.
œœ$ %
Type
œœ% )
]
œœ) *
=
œœ+ ,
new
œœ- 0
List
œœ1 5
<
œœ5 6
string
œœ6 <
>
œœ< =
{
œœ> ?
claims
œœ@ F
[
œœF G
claim
œœG L
.
œœL M
Type
œœM Q
]
œœQ R
.
œœR S
ToString
œœS [
(
œœ[ \
)
œœ\ ]
!
œœ] ^
,
œœ^ _
claim
œœ` e
.
œœe f
Value
œœf k
}
œœl m
;
œœm n
}
–– 
}
—— 
else
““ 
{
”” 
claims
‘‘ 
[
‘‘ 
claim
‘‘  
.
‘‘  !
Type
‘‘! %
]
‘‘% &
=
‘‘' (
claim
‘‘) .
.
‘‘. /
Value
‘‘/ 4
;
‘‘4 5
}
’’ 
}
÷÷ 
return
ÿÿ 
claims
ÿÿ 
;
ÿÿ 
}
ŸŸ 	
catch
⁄⁄ 
{
€€ 	
return
‹‹ 
new
‹‹ 

Dictionary
‹‹ !
<
‹‹! "
string
‹‹" (
,
‹‹( )
object
‹‹* 0
>
‹‹0 1
(
‹‹1 2
)
‹‹2 3
;
‹‹3 4
}
›› 	
}
ﬁﬁ 
}ﬂﬂ ˙•
E/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Logging 
. 
ClearProviders 
( 
)  
;  !
builder 
. 
Logging 
. 

AddConsole 
( 
) 
; 
builder 
. 
Logging 
. 
SetMinimumLevel 
(  
LogLevel  (
.( )
Information) 4
)4 5
;5 6
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
c  
=>! #
{ 
c 
. 

SwaggerDoc 
( 
$str 
, 
new 
	Microsoft $
.$ %
OpenApi% ,
., -
Models- 3
.3 4
OpenApiInfo4 ?
{ 
Title 
= 
$str 5
,5 6
Version 
= 
$str 
, 
Description   
=   
$str Q 
}RR 
)RR 
;RR 
cUU 
.UU !
AddSecurityDefinitionUU 
(UU 
$strUU $
,UU$ %
newUU& )
	MicrosoftUU* 3
.UU3 4
OpenApiUU4 ;
.UU; <
ModelsUU< B
.UUB C!
OpenApiSecuritySchemeUUC X
{VV 
DescriptionWW 
=WW 
$strWb 
,bb 
Namecc 
=cc 
$strcc 
,cc 
Indd 

=dd 
	Microsoftdd 
.dd 
OpenApidd 
.dd 
Modelsdd %
.dd% &
ParameterLocationdd& 7
.dd7 8
Headerdd8 >
,dd> ?
Typeee 
=ee 
	Microsoftee 
.ee 
OpenApiee  
.ee  !
Modelsee! '
.ee' (
SecuritySchemeTypeee( :
.ee: ;
ApiKeyee; A
,eeA B
Schemeff 
=ff 
$strff 
}gg 
)gg 
;gg 
cii 
.ii "
AddSecurityRequirementii 
(ii 
newii  
	Microsoftii! *
.ii* +
OpenApiii+ 2
.ii2 3
Modelsii3 9
.ii9 :&
OpenApiSecurityRequirementii: T
{jj 
{kk 	
newll 
	Microsoftll 
.ll 
OpenApill !
.ll! "
Modelsll" (
.ll( )!
OpenApiSecuritySchemell) >
{mm 
	Referencenn 
=nn 
newnn 
	Microsoftnn  )
.nn) *
OpenApinn* 1
.nn1 2
Modelsnn2 8
.nn8 9
OpenApiReferencenn9 I
{oo 
Typepp 
=pp 
	Microsoftpp $
.pp$ %
OpenApipp% ,
.pp, -
Modelspp- 3
.pp3 4
ReferenceTypepp4 A
.ppA B
SecuritySchemeppB P
,ppP Q
Idqq 
=qq 
$strqq !
}rr 
}ss 
,ss 
Arraytt 
.tt 
Emptytt 
<tt 
stringtt 
>tt 
(tt  
)tt  !
}uu 	
}vv 
)vv 
;vv 
}ww 
)ww 
;ww 
builderzz 
.zz 
Serviceszz 
.zz 
	AddScopedzz 
<zz 

JwtServicezz %
>zz% &
(zz& '
)zz' (
;zz( )
var}} 
	jwtSecret}} 
=}} 
builder}} 
.}} 
Configuration}} %
[}}% &
$str}}& 2
]}}2 3
??}}4 6
$str}}7 o
;}}o p
var~~ 
key~~ 
=~~ 	
Encoding~~
 
.~~ 
ASCII~~ 
.~~ 
GetBytes~~ !
(~~! "
	jwtSecret~~" +
)~~+ ,
;~~, -
builderÄÄ 
.
ÄÄ 
Services
ÄÄ 
.
ÄÄ 
AddAuthentication
ÄÄ "
(
ÄÄ" #
options
ÄÄ# *
=>
ÄÄ+ -
{ÅÅ 
options
ÇÇ 
.
ÇÇ '
DefaultAuthenticateScheme
ÇÇ %
=
ÇÇ& '
JwtBearerDefaults
ÇÇ( 9
.
ÇÇ9 :"
AuthenticationScheme
ÇÇ: N
;
ÇÇN O
options
ÉÉ 
.
ÉÉ $
DefaultChallengeScheme
ÉÉ "
=
ÉÉ# $
JwtBearerDefaults
ÉÉ% 6
.
ÉÉ6 7"
AuthenticationScheme
ÉÉ7 K
;
ÉÉK L
}ÑÑ 
)
ÑÑ 
.ÖÖ 
AddJwtBearer
ÖÖ 
(
ÖÖ 
options
ÖÖ 
=>
ÖÖ 
{ÜÜ 
options
áá 
.
áá "
RequireHttpsMetadata
áá  
=
áá! "
false
áá# (
;
áá( )
options
àà 
.
àà 
	SaveToken
àà 
=
àà 
true
àà 
;
àà 
options
ââ 
.
ââ '
TokenValidationParameters
ââ %
=
ââ& '
new
ââ( +'
TokenValidationParameters
ââ, E
{
ää &
ValidateIssuerSigningKey
ãã  
=
ãã! "
true
ãã# '
,
ãã' (
IssuerSigningKey
åå 
=
åå 
new
åå "
SymmetricSecurityKey
åå 3
(
åå3 4
key
åå4 7
)
åå7 8
,
åå8 9
ValidateIssuer
çç 
=
çç 
false
çç 
,
çç 
ValidateAudience
éé 
=
éé 
false
éé  
,
éé  !
ValidateLifetime
èè 
=
èè 
true
èè 
,
èè  
	ClockSkew
êê 
=
êê 
TimeSpan
êê 
.
êê 
Zero
êê !
}
ëë 
;
ëë 
}íí 
)
íí 
;
íí 
builderïï 
.
ïï 
Services
ïï 
.
ïï 
AddAuthorization
ïï !
(
ïï! "
options
ïï" )
=>
ïï* ,
{ññ 
options
òò 
.
òò 
	AddPolicy
òò 
(
òò 
$str
òò 2
,
òò2 3
policy
òò4 :
=>
òò; =
policy
ôô 
.
ôô 
Requirements
ôô 
.
ôô 
Add
ôô 
(
ôô  
new
ôô  ##
PermissionRequirement
ôô$ 9
(
ôô9 :
$str
ôô: F
)
ôôF G
)
ôôG H
)
ôôH I
;
ôôI J
options
õõ 
.
õõ 
	AddPolicy
õõ 
(
õõ 
$str
õõ 3
,
õõ3 4
policy
õõ5 ;
=>
õõ< >
policy
úú 
.
úú 
Requirements
úú 
.
úú 
Add
úú 
(
úú  
new
úú  ##
PermissionRequirement
úú$ 9
(
úú9 :
$str
úú: G
)
úúG H
)
úúH I
)
úúI J
;
úúJ K
options
ûû 
.
ûû 
	AddPolicy
ûû 
(
ûû 
$str
ûû 4
,
ûû4 5
policy
ûû6 <
=>
ûû= ?
policy
üü 
.
üü 
Requirements
üü 
.
üü 
Add
üü 
(
üü  
new
üü  ##
PermissionRequirement
üü$ 9
(
üü9 :
$str
üü: H
)
üüH I
)
üüI J
)
üüJ K
;
üüK L
options
°° 
.
°° 
	AddPolicy
°° 
(
°° 
$str
°° 3
,
°°3 4
policy
°°5 ;
=>
°°< >
policy
¢¢ 
.
¢¢ 
Requirements
¢¢ 
.
¢¢ 
Add
¢¢ 
(
¢¢  
new
¢¢  ##
PermissionRequirement
¢¢$ 9
(
¢¢9 :
$str
¢¢: G
)
¢¢G H
)
¢¢H I
)
¢¢I J
;
¢¢J K
options
•• 
.
•• 
	AddPolicy
•• 
(
•• 
$str
•• 9
,
••9 :
policy
••; A
=>
••B D
policy
¶¶ 
.
¶¶ 
Requirements
¶¶ 
.
¶¶ 
Add
¶¶ 
(
¶¶  
new
¶¶  #&
AnyPermissionRequirement
¶¶$ <
(
¶¶< =
$str
¶¶= I
,
¶¶I J
$str
¶¶K X
)
¶¶X Y
)
¶¶Y Z
)
¶¶Z [
;
¶¶[ \
options
®® 
.
®® 
	AddPolicy
®® 
(
®® 
$str
®® :
,
®®: ;
policy
®®< B
=>
®®C E
policy
©© 
.
©© 
Requirements
©© 
.
©© 
Add
©© 
(
©©  
new
©©  #&
AnyPermissionRequirement
©©$ <
(
©©< =
$str
©©= J
,
©©J K
$str
©©L Y
)
©©Y Z
)
©©Z [
)
©©[ \
;
©©\ ]
options
´´ 
.
´´ 
	AddPolicy
´´ 
(
´´ 
$str
´´ ;
,
´´; <
policy
´´= C
=>
´´D F
policy
¨¨ 
.
¨¨ 
Requirements
¨¨ 
.
¨¨ 
Add
¨¨ 
(
¨¨  
new
¨¨  #&
AnyPermissionRequirement
¨¨$ <
(
¨¨< =
$str
¨¨= K
,
¨¨K L
$str
¨¨M Z
)
¨¨Z [
)
¨¨[ \
)
¨¨\ ]
;
¨¨] ^
options
ØØ 
.
ØØ 
	AddPolicy
ØØ 
(
ØØ 
$str
ØØ +
,
ØØ+ ,
policy
ØØ- 3
=>
ØØ4 6
policy
∞∞ 
.
∞∞ 
Requirements
∞∞ 
.
∞∞ 
Add
∞∞ 
(
∞∞  
new
∞∞  #"
AuthLevelRequirement
∞∞$ 8
(
∞∞8 9
$str
∞∞9 ?
)
∞∞? @
)
∞∞@ A
)
∞∞A B
;
∞∞B C
options
≤≤ 
.
≤≤ 
	AddPolicy
≤≤ 
(
≤≤ 
$str
≤≤ +
,
≤≤+ ,
policy
≤≤- 3
=>
≤≤4 6
policy
≥≥ 
.
≥≥ 
Requirements
≥≥ 
.
≥≥ 
Add
≥≥ 
(
≥≥  
new
≥≥  #"
AuthLevelRequirement
≥≥$ 8
(
≥≥8 9
$str
≥≥9 ?
)
≥≥? @
)
≥≥@ A
)
≥≥A B
;
≥≥B C
options
∂∂ 
.
∂∂ 
	AddPolicy
∂∂ 
(
∂∂ 
$str
∂∂ ,
,
∂∂, -
policy
∂∂. 4
=>
∂∂5 7
policy
∑∑ 
.
∑∑ 
Requirements
∑∑ 
.
∑∑ 
Add
∑∑ 
(
∑∑  
new
∑∑  #)
IdentityProviderRequirement
∑∑$ ?
(
∑∑? @
$str
∑∑@ Q
)
∑∑Q R
)
∑∑R S
)
∑∑S T
;
∑∑T U
options
∫∫ 
.
∫∫ 
	AddPolicy
∫∫ 
(
∫∫ 
$str
∫∫ .
,
∫∫. /
policy
∫∫0 6
=>
∫∫7 9
{
ªª 
policy
ºº 
.
ºº 
RequireRole
ºº 
(
ºº 
$str
ºº "
)
ºº" #
;
ºº# $
policy
ΩΩ 
.
ΩΩ 
Requirements
ΩΩ 
.
ΩΩ 
Add
ΩΩ 
(
ΩΩ  
new
ΩΩ  ##
PermissionRequirement
ΩΩ$ 9
(
ΩΩ9 :
$str
ΩΩ: G
)
ΩΩG H
)
ΩΩH I
;
ΩΩI J
policy
ææ 
.
ææ 
Requirements
ææ 
.
ææ 
Add
ææ 
(
ææ  
new
ææ  #&
AnyPermissionRequirement
ææ$ <
(
ææ< =
$str
ææ= N
,
ææN O
$str
ææP e
)
ææe f
)
ææf g
;
ææg h
}
øø 
)
øø 
;
øø 
}¿¿ 
)
¿¿ 
;
¿¿ 
builder√√ 
.
√√ 
Services
√√ 
.
√√ 
	AddScoped
√√ 
<
√√ #
IAuthorizationHandler
√√ 0
,
√√0 1
PermissionHandler
√√2 C
>
√√C D
(
√√D E
)
√√E F
;
√√F G
builderƒƒ 
.
ƒƒ 
Services
ƒƒ 
.
ƒƒ 
	AddScoped
ƒƒ 
<
ƒƒ #
IAuthorizationHandler
ƒƒ 0
,
ƒƒ0 1"
AnyPermissionHandler
ƒƒ2 F
>
ƒƒF G
(
ƒƒG H
)
ƒƒH I
;
ƒƒI J
builder≈≈ 
.
≈≈ 
Services
≈≈ 
.
≈≈ 
	AddScoped
≈≈ 
<
≈≈ #
IAuthorizationHandler
≈≈ 0
,
≈≈0 1#
AllPermissionsHandler
≈≈2 G
>
≈≈G H
(
≈≈H I
)
≈≈I J
;
≈≈J K
builder∆∆ 
.
∆∆ 
Services
∆∆ 
.
∆∆ 
	AddScoped
∆∆ 
<
∆∆ #
IAuthorizationHandler
∆∆ 0
,
∆∆0 1
AuthLevelHandler
∆∆2 B
>
∆∆B C
(
∆∆C D
)
∆∆D E
;
∆∆E F
builder«« 
.
«« 
Services
«« 
.
«« 
	AddScoped
«« 
<
«« #
IAuthorizationHandler
«« 0
,
««0 1%
IdentityProviderHandler
««2 I
>
««I J
(
««J K
)
««K L
;
««L M
builder   
.
   
Services
   
.
   
AddHealthChecks
    
(
    !
)
  ! "
.
ÀÀ 
AddCheck
ÀÀ 
(
ÀÀ 
$str
ÀÀ 
,
ÀÀ 
(
ÀÀ 
)
ÀÀ 
=>
ÀÀ 
HealthCheckResult
ÀÀ -
.
ÀÀ- .
Healthy
ÀÀ. 5
(
ÀÀ5 6
)
ÀÀ6 7
,
ÀÀ7 8
new
ÀÀ9 <
[
ÀÀ< =
]
ÀÀ= >
{
ÀÀ? @
$str
ÀÀA H
}
ÀÀI J
)
ÀÀJ K
.
ÃÃ 
AddCheck
ÃÃ 
(
ÃÃ 
$str
ÃÃ 
,
ÃÃ 
(
ÃÃ 
)
ÃÃ 
=>
ÃÃ 
HealthCheckResult
ÃÃ  1
.
ÃÃ1 2
Healthy
ÃÃ2 9
(
ÃÃ9 :
)
ÃÃ: ;
,
ÃÃ; <
new
ÃÃ= @
[
ÃÃ@ A
]
ÃÃA B
{
ÃÃC D
$str
ÃÃE K
}
ÃÃL M
)
ÃÃM N
;
ÃÃN O
varœœ 
otelEndpoint
œœ 
=
œœ 
Environment
œœ 
.
œœ $
GetEnvironmentVariable
œœ 5
(
œœ5 6
$str
œœ6 S
)
œœS T
??
œœU W
$str
œœX t
;
œœt u
builder–– 
.
–– 
Services
–– 
.
–– 
AddOpenTelemetry
–– !
(
––! "
)
––" #
.
—— 
ConfigureResource
—— 
(
—— 
resource
—— 
=>
——  "
resource
——# +
.
““ 	

AddService
““	 
(
““ 
serviceName
““ 
:
““  
$str
““! -
,
““- .
serviceVersion
““/ =
:
““= >
$str
““? F
)
““F G
)
““G H
.
”” 
WithMetrics
”” 
(
”” 
metrics
”” 
=>
”” 
{
‘‘ 
metrics
’’ 
.
÷÷ *
AddAspNetCoreInstrumentation
÷÷ )
(
÷÷) *
)
÷÷* +
.
◊◊ 
AddOtlpExporter
◊◊ 
(
◊◊ 
options
◊◊ $
=>
◊◊% '
{
ÿÿ 
options
ŸŸ 
.
ŸŸ 
Endpoint
ŸŸ  
=
ŸŸ! "
new
ŸŸ# &
Uri
ŸŸ' *
(
ŸŸ* +
otelEndpoint
ŸŸ+ 7
)
ŸŸ7 8
;
ŸŸ8 9
options
⁄⁄ 
.
⁄⁄ 
Protocol
⁄⁄  
=
⁄⁄! "
OpenTelemetry
⁄⁄# 0
.
⁄⁄0 1
Exporter
⁄⁄1 9
.
⁄⁄9 : 
OtlpExportProtocol
⁄⁄: L
.
⁄⁄L M
Grpc
⁄⁄M Q
;
⁄⁄Q R
}
€€ 
)
€€ 
;
€€ 
}
‹‹ 
)
‹‹ 
;
‹‹ 
varﬁﬁ 
app
ﬁﬁ 
=
ﬁﬁ 	
builder
ﬁﬁ
 
.
ﬁﬁ 
Build
ﬁﬁ 
(
ﬁﬁ 
)
ﬁﬁ 
;
ﬁﬁ 
var·· 
logger
·· 

=
·· 
app
·· 
.
·· 
Services
·· 
.
··  
GetRequiredService
·· ,
<
··, -
ILogger
··- 4
<
··4 5
Program
··5 <
>
··< =
>
··= >
(
··> ?
)
··? @
;
··@ A
logger‚‚ 
.
‚‚ 
LogInformation
‚‚ 
(
‚‚ 
$str
‚‚ M
)
‚‚M N
;
‚‚N O
logger„„ 
.
„„ 
LogInformation
„„ 
(
„„ 
$str
„„ N
,
„„N O
otelEndpoint
„„P \
)
„„\ ]
;
„„] ^
logger‰‰ 
.
‰‰ 
LogInformation
‰‰ 
(
‰‰ 
$str
‰‰ \
)
‰‰\ ]
;
‰‰] ^
ifÁÁ 
(
ÁÁ 
app
ÁÁ 
.
ÁÁ 
Environment
ÁÁ 
.
ÁÁ 
IsDevelopment
ÁÁ !
(
ÁÁ! "
)
ÁÁ" #
)
ÁÁ# $
{ËË 
app
ÈÈ 
.
ÈÈ 

UseSwagger
ÈÈ 
(
ÈÈ 
)
ÈÈ 
;
ÈÈ 
app
ÍÍ 
.
ÍÍ 
UseSwaggerUI
ÍÍ 
(
ÍÍ 
)
ÍÍ 
;
ÍÍ 
}ÎÎ 
app 
.
 
UseHttpMetrics
 
(
 
)
 
;
 
appÒÒ 
.
ÒÒ 

UseRouting
ÒÒ 
(
ÒÒ 
)
ÒÒ 
;
ÒÒ 
appÙÙ 
.
ÙÙ 
UseAuthentication
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
appıı 
.
ıı 
UseAuthorization
ıı 
(
ıı 
)
ıı 
;
ıı 
app˜˜ 
.
˜˜ 
MapControllers
˜˜ 
(
˜˜ 
)
˜˜ 
;
˜˜ 
app˙˙ 
.
˙˙ 
MapHealthChecks
˙˙ 
(
˙˙ 
$str
˙˙ #
,
˙˙# $
new
˙˙% ( 
HealthCheckOptions
˙˙) ;
{˚˚ 
	Predicate
¸¸ 
=
¸¸ 
check
¸¸ 
=>
¸¸ 
check
¸¸ 
.
¸¸ 
Tags
¸¸ #
.
¸¸# $
Contains
¸¸$ ,
(
¸¸, -
$str
¸¸- 4
)
¸¸4 5
}˝˝ 
)
˝˝ 
;
˝˝ 
appˇˇ 
.
ˇˇ 
MapHealthChecks
ˇˇ 
(
ˇˇ 
$str
ˇˇ "
,
ˇˇ" #
new
ˇˇ$ ' 
HealthCheckOptions
ˇˇ( :
{ÄÄ 
	Predicate
ÅÅ 
=
ÅÅ 
check
ÅÅ 
=>
ÅÅ 
check
ÅÅ 
.
ÅÅ 
Tags
ÅÅ #
.
ÅÅ# $
Contains
ÅÅ$ ,
(
ÅÅ, -
$str
ÅÅ- 3
)
ÅÅ3 4
}ÇÇ 
)
ÇÇ 
;
ÇÇ 
appÑÑ 
.
ÑÑ 
MapHealthChecks
ÑÑ 
(
ÑÑ 
$str
ÑÑ &
,
ÑÑ& '
new
ÑÑ( + 
HealthCheckOptions
ÑÑ, >
{ÖÖ 
ResponseWriter
ÜÜ 
=
ÜÜ 
async
ÜÜ 
(
ÜÜ 
context
ÜÜ #
,
ÜÜ# $
report
ÜÜ% +
)
ÜÜ+ ,
=>
ÜÜ- /
{
áá 
context
àà 
.
àà 
Response
àà 
.
àà 
ContentType
àà $
=
àà% &
$str
àà' 9
;
àà9 :
var
ââ 
response
ââ 
=
ââ 
new
ââ 
{
ää 	
status
ãã 
=
ãã 
report
ãã 
.
ãã 
Status
ãã "
.
ãã" #
ToString
ãã# +
(
ãã+ ,
)
ãã, -
,
ãã- .

components
åå 
=
åå 
report
åå 
.
åå  
Entries
åå  '
.
åå' (
ToDictionary
åå( 4
(
åå4 5
entry
çç 
=>
çç 
entry
çç 
.
çç 
Key
çç "
,
çç" #
entry
éé 
=>
éé 
new
éé 
{
èè 
status
êê 
=
êê 
entry
êê "
.
êê" #
Value
êê# (
.
êê( )
Status
êê) /
.
êê/ 0
ToString
êê0 8
(
êê8 9
)
êê9 :
,
êê: ;
details
ëë 
=
ëë 
entry
ëë #
.
ëë# $
Value
ëë$ )
.
ëë) *
Description
ëë* 5
}
íí 
)
ìì 
}
îî 	
;
îî	 

await
ïï 
context
ïï 
.
ïï 
Response
ïï 
.
ïï 

WriteAsync
ïï )
(
ïï) *
JsonSerializer
ïï* 8
.
ïï8 9
	Serialize
ïï9 B
(
ïïB C
response
ïïC K
)
ïïK L
)
ïïL M
;
ïïM N
}
ññ 
}óó 
)
óó 
;
óó 
appöö 
.
öö 

MapMetrics
öö 
(
öö 
)
öö 
;
öö 
appúú 
.
úú 
Run
úú 
(
úú 
)
úú 	
;
úú	 
≈R
a/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Controllers/VulnerableJWTController.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Controllers *
;* +
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
public		 
class		 #
VulnerableJWTController		 $
:		% &
ControllerBase		' 5
{

 
private 
readonly 
ILogger 
< #
VulnerableJWTController 4
>4 5
_logger6 =
;= >
private 
static 
readonly 
string "
WEAK_SECRET# .
=/ 0
$str1 A
;A B
public 
#
VulnerableJWTController "
(" #
ILogger# *
<* +#
VulnerableJWTController+ B
>B C
loggerD J
)J K
{ 
_logger 
= 
logger 
; 
} 
[ 
HttpPost 
( 
$str 
) 
] 
public 

IActionResult 
CreateToken $
($ %
[% &
FromBody& .
]. /

Dictionary0 :
<: ;
string; A
,A B
objectC I
>I J
payloadK R
)R S
{ 
try 
{ 	
var 
header 
= 
Convert  
.  !
ToBase64String! /
(/ 0
Encoding0 8
.8 9
UTF89 =
.= >
GetBytes> F
(F G
$strG l
)l m
)m n
;n o
var 

payloadStr 
= 
Convert $
.$ %
ToBase64String% 3
(3 4
Encoding4 <
.< =
UTF8= A
.A B
GetBytesB J
(J K
JsonSerializerK Y
.Y Z
	SerializeZ c
(c d
payloadd k
)k l
)l m
)m n
;n o
var   
	signature   
=   
Convert   #
.  # $
ToBase64String  $ 2
(  2 3
Encoding  3 ;
.  ; <
UTF8  < @
.  @ A
GetBytes  A I
(  I J
WEAK_SECRET  J U
)  U V
)  V W
;  W X
var"" 
token"" 
="" 
$""" 
{"" 
header"" !
}""! "
$str""" #
{""# $

payloadStr""$ .
}"". /
$str""/ 0
{""0 1
	signature""1 :
}"": ;
"""; <
;""< =
return## 
Ok## 
(## 
token## 
)## 
;## 
}$$ 	
catch%% 
(%% 
	Exception%% 
e%% 
)%% 
{&& 	
return'' 

BadRequest'' 
('' 
$"''  
$str''  6
{''6 7
e''7 8
.''8 9
Message''9 @
}''@ A
"''A B
)''B C
;''C D
}(( 	
})) 
[.. 
HttpPost.. 
(.. 
$str.. 
).. 
].. 
public// 

IActionResult// 
VerifyToken// $
(//$ %
[//% &
FromBody//& .
]//. /

Dictionary//0 :
<//: ;
string//; A
,//A B
string//C I
>//I J
request//K R
)//R S
{00 
try11 
{22 	
var33 
token33 
=33 
request33 
.33  
GetValueOrDefault33  1
(331 2
$str332 9
,339 :
$str33; =
)33= >
;33> ?
var66 
response66 
=66 
new66 

Dictionary66 )
<66) *
string66* 0
,660 1
object662 8
>668 9
{77 
[88 
$str88 
]88 
=88 
true88  
,88  !
[99 
$str99 
]99 
=99 
token99 !
,99! "
[:: 
$str:: 
]:: 
=:: 
$str:: H
};; 
;;; 
return== 
Ok== 
(== 
response== 
)== 
;==  
}>> 	
catch?? 
(?? 
	Exception?? 
e?? 
)?? 
{@@ 	
varAA 
responseAA 
=AA 
newAA 

DictionaryAA )
<AA) *
stringAA* 0
,AA0 1
objectAA2 8
>AA8 9
{BB 
[CC 
$strCC 
]CC 
=CC 
falseCC !
,CC! "
[DD 
$strDD 
]DD 
=DD 
eDD 
.DD 
MessageDD %
}EE 
;EE 
returnGG 
OkGG 
(GG 
responseGG 
)GG 
;GG  
}HH 	
}II 
[NN 
HttpGetNN 
(NN 
$strNN 
)NN 
]NN 
publicOO 

IActionResultOO 
DecodeTokenOO $
(OO$ %
[OO% &
	FromQueryOO& /
]OO/ 0
stringOO1 7
tokenOO8 =
)OO= >
{PP 
tryQQ 
{RR 	
varTT 
partsTT 
=TT 
tokenTT 
.TT 
SplitTT #
(TT# $
$charTT$ '
)TT' (
;TT( )
varUU 
responseUU 
=UU 
newUU 

DictionaryUU )
<UU) *
stringUU* 0
,UU0 1
objectUU2 8
>UU8 9
{VV 
[WW 
$strWW 
]WW 
=WW 
trueWW "
,WW" #
[XX 
$strXX 
]XX 
=XX 
partsXX "
.XX" #
LengthXX# )
>XX* +
$numXX, -
?XX. /
EncodingXX0 8
.XX8 9
UTF8XX9 =
.XX= >
	GetStringXX> G
(XXG H
ConvertXXH O
.XXO P
FromBase64StringXXP `
(XX` a
partsXXa f
[XXf g
$numXXg h
]XXh i
)XXi j
)XXj k
:XXl m
$strXXn p
,XXp q
[YY 
$strYY 
]YY 
=YY 
partsYY #
.YY# $
LengthYY$ *
>YY+ ,
$numYY- .
?YY/ 0
EncodingYY1 9
.YY9 :
UTF8YY: >
.YY> ?
	GetStringYY? H
(YYH I
ConvertYYI P
.YYP Q
FromBase64StringYYQ a
(YYa b
partsYYb g
[YYg h
$numYYh i
]YYi j
)YYj k
)YYk l
:YYm n
$strYYo q
,YYq r
[ZZ 
$strZZ 
]ZZ 
=ZZ 
partsZZ  %
.ZZ% &
LengthZZ& ,
>ZZ- .
$numZZ/ 0
?ZZ1 2
partsZZ3 8
[ZZ8 9
$numZZ9 :
]ZZ: ;
:ZZ< =
$strZZ> @
}[[ 
;[[ 
return]] 
Ok]] 
(]] 
response]] 
)]] 
;]]  
}^^ 	
catch__ 
(__ 
	Exception__ 
e__ 
)__ 
{`` 	
varaa 
responseaa 
=aa 
newaa 

Dictionaryaa )
<aa) *
stringaa* 0
,aa0 1
objectaa2 8
>aa8 9
{bb 
[cc 
$strcc 
]cc 
=cc 
falsecc #
,cc# $
[dd 
$strdd 
]dd 
=dd 
edd 
.dd 
Messagedd %
}ee 
;ee 
returngg 
Okgg 
(gg 
responsegg 
)gg 
;gg  
}hh 	
}ii 
[nn 
HttpPostnn 
(nn 
$strnn $
)nn$ %
]nn% &
publicoo 

IActionResultoo 
VerifyAnyAlgorithmoo +
(oo+ ,
[oo, -
FromBodyoo- 5
]oo5 6

Dictionaryoo7 A
<ooA B
stringooB H
,ooH I
stringooJ P
>ooP Q
requestooR Y
)ooY Z
{pp 
tryqq 
{rr 	
varss 
tokenss 
=ss 
requestss 
.ss  
GetValueOrDefaultss  1
(ss1 2
$strss2 9
,ss9 :
$strss; =
)ss= >
;ss> ?
vartt 
	algorithmtt 
=tt 
requesttt #
.tt# $
GetValueOrDefaulttt$ 5
(tt5 6
$strtt6 A
,ttA B
$strttC E
)ttE F
;ttF G
varww 
responseww 
=ww 
newww 

Dictionaryww )
<ww) *
stringww* 0
,ww0 1
objectww2 8
>ww8 9
{xx 
[yy 
$stryy 
]yy 
=yy 
trueyy  
,yy  !
[zz 
$strzz 
]zz 
=zz 
	algorithmzz  )
,zz) *
[{{ 
$str{{ 
]{{ 
={{ 
token{{ !
,{{! "
[|| 
$str|| 
]|| 
=|| 
$"||  
$str||  G
{||G H
	algorithm||H Q
}||Q R
"||R S
}}} 
;}} 
return 
Ok 
( 
response 
) 
;  
}
ÄÄ 	
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
e
ÅÅ 
)
ÅÅ 
{
ÇÇ 	
var
ÉÉ 
response
ÉÉ 
=
ÉÉ 
new
ÉÉ 

Dictionary
ÉÉ )
<
ÉÉ) *
string
ÉÉ* 0
,
ÉÉ0 1
object
ÉÉ2 8
>
ÉÉ8 9
{
ÑÑ 
[
ÖÖ 
$str
ÖÖ 
]
ÖÖ 
=
ÖÖ 
false
ÖÖ !
,
ÖÖ! "
[
ÜÜ 
$str
ÜÜ 
]
ÜÜ 
=
ÜÜ 
e
ÜÜ 
.
ÜÜ 
Message
ÜÜ %
}
áá 
;
áá 
return
ââ 
Ok
ââ 
(
ââ 
response
ââ 
)
ââ 
;
ââ  
}
ää 	
}
ãã 
}åå ç|
Y/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Controllers/TokenController.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Controllers *
;* +
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
[ 
Tags 
( 
$str 
) 
] 
public 
class 
TokenController 
: 
ControllerBase -
{ 
private 
readonly 

JwtService 
_jwtService  +
;+ ,
private 
readonly 
ILogger 
< 
TokenController ,
>, -
_logger. 5
;5 6
public 

TokenController 
( 

JwtService %

jwtService& 0
,0 1
ILogger2 9
<9 :
TokenController: I
>I J
loggerK Q
)Q R
{ 
_jwtService 
= 

jwtService  
;  !
_logger 
= 
logger 
; 
} 
[ 
HttpPost 
( 
$str 
) 
] 
[  
ProducesResponseType 
( 
typeof  
(  !
object! '
)' (
,( )
$num* -
)- .
]. /
[  
ProducesResponseType 
( 
$num 
) 
] 
public 

IActionResult 
GenerateToken &
(& '
[   	
	FromQuery  	 
,   
Required   
]   
string   $
username  % -
,  - .
[!! 	
	FromQuery!!	 
]!! 
string!! 
?!! 
roles!! !
=!!" #
null!!$ (
,!!( )
["" 	
	FromQuery""	 
]"" 
string"" 
?"" 
permissions"" '
=""( )
null""* .
)"". /
{## 
var%% 
	rolesList%% 
=%% 
string%% 
.%% 
IsNullOrEmpty%% ,
(%%, -
roles%%- 2
)%%2 3
?&& 
new&& 
List&& 
<&& 
string&& 
>&& 
{&&  
$str&&! '
}&&( )
:'' 
roles'' 
.'' 
Split'' 
('' 
$char'' 
)'' 
.'' 
Select'' %
(''% &
r''& '
=>''( *
r''+ ,
.'', -
Trim''- 1
(''1 2
)''2 3
)''3 4
.''4 5
ToList''5 ;
(''; <
)''< =
;''= >
var)) 
permissionsList)) 
=)) 
string)) $
.))$ %
IsNullOrEmpty))% 2
())2 3
permissions))3 >
)))> ?
?** 
new** 
List** 
<** 
string** 
>** 
{**  
$str**! -
}**. /
:++ 
permissions++ 
.++ 
Split++ 
(++  
$char++  #
)++# $
.++$ %
Select++% +
(+++ ,
p++, -
=>++. 0
p++1 2
.++2 3
Trim++3 7
(++7 8
)++8 9
)++9 :
.++: ;
ToList++; A
(++A B
)++B C
;++C D
var-- 
token-- 
=-- 
_jwtService-- 
.--  
GenerateToken--  -
(--- .
username--. 6
,--6 7
	rolesList--8 A
,--A B
permissionsList--C R
)--R S
;--S T
var// 
response// 
=// 
new// 
{00 	
token11 
,11 
username22 
,22 
roles33 
=33 
	rolesList33 
,33 
permissions44 
=44 
permissionsList44 )
,44) *
	expiresIn55 
=55 
$str55 "
,55" #
	timestamp66 
=66 
DateTimeOffset66 &
.66& '
UtcNow66' -
.66- ."
ToUnixTimeMilliseconds66. D
(66D E
)66E F
}77 	
;77	 

return99 
Ok99 
(99 
response99 
)99 
;99 
}:: 
[?? 
HttpGet?? 
(?? 
$str?? 
)?? 
]?? 
[@@  
ProducesResponseType@@ 
(@@ 
typeof@@  
(@@  !
object@@! '
)@@' (
,@@( )
$num@@* -
)@@- .
]@@. /
[AA  
ProducesResponseTypeAA 
(AA 
$numAA 
)AA 
]AA 
publicBB 

IActionResultBB #
GeneratePredefinedTokenBB 0
(BB0 1
stringBB1 7
typeBB8 <
)BB< =
{CC 
stringDD 
usernameDD 
;DD 
ListEE 
<EE 
stringEE 
>EE 
rolesEE 
;EE 
ListFF 
<FF 
stringFF 
>FF 
permissionsFF  
;FF  !
stringGG 
	authLevelGG 
;GG 
stringHH 
idpHH 
;HH 
switchJJ 
(JJ 
typeJJ 
.JJ 
ToLowerJJ 
(JJ 
)JJ 
)JJ 
{KK 	
caseLL 
$strLL 
:LL 
usernameMM 
=MM 
$strMM "
;MM" #
rolesNN 
=NN 
newNN 
ListNN  
<NN  !
stringNN! '
>NN' (
{NN) *
$strNN+ 2
,NN2 3
$strNN4 :
}NN; <
;NN< =
permissionsOO 
=OO 
newOO !
ListOO" &
<OO& '
stringOO' -
>OO- .
{OO/ 0
$strOO1 =
,OO= >
$strOO? L
,OOL M
$strOON \
,OO\ ]
$strOO^ k
}OOl m
;OOm n
	authLevelPP 
=PP 
$strPP "
;PP" #
idpQQ 
=QQ 
$strQQ '
;QQ' (
breakRR 
;RR 
caseSS 
$strSS 
:SS 
usernameTT 
=TT 
$strTT !
;TT! "
rolesUU 
=UU 
newUU 
ListUU  
<UU  !
stringUU! '
>UU' (
{UU) *
$strUU+ 1
}UU2 3
;UU3 4
permissionsVV 
=VV 
newVV !
ListVV" &
<VV& '
stringVV' -
>VV- .
{VV/ 0
$strVV1 =
}VV> ?
;VV? @
	authLevelWW 
=WW 
$strWW "
;WW" #
idpXX 
=XX 
$strXX 
;XX 
breakYY 
;YY 
caseZZ 
$strZZ 
:ZZ 
username[[ 
=[[ 
$str[[ (
;[[( )
roles\\ 
=\\ 
new\\ 
List\\  
<\\  !
string\\! '
>\\' (
{\\) *
$str\\+ 1
}\\2 3
;\\3 4
permissions]] 
=]] 
new]] !
List]]" &
<]]& '
string]]' -
>]]- .
{]]/ 0
$str]]1 =
,]]= >
$str]]? L
,]]L M
$str]]N \
,]]\ ]
$str]]^ k
}]]l m
;]]m n
	authLevel^^ 
=^^ 
$str^^ "
;^^" #
idp__ 
=__ 
$str__  
;__  !
break`` 
;`` 
caseaa 
$straa 
:aa  
usernamebb 
=bb 
$strbb )
;bb) *
rolescc 
=cc 
newcc 
Listcc  
<cc  !
stringcc! '
>cc' (
{cc) *
$strcc+ 1
}cc2 3
;cc3 4
permissionsdd 
=dd 
newdd !
Listdd" &
<dd& '
stringdd' -
>dd- .
{dd/ 0
$strdd1 =
,dd= >
$strdd? L
}ddM N
;ddN O
	authLevelee 
=ee 
$stree "
;ee" #
idpff 
=ff 
$strff 
;ff 
breakgg 
;gg 
casehh 
$strhh 
:hh  
usernameii 
=ii 
$strii )
;ii) *
rolesjj 
=jj 
newjj 
Listjj  
<jj  !
stringjj! '
>jj' (
{jj) *
$strjj+ 1
}jj2 3
;jj3 4
permissionskk 
=kk 
newkk !
Listkk" &
<kk& '
stringkk' -
>kk- .
{kk/ 0
$strkk1 =
}kk> ?
;kk? @
	authLevelll 
=ll 
$strll "
;ll" #
idpmm 
=mm 
$strmm 
;mm 
breaknn 
;nn 
caseoo 
$stroo 
:oo 
usernamepp 
=pp 
$strpp &
;pp& '
rolesqq 
=qq 
newqq 
Listqq  
<qq  !
stringqq! '
>qq' (
{qq) *
$strqq+ 1
}qq2 3
;qq3 4
permissionsrr 
=rr 
newrr !
Listrr" &
<rr& '
stringrr' -
>rr- .
{rr/ 0
$strrr1 =
}rr> ?
;rr? @
	authLevelss 
=ss 
$strss "
;ss" #
idptt 
=tt 
$strtt 
;tt 
breakuu 
;uu 
casevv 
$strvv 
:vv 
usernameww 
=ww 
$strww &
;ww& '
rolesxx 
=xx 
newxx 
Listxx  
<xx  !
stringxx! '
>xx' (
{xx) *
$strxx+ 1
}xx2 3
;xx3 4
permissionsyy 
=yy 
newyy !
Listyy" &
<yy& '
stringyy' -
>yy- .
{yy/ 0
$stryy1 =
,yy= >
$stryy? L
}yyM N
;yyN O
	authLevelzz 
=zz 
$strzz "
;zz" #
idp{{ 
={{ 
$str{{  
;{{  !
break|| 
;|| 
case}} 
$str}} 
:}} 
username~~ 
=~~ 
$str~~ &
;~~& '
roles 
= 
new 
List  
<  !
string! '
>' (
{) *
$str+ 2
}3 4
;4 5
permissions
ÄÄ 
=
ÄÄ 
new
ÄÄ !
List
ÄÄ" &
<
ÄÄ& '
string
ÄÄ' -
>
ÄÄ- .
{
ÄÄ/ 0
$str
ÄÄ1 =
,
ÄÄ= >
$str
ÄÄ? L
,
ÄÄL M
$str
ÄÄN \
,
ÄÄ\ ]
$str
ÄÄ^ k
}
ÄÄl m
;
ÄÄm n
	authLevel
ÅÅ 
=
ÅÅ 
$str
ÅÅ "
;
ÅÅ" #
idp
ÇÇ 
=
ÇÇ 
$str
ÇÇ '
;
ÇÇ' (
break
ÉÉ 
;
ÉÉ 
default
ÑÑ 
:
ÑÑ 
return
ÖÖ 

BadRequest
ÖÖ !
(
ÖÖ! "
new
ÖÖ" %
{
ÖÖ& '
error
ÖÖ( -
=
ÖÖ. /
$str
ÖÖ0 D
}
ÖÖE F
)
ÖÖF G
;
ÖÖG H
}
ÜÜ 	
var
àà 
token
àà 
=
àà 
_jwtService
àà 
.
àà  
GenerateToken
àà  -
(
àà- .
username
àà. 6
,
àà6 7
roles
àà8 =
,
àà= >
permissions
àà? J
,
ààJ K
	authLevel
ààL U
,
ààU V
idp
ààW Z
)
ààZ [
;
àà[ \
var
ää 
response
ää 
=
ää 
new
ää 
{
ãã 	
token
åå 
,
åå 
username
çç 
,
çç 
roles
éé 
,
éé 
permissions
èè 
,
èè 

auth_level
êê 
=
êê 
	authLevel
êê "
,
êê" #
idp
ëë 
,
ëë 
type
íí 
,
íí 
	expiresIn
ìì 
=
ìì 
$str
ìì "
,
ìì" #
	timestamp
îî 
=
îî 
DateTimeOffset
îî &
.
îî& '
UtcNow
îî' -
.
îî- .$
ToUnixTimeMilliseconds
îî. D
(
îîD E
)
îîE F
}
ïï 	
;
ïï	 

return
óó 
Ok
óó 
(
óó 
response
óó 
)
óó 
;
óó 
}
òò 
[
ùù 
HttpPost
ùù 
(
ùù 
$str
ùù 
)
ùù 
]
ùù 
[
ûû "
ProducesResponseType
ûû 
(
ûû 
typeof
ûû  
(
ûû  !
object
ûû! '
)
ûû' (
,
ûû( )
$num
ûû* -
)
ûû- .
]
ûû. /
public
üü 

IActionResult
üü 
ValidateToken
üü &
(
üü& '
[
üü' (
Required
üü( 0
]
üü0 1
string
üü2 8
token
üü9 >
)
üü> ?
{
†† 
var
°° 
isValid
°° 
=
°° 
_jwtService
°° !
.
°°! "
ValidateToken
°°" /
(
°°/ 0
token
°°0 5
)
°°5 6
;
°°6 7
if
££ 

(
££ 
isValid
££ 
)
££ 
{
§§ 	
var
•• 
response
•• 
=
•• 
new
•• 
{
¶¶ 
valid
ßß 
=
ßß 
isValid
ßß 
,
ßß  
username
®® 
=
®® 
_jwtService
®® &
.
®®& '
ExtractUsername
®®' 6
(
®®6 7
token
®®7 <
)
®®< =
,
®®= >
roles
©© 
=
©© 
_jwtService
©© #
.
©©# $
ExtractRoles
©©$ 0
(
©©0 1
token
©©1 6
)
©©6 7
,
©©7 8
permissions
™™ 
=
™™ 
_jwtService
™™ )
.
™™) * 
ExtractPermissions
™™* <
(
™™< =
token
™™= B
)
™™B C
,
™™C D

auth_level
´´ 
=
´´ 
_jwtService
´´ (
.
´´( )
ExtractAuthLevel
´´) 9
(
´´9 :
token
´´: ?
)
´´? @
,
´´@ A
idp
¨¨ 
=
¨¨ 
_jwtService
¨¨ !
.
¨¨! "%
ExtractIdentityProvider
¨¨" 9
(
¨¨9 :
token
¨¨: ?
)
¨¨? @
,
¨¨@ A
	timestamp
≠≠ 
=
≠≠ 
DateTimeOffset
≠≠ *
.
≠≠* +
UtcNow
≠≠+ 1
.
≠≠1 2$
ToUnixTimeMilliseconds
≠≠2 H
(
≠≠H I
)
≠≠I J
}
ÆÆ 
;
ÆÆ 
return
ØØ 
Ok
ØØ 
(
ØØ 
response
ØØ 
)
ØØ 
;
ØØ  
}
∞∞ 	
else
±± 
{
≤≤ 	
var
≥≥ 
response
≥≥ 
=
≥≥ 
new
≥≥ 
{
¥¥ 
valid
µµ 
=
µµ 
isValid
µµ 
,
µµ  
	timestamp
∂∂ 
=
∂∂ 
DateTimeOffset
∂∂ *
.
∂∂* +
UtcNow
∂∂+ 1
.
∂∂1 2$
ToUnixTimeMilliseconds
∂∂2 H
(
∂∂H I
)
∂∂I J
}
∑∑ 
;
∑∑ 
return
∏∏ 
Ok
∏∏ 
(
∏∏ 
response
∏∏ 
)
∏∏ 
;
∏∏  
}
ππ 	
}
∫∫ 
}ªª Ç(
[/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Controllers/MetricsController.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Controllers *
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public		 

class		 
MetricsController		 "
:		# $
ControllerBase		% 3
{

 
private 
static 
readonly 
Meter  %
_meter& ,
=- .
new/ 2
(2 3
$str3 Q
,Q R
$strS Z
)Z [
;[ \
private 
static 
readonly 
Counter  '
<' (
long( ,
>, -
_requestCounter. =
=> ?
_meter@ F
.F G
CreateCounterG T
<T U
longU Y
>Y Z
(Z [
$str[ r
,r s
$str	t ï
)
ï ñ
;
ñ ó
private 
static 
readonly 
	Histogram  )
<) *
double* 0
>0 1
_responseTime2 ?
=@ A
_meterB H
.H I
CreateHistogramI X
<X Y
doubleY _
>_ `
(` a
$stra w
,w x
$str	y è
)
è ê
;
ê ë
private 
static 
readonly 
Random  &
_random' .
=/ 0
new1 4
(4 5
)5 6
;6 7
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
string  
>  !
TestMetrics" -
(- .
). /
{ 	
_requestCounter 
. 
Add 
(  
$num  !
)! "
;" #
using 
var 
activity 
=  
new! $
Activity% -
(- .
$str. @
)@ A
;A B
activity 
. 
Start 
( 
) 
; 
try 
{ 
await 
Task 
. 
Delay  
(  !
_random! (
.( )
Next) -
(- .
$num. 0
,0 1
$num2 5
)5 6
)6 7
;7 8
return 
$str /
;/ 0
} 
finally 
{ 
activity   
.   
Stop   
(   
)   
;    
_responseTime!! 
.!! 
Record!! $
(!!$ %
activity!!% -
.!!- .
Duration!!. 6
.!!6 7
TotalMilliseconds!!7 H
)!!H I
;!!I J
}"" 
}## 	
[%% 	
HttpGet%%	 
(%% 
$str%% 
)%% 
]%% 
public&& 
string&& 
IncrementCounter&& &
(&&& '
[&&' (
	FromQuery&&( 1
]&&1 2
int&&3 6
value&&7 <
=&&= >
$num&&? @
)&&@ A
{'' 	
_requestCounter(( 
.(( 
Add(( 
(((  
value((  %
)((% &
;((& '
return)) 
$")) 
$str)) ,
{)), -
value))- 2
}))2 3
"))3 4
;))4 5
}** 	
[,, 	
HttpGet,,	 
(,, 
$str,, 
),, 
],, 
public-- 
async-- 
Task-- 
<-- 
string--  
>--  !
SlowEndpoint--" .
(--. /
)--/ 0
{.. 	
_requestCounter// 
.// 
Add// 
(//  
$num//  !
)//! "
;//" #
using11 
var11 
activity11 
=11  
new11! $
Activity11% -
(11- .
$str11. >
)11> ?
;11? @
activity22 
.22 
Start22 
(22 
)22 
;22 
try44 
{55 
await77 
Task77 
.77 
Delay77  
(77  !
_random77! (
.77( )
Next77) -
(77- .
$num77. 1
,771 2
$num773 7
)777 8
)778 9
;779 :
return88 
$str88 1
;881 2
}99 
finally:: 
{;; 
activity<< 
.<< 
Stop<< 
(<< 
)<< 
;<<  
_responseTime== 
.== 
Record== $
(==$ %
activity==% -
.==- .
Duration==. 6
.==6 7
TotalMilliseconds==7 H
)==H I
;==I J
}>> 
}?? 	
}@@ 
}AA Ø≤
d/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Controllers/EnhancedAuthTestController.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Controllers *
;* +
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
[ 
Tags 
( 
$str #
)# $
]$ %
public 
class &
EnhancedAuthTestController '
:( )
ControllerBase* 8
{ 
private 
readonly 
ILogger 
< &
EnhancedAuthTestController 7
>7 8
_logger9 @
;@ A
public 
&
EnhancedAuthTestController %
(% &
ILogger& -
<- .&
EnhancedAuthTestController. H
>H I
loggerJ P
)P Q
{ 
_logger 
= 
logger 
; 
} 
[ 
HttpGet 
( 
$str 
) 
] 
[ 
AllowAnonymous 
] 
[  
ProducesResponseType 
( 
typeof  
(  !
object! '
)' (
,( )
$num* -
)- .
]. /
public 

IActionResult 
PublicEndpoint '
(' (
)( )
{ 
var 
response 
= 
new 
{   	
message!! 
=!! 
$str!! ;
,!!; <
level"" 
="" 
$num"" 
,"" 
	timestamp## 
=## 
DateTimeOffset## &
.##& '
UtcNow##' -
.##- ."
ToUnixTimeMilliseconds##. D
(##D E
)##E F
}$$ 	
;$$	 

return%% 
Ok%% 
(%% 
response%% 
)%% 
;%% 
}&& 
[++ 
HttpGet++ 
(++ 
$str++ 
)++ 
]++ 
[,, 
	Authorize,, 
],, 
[--  
ProducesResponseType-- 
(-- 
typeof--  
(--  !
object--! '
)--' (
,--( )
$num--* -
)--- .
]--. /
[..  
ProducesResponseType.. 
(.. 
$num.. 
).. 
].. 
public// 

IActionResult// !
AuthenticatedEndpoint// .
(//. /
)/// 0
{00 
var11 
username11 
=11 
User11 
.11 
Identity11 $
?11$ %
.11% &
Name11& *
??11+ -
$str11. 7
;117 8
var22 
response22 
=22 
new22 
{33 	
message44 
=44 
$str44 C
,44C D
level55 
=55 
$num55 
,55 
username66 
,66 
	timestamp77 
=77 
DateTimeOffset77 &
.77& '
UtcNow77' -
.77- ."
ToUnixTimeMilliseconds77. D
(77D E
)77E F
}88 	
;88	 

return99 
Ok99 
(99 
response99 
)99 
;99 
}:: 
[?? 
HttpGet?? 
(?? 
$str?? 
)?? 
]?? 
[@@ 
	Authorize@@ 
(@@ 
Roles@@ 
=@@ 
$str@@ 
)@@ 
]@@ 
[AA  
ProducesResponseTypeAA 
(AA 
typeofAA  
(AA  !
objectAA! '
)AA' (
,AA( )
$numAA* -
)AA- .
]AA. /
[BB  
ProducesResponseTypeBB 
(BB 
$numBB 
)BB 
]BB 
[CC  
ProducesResponseTypeCC 
(CC 
$numCC 
)CC 
]CC 
publicDD 

IActionResultDD 
RoleBasedEndpointDD *
(DD* +
)DD+ ,
{EE 
varFF 
usernameFF 
=FF 
UserFF 
.FF 
IdentityFF $
?FF$ %
.FF% &
NameFF& *
??FF+ -
$strFF. 7
;FF7 8
varGG 
rolesGG 
=GG 
UserGG 
.GG 
ClaimsGG 
.HH 
WhereHH 
(HH 
cHH 
=>HH 
cHH 
.HH 
TypeHH 
==HH !

ClaimTypesHH" ,
.HH, -
RoleHH- 1
)HH1 2
.II 
SelectII 
(II 
cII 
=>II 
cII 
.II 
ValueII  
)II  !
.JJ 
ToListJJ 
(JJ 
)JJ 
;JJ 
varLL 
responseLL 
=LL 
newLL 
{MM 	
messageNN 
=NN 
$strNN ?
,NN? @
levelOO 
=OO 
$numOO 
,OO 
usernamePP 
,PP 
rolesQQ 
,QQ 
	timestampRR 
=RR 
DateTimeOffsetRR &
.RR& '
UtcNowRR' -
.RR- ."
ToUnixTimeMillisecondsRR. D
(RRD E
)RRE F
}SS 	
;SS	 

returnTT 
OkTT 
(TT 
responseTT 
)TT 
;TT 
}UU 
[ZZ 
HttpGetZZ 
(ZZ 
$strZZ 
)ZZ 
]ZZ 
[[[ 
	Authorize[[ 
([[ 
Roles[[ 
=[[ 
$str[[ 
)[[ 
][[  
[\\  
ProducesResponseType\\ 
(\\ 
typeof\\  
(\\  !
object\\! '
)\\' (
,\\( )
$num\\* -
)\\- .
]\\. /
[]]  
ProducesResponseType]] 
(]] 
$num]] 
)]] 
]]] 
[^^  
ProducesResponseType^^ 
(^^ 
$num^^ 
)^^ 
]^^ 
public__ 

IActionResult__ 
AdminOnlyEndpoint__ *
(__* +
)__+ ,
{`` 
varaa 
usernameaa 
=aa 
Useraa 
.aa 
Identityaa $
?aa$ %
.aa% &
Nameaa& *
??aa+ -
$straa. 7
;aa7 8
varbb 
responsebb 
=bb 
newbb 
{cc 	
messagedd 
=dd 
$strdd @
,dd@ A
levelee 
=ee 
$numee 
,ee 
usernameff 
,ff 
	timestampgg 
=gg 
DateTimeOffsetgg &
.gg& '
UtcNowgg' -
.gg- ."
ToUnixTimeMillisecondsgg. D
(ggD E
)ggE F
}hh 	
;hh	 

returnii 
Okii 
(ii 
responseii 
)ii 
;ii 
}jj 
[oo 
HttpGetoo 
(oo 
$stroo 
)oo  
]oo  !
[pp 
	Authorizepp 
(pp 
Policypp 
=pp 
$strpp 4
)pp4 5
]pp5 6
[qq  
ProducesResponseTypeqq 
(qq 
typeofqq  
(qq  !
objectqq! '
)qq' (
,qq( )
$numqq* -
)qq- .
]qq. /
[rr  
ProducesResponseTyperr 
(rr 
$numrr 
)rr 
]rr 
[ss  
ProducesResponseTypess 
(ss 
$numss 
)ss 
]ss 
publictt 

IActionResulttt #
PermissionBasedEndpointtt 0
(tt0 1
)tt1 2
{uu 
varvv 
usernamevv 
=vv 
Uservv 
.vv 
Identityvv $
?vv$ %
.vv% &
Namevv& *
??vv+ -
$strvv. 7
;vv7 8
varww 
permissionsww 
=ww 
Userww 
.ww 
Claimsww %
.xx 
Wherexx 
(xx 
cxx 
=>xx 
cxx 
.xx 
Typexx 
==xx !
$strxx" .
)xx. /
.yy 
Selectyy 
(yy 
cyy 
=>yy 
cyy 
.yy 
Valueyy  
)yy  !
.zz 
ToListzz 
(zz 
)zz 
;zz 
var|| 
response|| 
=|| 
new|| 
{}} 	
message~~ 
=~~ 
$str~~ E
,~~E F
level 
= 
$num 
, 
username
ÄÄ 
,
ÄÄ 
permissions
ÅÅ 
,
ÅÅ 
	timestamp
ÇÇ 
=
ÇÇ 
DateTimeOffset
ÇÇ &
.
ÇÇ& '
UtcNow
ÇÇ' -
.
ÇÇ- .$
ToUnixTimeMilliseconds
ÇÇ. D
(
ÇÇD E
)
ÇÇE F
}
ÉÉ 	
;
ÉÉ	 

return
ÑÑ 
Ok
ÑÑ 
(
ÑÑ 
response
ÑÑ 
)
ÑÑ 
;
ÑÑ 
}
ÖÖ 
[
ää 
HttpGet
ää 
(
ää 
$str
ää 
)
ää 
]
ää 
[
ãã 
	Authorize
ãã 
(
ãã 
Policy
ãã 
=
ãã 
$str
ãã -
)
ãã- .
]
ãã. /
[
åå "
ProducesResponseType
åå 
(
åå 
typeof
åå  
(
åå  !
object
åå! '
)
åå' (
,
åå( )
$num
åå* -
)
åå- .
]
åå. /
[
çç "
ProducesResponseType
çç 
(
çç 
$num
çç 
)
çç 
]
çç 
[
éé "
ProducesResponseType
éé 
(
éé 
$num
éé 
)
éé 
]
éé 
public
èè 

IActionResult
èè "
Aal2RequiredEndpoint
èè -
(
èè- .
)
èè. /
{
êê 
var
ëë 
username
ëë 
=
ëë 
User
ëë 
.
ëë 
Identity
ëë $
?
ëë$ %
.
ëë% &
Name
ëë& *
??
ëë+ -
$str
ëë. 7
;
ëë7 8
var
íí 

authLevels
íí 
=
íí 
User
íí 
.
íí 
Claims
íí $
.
ìì 
Where
ìì 
(
ìì 
c
ìì 
=>
ìì 
c
ìì 
.
ìì 
Type
ìì 
==
ìì !
$str
ìì" .
)
ìì. /
.
îî 
Select
îî 
(
îî 
c
îî 
=>
îî 
c
îî 
.
îî 
Value
îî  
)
îî  !
.
ïï 
ToList
ïï 
(
ïï 
)
ïï 
;
ïï 
var
óó 
response
óó 
=
óó 
new
óó 
{
òò 	
message
ôô 
=
ôô 
$str
ôô ;
,
ôô; <
level
öö 
=
öö 
$num
öö 
,
öö 
username
õõ 
,
õõ 

authLevels
úú 
,
úú 
	timestamp
ùù 
=
ùù 
DateTimeOffset
ùù &
.
ùù& '
UtcNow
ùù' -
.
ùù- .$
ToUnixTimeMilliseconds
ùù. D
(
ùùD E
)
ùùE F
}
ûû 	
;
ûû	 

return
üü 
Ok
üü 
(
üü 
response
üü 
)
üü 
;
üü 
}
†† 
[
•• 
HttpGet
•• 
(
•• 
$str
•• 
)
•• 
]
••  
[
¶¶ 
	Authorize
¶¶ 
(
¶¶ 
Policy
¶¶ 
=
¶¶ 
$str
¶¶ .
)
¶¶. /
]
¶¶/ 0
[
ßß "
ProducesResponseType
ßß 
(
ßß 
typeof
ßß  
(
ßß  !
object
ßß! '
)
ßß' (
,
ßß( )
$num
ßß* -
)
ßß- .
]
ßß. /
[
®® "
ProducesResponseType
®® 
(
®® 
$num
®® 
)
®® 
]
®® 
[
©© "
ProducesResponseType
©© 
(
©© 
$num
©© 
)
©© 
]
©© 
public
™™ 

IActionResult
™™ $
EnterpriseOnlyEndpoint
™™ /
(
™™/ 0
)
™™0 1
{
´´ 
var
¨¨ 
username
¨¨ 
=
¨¨ 
User
¨¨ 
.
¨¨ 
Identity
¨¨ $
?
¨¨$ %
.
¨¨% &
Name
¨¨& *
??
¨¨+ -
$str
¨¨. 7
;
¨¨7 8
var
≠≠ 
idps
≠≠ 
=
≠≠ 
User
≠≠ 
.
≠≠ 
Claims
≠≠ 
.
ÆÆ 
Where
ÆÆ 
(
ÆÆ 
c
ÆÆ 
=>
ÆÆ 
c
ÆÆ 
.
ÆÆ 
Type
ÆÆ 
==
ÆÆ !
$str
ÆÆ" '
)
ÆÆ' (
.
ØØ 
Select
ØØ 
(
ØØ 
c
ØØ 
=>
ØØ 
c
ØØ 
.
ØØ 
Value
ØØ  
)
ØØ  !
.
∞∞ 
ToList
∞∞ 
(
∞∞ 
)
∞∞ 
;
∞∞ 
var
≤≤ 
response
≤≤ 
=
≤≤ 
new
≤≤ 
{
≥≥ 	
message
¥¥ 
=
¥¥ 
$str
¥¥ E
,
¥¥E F
level
µµ 
=
µµ 
$num
µµ 
,
µµ 
username
∂∂ 
,
∂∂ 
identityProviders
∑∑ 
=
∑∑ 
idps
∑∑  $
,
∑∑$ %
	timestamp
∏∏ 
=
∏∏ 
DateTimeOffset
∏∏ &
.
∏∏& '
UtcNow
∏∏' -
.
∏∏- .$
ToUnixTimeMilliseconds
∏∏. D
(
∏∏D E
)
∏∏E F
}
ππ 	
;
ππ	 

return
∫∫ 
Ok
∫∫ 
(
∫∫ 
response
∫∫ 
)
∫∫ 
;
∫∫ 
}
ªª 
[
¿¿ 
HttpGet
¿¿ 
(
¿¿ 
$str
¿¿ 
)
¿¿ 
]
¿¿ 
[
¡¡ 
	Authorize
¡¡ 
(
¡¡ 
Policy
¡¡ 
=
¡¡ 
$str
¡¡ 0
)
¡¡0 1
]
¡¡1 2
[
¬¬ "
ProducesResponseType
¬¬ 
(
¬¬ 
typeof
¬¬  
(
¬¬  !
object
¬¬! '
)
¬¬' (
,
¬¬( )
$num
¬¬* -
)
¬¬- .
]
¬¬. /
[
√√ "
ProducesResponseType
√√ 
(
√√ 
$num
√√ 
)
√√ 
]
√√ 
[
ƒƒ "
ProducesResponseType
ƒƒ 
(
ƒƒ 
$num
ƒƒ 
)
ƒƒ 
]
ƒƒ 
public
≈≈ 

IActionResult
≈≈ !
MultiFactorEndpoint
≈≈ ,
(
≈≈, -
)
≈≈- .
{
∆∆ 
var
«« 
username
«« 
=
«« 
User
«« 
.
«« 
Identity
«« $
?
««$ %
.
««% &
Name
««& *
??
««+ -
$str
««. 7
;
««7 8
var
»» 
roles
»» 
=
»» 
User
»» 
.
»» 
Claims
»» 
.
…… 
Where
…… 
(
…… 
c
…… 
=>
…… 
c
…… 
.
…… 
Type
…… 
==
…… !

ClaimTypes
……" ,
.
……, -
Role
……- 1
)
……1 2
.
   
Select
   
(
   
c
   
=>
   
c
   
.
   
Value
    
)
    !
.
ÀÀ 
ToList
ÀÀ 
(
ÀÀ 
)
ÀÀ 
;
ÀÀ 
var
ÕÕ 
permissions
ÕÕ 
=
ÕÕ 
User
ÕÕ 
.
ÕÕ 
Claims
ÕÕ %
.
ŒŒ 
Where
ŒŒ 
(
ŒŒ 
c
ŒŒ 
=>
ŒŒ 
c
ŒŒ 
.
ŒŒ 
Type
ŒŒ 
==
ŒŒ !
$str
ŒŒ" .
)
ŒŒ. /
.
œœ 
Select
œœ 
(
œœ 
c
œœ 
=>
œœ 
c
œœ 
.
œœ 
Value
œœ  
)
œœ  !
.
–– 
ToList
–– 
(
–– 
)
–– 
;
–– 
var
““ 

authLevels
““ 
=
““ 
User
““ 
.
““ 
Claims
““ $
.
”” 
Where
”” 
(
”” 
c
”” 
=>
”” 
c
”” 
.
”” 
Type
”” 
==
”” !
$str
””" .
)
””. /
.
‘‘ 
Select
‘‘ 
(
‘‘ 
c
‘‘ 
=>
‘‘ 
c
‘‘ 
.
‘‘ 
Value
‘‘  
)
‘‘  !
.
’’ 
ToList
’’ 
(
’’ 
)
’’ 
;
’’ 
var
◊◊ 
idps
◊◊ 
=
◊◊ 
User
◊◊ 
.
◊◊ 
Claims
◊◊ 
.
ÿÿ 
Where
ÿÿ 
(
ÿÿ 
c
ÿÿ 
=>
ÿÿ 
c
ÿÿ 
.
ÿÿ 
Type
ÿÿ 
==
ÿÿ !
$str
ÿÿ" '
)
ÿÿ' (
.
ŸŸ 
Select
ŸŸ 
(
ŸŸ 
c
ŸŸ 
=>
ŸŸ 
c
ŸŸ 
.
ŸŸ 
Value
ŸŸ  
)
ŸŸ  !
.
⁄⁄ 
ToList
⁄⁄ 
(
⁄⁄ 
)
⁄⁄ 
;
⁄⁄ 
var
‹‹ 
response
‹‹ 
=
‹‹ 
new
‹‹ 
{
›› 	
message
ﬁﬁ 
=
ﬁﬁ 
$str
ﬁﬁ A
,
ﬁﬁA B
level
ﬂﬂ 
=
ﬂﬂ 
$num
ﬂﬂ 
,
ﬂﬂ 
username
‡‡ 
,
‡‡ 
roles
·· 
,
·· 
permissions
‚‚ 
,
‚‚ 

authLevels
„„ 
,
„„ 
identityProviders
‰‰ 
=
‰‰ 
idps
‰‰  $
,
‰‰$ %
	timestamp
ÂÂ 
=
ÂÂ 
DateTimeOffset
ÂÂ &
.
ÂÂ& '
UtcNow
ÂÂ' -
.
ÂÂ- .$
ToUnixTimeMilliseconds
ÂÂ. D
(
ÂÂD E
)
ÂÂE F
}
ÊÊ 	
;
ÊÊ	 

return
ÁÁ 
Ok
ÁÁ 
(
ÁÁ 
response
ÁÁ 
)
ÁÁ 
;
ÁÁ 
}
ËË 
[
ÌÌ 
HttpGet
ÌÌ 
(
ÌÌ 
$str
ÌÌ 
)
ÌÌ 
]
ÌÌ 
[
ÓÓ 
	Authorize
ÓÓ 
]
ÓÓ 
[
ÔÔ "
ProducesResponseType
ÔÔ 
(
ÔÔ 
typeof
ÔÔ  
(
ÔÔ  !
object
ÔÔ! '
)
ÔÔ' (
,
ÔÔ( )
$num
ÔÔ* -
)
ÔÔ- .
]
ÔÔ. /
[
 "
ProducesResponseType
 
(
 
$num
 
)
 
]
 
public
ÒÒ 

IActionResult
ÒÒ %
GetAuthorizationContext
ÒÒ 0
(
ÒÒ0 1
)
ÒÒ1 2
{
ÚÚ 
var
ÛÛ 
username
ÛÛ 
=
ÛÛ 
User
ÛÛ 
.
ÛÛ 
Identity
ÛÛ $
?
ÛÛ$ %
.
ÛÛ% &
Name
ÛÛ& *
??
ÛÛ+ -
$str
ÛÛ. 7
;
ÛÛ7 8
var
ÙÙ 
roles
ÙÙ 
=
ÙÙ 
User
ÙÙ 
.
ÙÙ 
Claims
ÙÙ 
.
ıı 
Where
ıı 
(
ıı 
c
ıı 
=>
ıı 
c
ıı 
.
ıı 
Type
ıı 
==
ıı !

ClaimTypes
ıı" ,
.
ıı, -
Role
ıı- 1
)
ıı1 2
.
ˆˆ 
Select
ˆˆ 
(
ˆˆ 
c
ˆˆ 
=>
ˆˆ 
c
ˆˆ 
.
ˆˆ 
Value
ˆˆ  
)
ˆˆ  !
.
˜˜ 
ToList
˜˜ 
(
˜˜ 
)
˜˜ 
;
˜˜ 
var
˘˘ 
permissions
˘˘ 
=
˘˘ 
User
˘˘ 
.
˘˘ 
Claims
˘˘ %
.
˙˙ 
Where
˙˙ 
(
˙˙ 
c
˙˙ 
=>
˙˙ 
c
˙˙ 
.
˙˙ 
Type
˙˙ 
==
˙˙ !
$str
˙˙" .
)
˙˙. /
.
˚˚ 
Select
˚˚ 
(
˚˚ 
c
˚˚ 
=>
˚˚ 
c
˚˚ 
.
˚˚ 
Value
˚˚  
)
˚˚  !
.
¸¸ 
ToList
¸¸ 
(
¸¸ 
)
¸¸ 
;
¸¸ 
var
˛˛ 

authLevels
˛˛ 
=
˛˛ 
User
˛˛ 
.
˛˛ 
Claims
˛˛ $
.
ˇˇ 
Where
ˇˇ 
(
ˇˇ 
c
ˇˇ 
=>
ˇˇ 
c
ˇˇ 
.
ˇˇ 
Type
ˇˇ 
==
ˇˇ !
$str
ˇˇ" .
)
ˇˇ. /
.
ÄÄ 
Select
ÄÄ 
(
ÄÄ 
c
ÄÄ 
=>
ÄÄ 
c
ÄÄ 
.
ÄÄ 
Value
ÄÄ  
)
ÄÄ  !
.
ÅÅ 
ToList
ÅÅ 
(
ÅÅ 
)
ÅÅ 
;
ÅÅ 
var
ÉÉ 
idps
ÉÉ 
=
ÉÉ 
User
ÉÉ 
.
ÉÉ 
Claims
ÉÉ 
.
ÑÑ 
Where
ÑÑ 
(
ÑÑ 
c
ÑÑ 
=>
ÑÑ 
c
ÑÑ 
.
ÑÑ 
Type
ÑÑ 
==
ÑÑ !
$str
ÑÑ" '
)
ÑÑ' (
.
ÖÖ 
Select
ÖÖ 
(
ÖÖ 
c
ÖÖ 
=>
ÖÖ 
c
ÖÖ 
.
ÖÖ 
Value
ÖÖ  
)
ÖÖ  !
.
ÜÜ 
ToList
ÜÜ 
(
ÜÜ 
)
ÜÜ 
;
ÜÜ 
var
àà 
	allClaims
àà 
=
àà 
User
àà 
.
àà 
Claims
àà #
.
ââ 
ToDictionary
ââ 
(
ââ 
c
ââ 
=>
ââ 
c
ââ  
.
ââ  !
Type
ââ! %
,
ââ% &
c
ââ' (
=>
ââ) +
c
ââ, -
.
ââ- .
Value
ââ. 3
)
ââ3 4
;
ââ4 5
var
ãã 
response
ãã 
=
ãã 
new
ãã 
{
åå 	
username
çç 
,
çç 
roles
éé 
,
éé 
permissions
èè 
,
èè 

authLevels
êê 
,
êê 
identityProviders
ëë 
=
ëë 
idps
ëë  $
,
ëë$ %
	allClaims
íí 
,
íí 
	timestamp
ìì 
=
ìì 
DateTimeOffset
ìì &
.
ìì& '
UtcNow
ìì' -
.
ìì- .$
ToUnixTimeMilliseconds
ìì. D
(
ììD E
)
ììE F
}
îî 	
;
îî	 

return
ññ 
Ok
ññ 
(
ññ 
response
ññ 
)
ññ 
;
ññ 
}
óó 
}òò ë,
_/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Controllers/ApplicationController.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Controllers *
;* +
[ 
ApiController 
] 
[ 
Route 
( 
$str 	
)	 

]
 
[		 
Tags		 
(		 
$str		 
)		 
]		 
public

 
class

 !
ApplicationController

 "
:

# $
ControllerBase

% 3
{ 
private 
readonly 
ILogger 
< !
ApplicationController 2
>2 3
_logger4 ;
;; <
public 
!
ApplicationController  
(  !
ILogger! (
<( )!
ApplicationController) >
>> ?
logger@ F
)F G
{ 
_logger 
= 
logger 
; 
} 
[ 
HttpGet 
] 
public 

IActionResult 
Home 
( 
) 
{ 
var 
	jwsHeader 
= 
Convert 
.  
ToBase64String  .
(. /
Encoding/ 7
.7 8
UTF88 <
.< =
GetBytes= E
(E F
$strF ]
)] ^
)^ _
;_ `
_logger 
. 
LogInformation 
( 
$str B
,B C
	jwsHeaderD M
)M N
;N O
foreach 
( 
var 
header 
in 
Request &
.& '
Headers' .
). /
{ 	
_logger   
.   
LogInformation   "
(  " #
$str  # =
,  = >
header  ? E
.  E F
Key  F I
,  I J
header  K Q
.  Q R
Value  R W
)  W X
;  X Y
}!! 	
return## 
Ok## 
(## 
$str## ,
)##, -
;##- .
}$$ 
[)) 
HttpGet)) 
()) 
$str)) -
)))- .
])). /
[** 
	Authorize** 
(** 
Policy** 
=** 
$str** ;
)**; <
]**< =
[++  
ProducesResponseType++ 
(++ 
typeof++  
(++  !
string++! '
)++' (
,++( )
$num++* -
)++- .
]++. /
[,,  
ProducesResponseType,, 
(,, 
$num,, 
),, 
],, 
[--  
ProducesResponseType-- 
(-- 
$num-- 
)-- 
]-- 
public.. 

IActionResult.. 
	GetObject.. "
(.." #
[..# $
	FromQuery..$ -
]..- .
string../ 5
id..6 8
)..8 9
{// 
_logger00 
.00 
LogInformation00 
(00 
$str00 1
,001 2
id003 5
)005 6
;006 7
return11 
Ok11 
(11 
$str11 
)11 
;11 
}22 
[77 
HttpPut77 
(77 
$str77 -
)77- .
]77. /
[88 
	Authorize88 
(88 
Policy88 
=88 
$str88 <
)88< =
]88= >
[99  
ProducesResponseType99 
(99 
typeof99  
(99  !
string99! '
)99' (
,99( )
$num99* -
)99- .
]99. /
[::  
ProducesResponseType:: 
(:: 
$num:: 
):: 
]:: 
[;;  
ProducesResponseType;; 
(;; 
$num;; 
);; 
];; 
public<< 

IActionResult<< 
	PutObject<< "
(<<" #
[<<# $
	FromQuery<<$ -
]<<- .
string<</ 5
id<<6 8
)<<8 9
{== 
_logger>> 
.>> 
LogInformation>> 
(>> 
$str>> 1
,>>1 2
id>>3 5
)>>5 6
;>>6 7
return?? 
Ok?? 
(?? 
$str?? 
)?? 
;?? 
}@@ 
[EE 

HttpDeleteEE 
(EE 
$strEE 3
)EE3 4
]EE4 5
[FF 
	AuthorizeFF 
(FF 
PolicyFF 
=FF 
$strFF =
)FF= >
]FF> ?
[GG  
ProducesResponseTypeGG 
(GG 
typeofGG  
(GG  !
stringGG! '
)GG' (
,GG( )
$numGG* -
)GG- .
]GG. /
[HH  
ProducesResponseTypeHH 
(HH 
$numHH 
)HH 
]HH 
[II  
ProducesResponseTypeII 
(II 
$numII 
)II 
]II 
publicJJ 

IActionResultJJ 
DeleteObjectJJ %
(JJ% &
[JJ& '
	FromQueryJJ' 0
]JJ0 1
stringJJ2 8
idJJ9 ;
)JJ; <
{KK 
_loggerLL 
.LL 
LogInformationLL 
(LL 
$strLL 4
,LL4 5
idLL6 8
)LL8 9
;LL9 :
returnMM 
OkMM 
(MM 
$strMM 
)MM 
;MM 
}NN 
}OO Æ
a/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Authorization/PermissionRequirement.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Authorization ,
;, -
public 
class !
PermissionRequirement "
:# $%
IAuthorizationRequirement% >
{		 
public

 

string

 

Permission

 
{

 
get

 "
;

" #
}

$ %
public 
!
PermissionRequirement  
(  !
string! '

permission( 2
)2 3
{ 

Permission 
= 

permission 
;  
} 
} 
public 
class $
AnyPermissionRequirement %
:& '%
IAuthorizationRequirement( A
{ 
public 

string 
[ 
] 
Permissions 
{  !
get" %
;% &
}' (
public 
$
AnyPermissionRequirement #
(# $
params$ *
string+ 1
[1 2
]2 3
permissions4 ?
)? @
{ 
Permissions 
= 
permissions !
;! "
} 
} 
public"" 
class"" %
AllPermissionsRequirement"" &
:""' (%
IAuthorizationRequirement"") B
{## 
public$$ 

string$$ 
[$$ 
]$$ 
Permissions$$ 
{$$  !
get$$" %
;$$% &
}$$' (
public&& 
%
AllPermissionsRequirement&& $
(&&$ %
params&&% +
string&&, 2
[&&2 3
]&&3 4
permissions&&5 @
)&&@ A
{'' 
Permissions(( 
=(( 
permissions(( !
;((! "
})) 
}** 
public// 
class//  
AuthLevelRequirement// !
://" #%
IAuthorizationRequirement//$ =
{00 
public11 

string11 
MinAuthLevel11 
{11  
get11! $
;11$ %
}11& '
public33 
 
AuthLevelRequirement33 
(33  
string33  &
minAuthLevel33' 3
)333 4
{44 
MinAuthLevel55 
=55 
minAuthLevel55 #
;55# $
}66 
}77 
public<< 
class<< '
IdentityProviderRequirement<< (
:<<) *%
IAuthorizationRequirement<<+ D
{== 
public>> 

string>> 
RequiredIdp>> 
{>> 
get>>  #
;>># $
}>>% &
public@@ 
'
IdentityProviderRequirement@@ &
(@@& '
string@@' -
requiredIdp@@. 9
)@@9 :
{AA 
RequiredIdpBB 
=BB 
requiredIdpBB !
;BB! "
}CC 
}DD å7
]/Users/yshmulev/dev/spring-java-2/dotnet-spring-equivalent/Authorization/PermissionHandler.cs
	namespace 	 
SpringJavaEquivalent
 
. 
Authorization ,
;, -
public		 
class		 
PermissionHandler		 
:		   
AuthorizationHandler		! 5
<		5 6!
PermissionRequirement		6 K
>		K L
{

 
	protected 
override 
Task "
HandleRequirementAsync 2
(2 3'
AuthorizationHandlerContext3 N
contextO V
,V W!
PermissionRequirementX m
requirementn y
)y z
{ 
var 
hasPermission 
= 
context #
.# $
User$ (
.( )
HasClaim) 1
(1 2
$str2 >
,> ?
requirement@ K
.K L

PermissionL V
)V W
;W X
if 

( 
hasPermission 
) 
{ 	
context 
. 
Succeed 
( 
requirement '
)' (
;( )
} 	
return 
Task 
. 
CompletedTask !
;! "
} 
} 
public 
class  
AnyPermissionHandler !
:" # 
AuthorizationHandler$ 8
<8 9$
AnyPermissionRequirement9 Q
>Q R
{ 
	protected 
override 
Task "
HandleRequirementAsync 2
(2 3'
AuthorizationHandlerContext3 N
contextO V
,V W$
AnyPermissionRequirementX p
requirementq |
)| }
{ 
var 
hasAnyPermission 
= 
requirement *
.* +
Permissions+ 6
.6 7
Any7 :
(: ;

permission; E
=>F H
context   
.   
User   
.   
HasClaim   !
(  ! "
$str  " .
,  . /

permission  0 :
)  : ;
)  ; <
;  < =
if"" 

("" 
hasAnyPermission"" 
)"" 
{## 	
context$$ 
.$$ 
Succeed$$ 
($$ 
requirement$$ '
)$$' (
;$$( )
}%% 	
return'' 
Task'' 
.'' 
CompletedTask'' !
;''! "
}(( 
})) 
public.. 
class.. !
AllPermissionsHandler.. "
:..# $ 
AuthorizationHandler..% 9
<..9 :%
AllPermissionsRequirement..: S
>..S T
{// 
	protected00 
override00 
Task00 "
HandleRequirementAsync00 2
(002 3'
AuthorizationHandlerContext003 N
context00O V
,00V W%
AllPermissionsRequirement00X q
requirement00r }
)00} ~
{11 
var22 
hasAllPermissions22 
=22 
requirement22  +
.22+ ,
Permissions22, 7
.227 8
All228 ;
(22; <

permission22< F
=>22G I
context33 
.33 
User33 
.33 
HasClaim33 !
(33! "
$str33" .
,33. /

permission330 :
)33: ;
)33; <
;33< =
if55 

(55 
hasAllPermissions55 
)55 
{66 	
context77 
.77 
Succeed77 
(77 
requirement77 '
)77' (
;77( )
}88 	
return:: 
Task:: 
.:: 
CompletedTask:: !
;::! "
};; 
}<< 
publicAA 
classAA 
AuthLevelHandlerAA 
:AA  
AuthorizationHandlerAA  4
<AA4 5 
AuthLevelRequirementAA5 I
>AAI J
{BB 
	protectedCC 
overrideCC 
TaskCC "
HandleRequirementAsyncCC 2
(CC2 3'
AuthorizationHandlerContextCC3 N
contextCCO V
,CCV W 
AuthLevelRequirementCCX l
requirementCCm x
)CCx y
{DD 
varEE 
authLevelClaimEE 
=EE 
contextEE $
.EE$ %
UserEE% )
.EE) *
	FindFirstEE* 3
(EE3 4
$strEE4 @
)EE@ A
?EEA B
.EEB C
ValueEEC H
;EEH I
ifGG 

(GG 
authLevelClaimGG 
!=GG 
nullGG "
)GG" #
{HH 	
varII 

authLevelsII 
=II 
newII  
[II  !
]II! "
{II# $
$strII% +
,II+ ,
$strII- 3
,II3 4
$strII5 ;
}II< =
;II= >
varJJ 
currentLevelIndexJJ !
=JJ" #
ArrayJJ$ )
.JJ) *
IndexOfJJ* 1
(JJ1 2

authLevelsJJ2 <
,JJ< =
authLevelClaimJJ> L
)JJL M
;JJM N
varKK 
requiredLevelIndexKK "
=KK# $
ArrayKK% *
.KK* +
IndexOfKK+ 2
(KK2 3

authLevelsKK3 =
,KK= >
requirementKK? J
.KKJ K
MinAuthLevelKKK W
)KKW X
;KKX Y
ifMM 
(MM 
currentLevelIndexMM !
>=MM" $
requiredLevelIndexMM% 7
)MM7 8
{NN 
contextOO 
.OO 
SucceedOO 
(OO  
requirementOO  +
)OO+ ,
;OO, -
}PP 
}QQ 	
returnSS 
TaskSS 
.SS 
CompletedTaskSS !
;SS! "
}TT 
}UU 
publicZZ 
classZZ #
IdentityProviderHandlerZZ $
:ZZ% & 
AuthorizationHandlerZZ' ;
<ZZ; <'
IdentityProviderRequirementZZ< W
>ZZW X
{[[ 
	protected\\ 
override\\ 
Task\\ "
HandleRequirementAsync\\ 2
(\\2 3'
AuthorizationHandlerContext\\3 N
context\\O V
,\\V W'
IdentityProviderRequirement\\X s
requirement\\t 
)	\\ Ä
{]] 
var^^ 
idpClaim^^ 
=^^ 
context^^ 
.^^ 
User^^ #
.^^# $
	FindFirst^^$ -
(^^- .
$str^^. 3
)^^3 4
?^^4 5
.^^5 6
Value^^6 ;
;^^; <
if`` 

(`` 
idpClaim`` 
==`` 
requirement`` #
.``# $
RequiredIdp``$ /
)``/ 0
{aa 	
contextbb 
.bb 
Succeedbb 
(bb 
requirementbb '
)bb' (
;bb( )
}cc 	
returnee 
Taskee 
.ee 
CompletedTaskee !
;ee! "
}ff 
}gg 