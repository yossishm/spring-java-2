#!/bin/bash

echo "=== CVE Fix Status Check ==="
echo ""

echo "Current Spring Boot Version: 3.5.8"
echo ""

echo "=== Tomcat Versions ==="
echo "CVE-2025-24813: Affects Tomcat 10.1.0-M1 through 10.1.34"
echo "                 Fixed in: 10.1.35+"
echo ""
echo "CVE-2025-55752: Affects Tomcat 10.1.0-M1 through 10.1.44"
echo "                 Fixed in: 10.1.45+"
echo ""

echo "Current Tomcat version in Spring Boot 3.5.8:"
mvn dependency:tree -Dincludes=org.apache.tomcat.embed:tomcat-embed-core -q 2>&1 | grep "tomcat-embed-core" | head -1
echo ""

echo "=== Netty Versions ==="
echo "CVE-2025-24970: Affects Netty 4.1.91.Final through 4.1.117.Final"
echo "                 Fixed in: 4.1.118.Final+"
echo ""

echo "Current Netty version in Spring Boot 3.5.8:"
mvn dependency:tree -Dincludes=io.netty:netty-codec-http -q 2>&1 | grep "netty-codec-http" | head -1
echo ""

echo "=== Spring Framework Versions ==="
echo "CVE-2025-41249: Affects Spring Framework 6.2.0-6.2.10, 6.1.0-6.1.22, 5.3.0-5.3.44"
echo "                 Fixed in: Spring Framework 6.2.11+"
echo ""

echo "Current Spring Framework version in Spring Boot 3.5.8:"
mvn dependency:tree -Dincludes=org.springframework:spring-core -q 2>&1 | grep "spring-core" | head -1
echo ""

echo "=== Summary ==="
TOMCAT_VERSION=$(mvn dependency:tree -Dincludes=org.apache.tomcat.embed:tomcat-embed-core -q 2>&1 | grep "tomcat-embed-core" | sed 's/.*:\([0-9.]*\):.*/\1/')
NETTY_VERSION=$(mvn dependency:tree -Dincludes=io.netty:netty-codec-http -q 2>&1 | grep "netty-codec-http" | sed 's/.*:\([0-9.]*\):.*/\1/')
SPRING_VERSION=$(mvn dependency:tree -Dincludes=org.springframework:spring-core -q 2>&1 | grep "spring-core" | sed 's/.*:\([0-9.]*\):.*/\1/')

echo "Tomcat: $TOMCAT_VERSION"
if [[ "$TOMCAT_VERSION" > "10.1.44" ]]; then
    echo "  ✅ CVE-2025-24813: FIXED (version >= 10.1.35)"
    echo "  ✅ CVE-2025-55752: FIXED (version >= 10.1.45)"
else
    echo "  ⚠️  CVE-2025-24813: Check version"
    echo "  ⚠️  CVE-2025-55752: Check version"
fi

echo ""
echo "Netty: $NETTY_VERSION"
if [[ "$NETTY_VERSION" > "4.1.117" ]]; then
    echo "  ✅ CVE-2025-24970: FIXED (version >= 4.1.118.Final)"
else
    echo "  ⚠️  CVE-2025-24970: Check version"
fi

echo ""
echo "Spring Framework: $SPRING_VERSION"
if [[ "$SPRING_VERSION" > "6.2.10" ]]; then
    echo "  ✅ CVE-2025-41249: FIXED (version >= 6.2.11)"
else
    echo "  ⚠️  CVE-2025-41249: Check version"
fi




