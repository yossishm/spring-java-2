# Multi-stage build with distroless runtime
FROM eclipse-temurin:21.0.8_9-jre-alpine-3.22 AS builder
WORKDIR /build
COPY target/gs-spring-boot-docker-0.2.0.jar /build/app.jar

# Runtime stage - minimal distroless image
FROM gcr.io/distroless/java21-debian12:nonroot

# Copy the JAR from builder stage
COPY --from=builder /build/app.jar /app/app.jar

# Expose port
EXPOSE 8080

# Run as non-root user (already set in distroless image)
ENTRYPOINT ["java", "-jar", "/app/app.jar"]
