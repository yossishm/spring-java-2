{
  "vulnerabilities": [
    {
      "id": "SNYK-JAVA-ORGJETBRAINSKOTLIN-2393744",
      "title": "Information Exposure",
      "CVSSv3": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:P",
      "credit": [
        "JLLeitschuh"
      ],
      "semver": {
        "vulnerable": [
          "[,2.1.0)"
        ]
      },
      "exploit": "Proof of Concept",
      "fixedIn": [
        "2.1.0"
      ],
      "patches": [],
      "insights": {
        "triageAdvice": null
      },
      "language": "java",
      "severity": "low",
      "cvssScore": 3.3,
      "functions": [],
      "malicious": false,
      "isDisputed": false,
      "moduleName": "org.jetbrains.kotlin:kotlin-stdlib",
      "references": [
        {
          "url": "https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.io/create-temp-dir.html",
          "title": "Documentation"
        },
        {
          "url": "https://github.com/JetBrains/kotlin/commit/66f5c985057031117e173572dc339ba2acd4128d",
          "title": "GitHub Commit"
        },
        {
          "url": "https://youtrack.jetbrains.com/issue/KT-43306/Deprecate-createTempFile-and-createTempDir-functions-in-kotlin.io",
          "title": "Issue"
        },
        {
          "url": "https://github.com/JetBrains/kotlin/blob/9b157fd291d581a30a3194940b0ebbb95a2fd247/libraries/stdlib/jvm/src/kotlin/io/files/Utils.kt%23L14-L39",
          "title": "Vulnerable Code #1"
        },
        {
          "url": "https://github.com/JetBrains/kotlin/blob/9b157fd291d581a30a3194940b0ebbb95a2fd247/libraries/stdlib/jvm/src/kotlin/io/files/Utils.kt%23L41-L60",
          "title": "Vulnerable Code #2"
        }
      ],
      "cvssDetails": [
        {
          "assigner": "Red Hat",
          "severity": "medium",
          "cvssV3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "cvssV3BaseScore": 5.3,
          "modificationTime": "2025-04-29T04:33:17.798099Z"
        },
        {
          "assigner": "NVD",
          "severity": "medium",
          "cvssV3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "cvssV3BaseScore": 5.3,
          "modificationTime": "2024-03-11T09:50:55.749386Z"
        }
      ],
      "cvssSources": [
        {
          "type": "primary",
          "vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N/E:P",
          "assigner": "Snyk",
          "severity": "low",
          "baseScore": 3.3,
          "cvssVersion": "3.1",
          "modificationTime": "2024-11-28T15:09:46.694131Z"
        },
        {
          "type": "secondary",
          "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "assigner": "Red Hat",
          "severity": "medium",
          "baseScore": 5.3,
          "cvssVersion": "3.1",
          "modificationTime": "2025-04-29T04:33:17.798099Z"
        },
        {
          "type": "secondary",
          "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "assigner": "NVD",
          "severity": "medium",
          "baseScore": 5.3,
          "cvssVersion": "3.1",
          "modificationTime": "2024-03-11T09:50:55.749386Z"
        }
      ],
      "description": "## Overview\n[org.jetbrains.kotlin:kotlin-stdlib](https://search.maven.org/artifact/org.jetbrains.kotlin/kotlin-stdlib) is a Kotlin Standard Library for JVM.\n\nAffected versions of this package are vulnerable to Information Exposure. A Kotlin application using `createTempDir` or `createTempFile` and placing sensitive information within either of these locations would be leaking this information in a read-only way to other users also on this system.\r\n\r\n**Note:** As of version 1.4.21, the vulnerable functions have been marked as deprecated. Due to still being usable, this advisory is kept as \"unfixed\".\r\n\r\n## PoC by JLLeitschuh\r\n```\r\npackage org.jlleitschuh.sandbox\r\n\r\nimport org.junit.jupiter.api.Test\r\nimport java.io.BufferedReader\r\nimport java.io.File\r\nimport java.io.IOException\r\nimport java.io.InputStreamReader\r\nimport java.nio.file.Files\r\n\r\nclass KotlinTempDirectoryPermissionCheck {\r\n    @Test\r\n    fun `kotlin check default directory permissions`() {\r\n        val dir = createTempDir()\r\n        runLS(dir.parentFile, dir) // Prints drwxr-xr-x\r\n    }\r\n\r\n    @Test\r\n    fun `Files check default directory permissions`() {\r\n        val dir = Files.createTempDirectory(\"random-directory\")\r\n        runLS(dir.toFile().parentFile, dir.toFile()) // Prints drwx------\r\n    }\r\n\r\n    @Test\r\n    fun `kotlin check default file permissions`() {\r\n        val file = createTempFile()\r\n        runLS(file.parentFile, file) // Prints -rw-r--r--\r\n    }\r\n\r\n    @Test\r\n    fun `Files check default file permissions`() {\r\n        val file = Files.createTempFile(\"random-file\", \".txt\")\r\n        runLS(file.toFile().parentFile, file.toFile()) // Prints -rw-------\r\n    }\r\n\r\n    private fun runLS(file: File, lookingFor: File) {\r\n        val processBuilder = ProcessBuilder()\r\n        processBuilder.command(\"ls\", \"-l\", file.absolutePath)\r\n        try {\r\n            val process = processBuilder.start()\r\n            val output = StringBuilder()\r\n            val reader = BufferedReader(\r\n                InputStreamReader(process.inputStream)\r\n            )\r\n            reader.lines().forEach { line ->\r\n                if (line.contains(\"total\")) {\r\n                    output.append(line).append('\\n')\r\n                }\r\n                if (line.contains(lookingFor.name)) {\r\n                    output.append(line).append('\\n')\r\n                }\r\n            }\r\n            val exitVal = process.waitFor()\r\n            if (exitVal == 0) {\r\n                println(\"Success!\")\r\n                println(output)\r\n            } else {\r\n                //abnormal...\r\n            }\r\n        } catch (e: IOException) {\r\n            e.printStackTrace()\r\n        } catch (e: InterruptedException) {\r\n            e.printStackTrace()\r\n        }\r\n    }\r\n}\r\n```\n## Remediation\nUpgrade `org.jetbrains.kotlin:kotlin-stdlib` to version 2.1.0 or higher.\n## References\n- [Documentation](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.io/create-temp-dir.html)\n- [GitHub Commit](https://github.com/JetBrains/kotlin/commit/66f5c985057031117e173572dc339ba2acd4128d)\n- [Issue](https://youtrack.jetbrains.com/issue/KT-43306/Deprecate-createTempFile-and-createTempDir-functions-in-kotlin.io)\n- [Vulnerable Code #1](https://github.com/JetBrains/kotlin/blob/9b157fd291d581a30a3194940b0ebbb95a2fd247/libraries/stdlib/jvm/src/kotlin/io/files/Utils.kt#L14-L39)\n- [Vulnerable Code #2](https://github.com/JetBrains/kotlin/blob/9b157fd291d581a30a3194940b0ebbb95a2fd247/libraries/stdlib/jvm/src/kotlin/io/files/Utils.kt#L41-L60)\n",
      "epssDetails": {
        "percentile": "0.00123",
        "probability": "0.00003",
        "modelVersion": "v2025.03.14"
      },
      "identifiers": {
        "CVE": [
          "CVE-2020-29582"
        ],
        "CWE": [
          "CWE-378"
        ]
      },
      "packageName": "org.jetbrains.kotlin:kotlin-stdlib",
      "proprietary": false,
      "creationTime": "2022-02-04T09:36:58.345703Z",
      "functions_new": [],
      "alternativeIds": [],
      "disclosureTime": "2022-02-03T20:43:35Z",
      "exploitDetails": {
        "sources": [
          "Snyk"
        ],
        "maturityLevels": [
          {
            "type": "secondary",
            "level": "Proof of Concept",
            "format": "CVSSv3"
          },
          {
            "type": "primary",
            "level": "Proof of Concept",
            "format": "CVSSv4"
          }
        ]
      },
      "packageManager": "maven",
      "mavenModuleName": {
        "groupId": "org.jetbrains.kotlin",
        "artifactId": "kotlin-stdlib"
      },
      "publicationTime": "2022-02-04T14:31:42Z",
      "severityBasedOn": "CVSS",
      "modificationTime": "2025-04-29T04:33:17.798099Z",
      "socialTrendAlert": false,
      "severityWithCritical": "low",
      "from": [
        "org.springframework:gs-spring-boot-docker@0.2.0",
        "com.squareup.okhttp3:okhttp@4.12.0",
        "org.jetbrains.kotlin:kotlin-stdlib-jdk8@1.9.25",
        "org.jetbrains.kotlin:kotlin-stdlib@1.9.25"
      ],
      "upgradePath": [
        false,
        "com.squareup.okhttp3:okhttp@5.0.0"
      ],
      "isUpgradable": true,
      "isPatchable": false,
      "name": "org.jetbrains.kotlin:kotlin-stdlib",
      "version": "1.9.25"
    }
  ],
  "ok": false,
  "dependencyCount": 105,
  "org": "yossi.shmulevitch",
  "policy": "# Snyk (https://snyk.io) policy file, patches or ignores known vulnerabilities.\nversion: v1.25.1\nignore: {}\npatch: {}\n",
  "isPrivate": true,
  "licensesPolicy": {
    "severities": {},
    "orgLicenseRules": {
      "AGPL-1.0": {
        "licenseType": "AGPL-1.0",
        "severity": "high",
        "instructions": ""
      },
      "AGPL-3.0": {
        "licenseType": "AGPL-3.0",
        "severity": "high",
        "instructions": ""
      },
      "Artistic-1.0": {
        "licenseType": "Artistic-1.0",
        "severity": "medium",
        "instructions": ""
      },
      "Artistic-2.0": {
        "licenseType": "Artistic-2.0",
        "severity": "medium",
        "instructions": ""
      },
      "CDDL-1.0": {
        "licenseType": "CDDL-1.0",
        "severity": "medium",
        "instructions": ""
      },
      "CPOL-1.02": {
        "licenseType": "CPOL-1.02",
        "severity": "high",
        "instructions": ""
      },
      "EPL-1.0": {
        "licenseType": "EPL-1.0",
        "severity": "medium",
        "instructions": ""
      },
      "GPL-2.0": {
        "licenseType": "GPL-2.0",
        "severity": "high",
        "instructions": ""
      },
      "GPL-3.0": {
        "licenseType": "GPL-3.0",
        "severity": "high",
        "instructions": ""
      },
      "LGPL-2.0": {
        "licenseType": "LGPL-2.0",
        "severity": "medium",
        "instructions": ""
      },
      "LGPL-2.1": {
        "licenseType": "LGPL-2.1",
        "severity": "medium",
        "instructions": ""
      },
      "LGPL-3.0": {
        "licenseType": "LGPL-3.0",
        "severity": "medium",
        "instructions": ""
      },
      "MPL-1.1": {
        "licenseType": "MPL-1.1",
        "severity": "medium",
        "instructions": ""
      },
      "MPL-2.0": {
        "licenseType": "MPL-2.0",
        "severity": "medium",
        "instructions": ""
      },
      "MS-RL": {
        "licenseType": "MS-RL",
        "severity": "medium",
        "instructions": ""
      },
      "SimPL-2.0": {
        "licenseType": "SimPL-2.0",
        "severity": "high",
        "instructions": ""
      }
    }
  },
  "packageManager": "maven",
  "projectId": "6fc87033-4c2a-48e5-bafd-b80efad439c3",
  "ignoreSettings": {
    "adminOnly": false,
    "reasonRequired": false,
    "disregardFilesystemIgnores": false
  },
  "summary": "1 vulnerable dependency path",
  "remediation": {
    "unresolved": [],
    "upgrade": {
      "com.squareup.okhttp3:okhttp@4.12.0": {
        "upgradeTo": "com.squareup.okhttp3:okhttp@5.0.0",
        "upgrades": [
          "org.jetbrains.kotlin:kotlin-stdlib@1.9.25"
        ],
        "vulns": [
          "SNYK-JAVA-ORGJETBRAINSKOTLIN-2393744"
        ]
      }
    },
    "patch": {},
    "ignore": {},
    "pin": {}
  },
  "filesystemPolicy": false,
  "filtered": {
    "ignore": [],
    "patch": []
  },
  "uniqueCount": 1,
  "projectName": "org.springframework:gs-spring-boot-docker",
  "foundProjectCount": 5,
  "displayTargetFile": "pom.xml",
  "hasUnknownVersions": false,
  "path": "/Users/yshmulev/dev/spring-java-2"
}
